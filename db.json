{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/pure/source/favicon.png","path":"favicon.png","modified":0,"renderable":1},{"_id":"themes/pure/source/fonts/iconfont.eot","path":"fonts/iconfont.eot","modified":0,"renderable":1},{"_id":"themes/pure/source/fonts/README.md","path":"fonts/README.md","modified":0,"renderable":1},{"_id":"themes/pure/source/fonts/iconfont.ttf","path":"fonts/iconfont.ttf","modified":0,"renderable":1},{"_id":"themes/pure/source/fonts/iconfont.woff","path":"fonts/iconfont.woff","modified":0,"renderable":1},{"_id":"themes/pure/source/images/avatar.jpg","path":"images/avatar.jpg","modified":0,"renderable":1},{"_id":"themes/pure/source/images/thumb-default.png","path":"images/thumb-default.png","modified":0,"renderable":1},{"_id":"themes/pure/source/images/xingqiu-qrcode.jpg","path":"images/xingqiu-qrcode.jpg","modified":0,"renderable":1},{"_id":"themes/pure/source/js/application.js","path":"js/application.js","modified":0,"renderable":1},{"_id":"themes/pure/source/js/application.min.js","path":"js/application.min.js","modified":0,"renderable":1},{"_id":"themes/pure/source/js/insight.js","path":"js/insight.js","modified":0,"renderable":1},{"_id":"themes/pure/source/js/plugin.js","path":"js/plugin.js","modified":0,"renderable":1},{"_id":"themes/pure/source/js/plugin.min.js","path":"js/plugin.min.js","modified":0,"renderable":1},{"_id":"themes/pure/source/css/style.min.css","path":"css/style.min.css","modified":0,"renderable":1},{"_id":"themes/pure/source/fonts/iconfont.svg","path":"fonts/iconfont.svg","modified":0,"renderable":1},{"_id":"themes/pure/source/images/donate/alipayimg.png","path":"images/donate/alipayimg.png","modified":0,"renderable":1},{"_id":"themes/pure/source/images/favatar/SzsFox-logo.png","path":"images/favatar/SzsFox-logo.png","modified":0,"renderable":1},{"_id":"themes/pure/source/images/donate/wechatpayimg.png","path":"images/donate/wechatpayimg.png","modified":0,"renderable":1},{"_id":"themes/pure/source/images/favatar/chuangzaoshi-logo.png","path":"images/favatar/chuangzaoshi-logo.png","modified":0,"renderable":1},{"_id":"themes/pure/source/images/favatar/idesign-logo.png","path":"images/favatar/idesign-logo.png","modified":0,"renderable":1},{"_id":"themes/pure/source/js/jquery.min.js","path":"js/jquery.min.js","modified":0,"renderable":1},{"_id":"themes/pure/source/js/plugin.js.map","path":"js/plugin.js.map","modified":0,"renderable":1},{"_id":"themes/pure/source/css/style.css","path":"css/style.css","modified":0,"renderable":1}],"Cache":[{"_id":"themes/pure/.DS_Store","hash":"19b911dfab6941c4e05b3daad5dfcb87db9c7a7d","modified":1599652497449},{"_id":"themes/pure/.gitignore","hash":"dbb41a2f30c98cb9de173d82736c46266c901cda","modified":1598712465788},{"_id":"themes/pure/LICENSE","hash":"c480fce396b23997ee23cc535518ffaaf7f458f8","modified":1598712465789},{"_id":"themes/pure/README.cn.md","hash":"a634af4addbb57088935e060e8ec6035ea7bab76","modified":1598712465789},{"_id":"themes/pure/README.md","hash":"5861cec81712af9197a210fd5212d007aad8b0de","modified":1598712465790},{"_id":"themes/pure/_config.yml","hash":"e3b2981d422cc182e014ea0b6d13ee3e1575b735","modified":1599103221995},{"_id":"themes/pure/_config.yml.example","hash":"4714f87fdb6d4a6ea5ece84f4fe37f922337f14d","modified":1598712465792},{"_id":"themes/pure/package.json","hash":"a61723eead5cae2c4d9f0f05cf40d2de7c286fee","modified":1598712465834},{"_id":"source/.DS_Store","hash":"d4dde400832008c582a713096c3db83cab5d23ac","modified":1599652497398},{"_id":"themes/pure/_source/.DS_Store","hash":"900bc2981e1b2be2113c5526c62e98a92bbcef11","modified":1598666884442},{"_id":"themes/pure/languages/en.yml","hash":"167ea0db98f4db156ea68c4644f64c0287ae2b6f","modified":1598712465796},{"_id":"themes/pure/languages/default.yml","hash":"167ea0db98f4db156ea68c4644f64c0287ae2b6f","modified":1598712465796},{"_id":"themes/pure/languages/zh-CN.yml","hash":"057ebc043f09449af9768791c89c86dfc2938365","modified":1598712465797},{"_id":"themes/pure/languages/zh-TW.yml","hash":"6d27c3114be539b8783ffce944f68b2e26a8c3b9","modified":1598712465797},{"_id":"themes/pure/layout/about.ejs","hash":"4f5c769e183249b12eb9d3141432bc0039519730","modified":1598712465828},{"_id":"themes/pure/layout/archive.ejs","hash":"ded5d953b35666e30f4c6e48e2d2c62af8d95ebf","modified":1598712465828},{"_id":"themes/pure/layout/books.ejs","hash":"6c64719cd7071b5319b01339aa524fdaab391385","modified":1598712465829},{"_id":"themes/pure/layout/categories.ejs","hash":"22a2bc1712dd9ba1a3027e875d636132d334fb00","modified":1598712465829},{"_id":"themes/pure/layout/category.ejs","hash":"3ca5651bbce7b0c280c906468f2eb18c2e55ebcb","modified":1598712465830},{"_id":"themes/pure/layout/index.ejs","hash":"07825d8d8b21eb7b694f5585567b9df5c5a91a60","modified":1598712465830},{"_id":"themes/pure/layout/layout.ejs","hash":"a29ab2e881954a252bfc0dc1a7eb5aa52768dd2a","modified":1598712465831},{"_id":"themes/pure/layout/links.ejs","hash":"77c5d1561e2c606c5b3bb39610133d84324074df","modified":1598712465831},{"_id":"themes/pure/layout/page.ejs","hash":"5c27475c176627e6e2e6a16172eb6980e56bcaff","modified":1598712465832},{"_id":"themes/pure/layout/post.ejs","hash":"5c27475c176627e6e2e6a16172eb6980e56bcaff","modified":1598712465832},{"_id":"themes/pure/layout/repository.ejs","hash":"fe4b3e051a8b0debe9ee22c2cc2cc935d92ee23f","modified":1598712465833},{"_id":"themes/pure/layout/tag.ejs","hash":"df60564c162f7ad3422f8959dfea19351857a7cd","modified":1598712465833},{"_id":"themes/pure/layout/tags.ejs","hash":"29f19a6ed10f8b1f069259a7aeaaacddcfaa2ed4","modified":1598712465833},{"_id":"themes/pure/scripts/thumbnail.js","hash":"e667a611f9baac270281b765832020d50bf8fb7f","modified":1598712465855},{"_id":"themes/pure/source/favicon.png","hash":"89875d3b018552e396fc5f0bd8ff5d9f5d4a5d71","modified":1598712465860},{"_id":"source/.MWebMetaData/ImgUpload-14AD39036A9340047B13A8314BE061F8.data","hash":"73f094c6ac96c36e337649189712be09629be198","modified":1598861026534},{"_id":"source/.MWebMetaData/ImgUpload-27E5F036E62D80089F02872CDAEB7582.data","hash":"95f50bb02eb86a71995c9064ca903cdb74e6144e","modified":1598712465781},{"_id":"source/.MWebMetaData/ImgUpload-9E6173B1192F0ACAF730DC9C85AC4C83.data","hash":"922b167881fb6b0e57ed944a9c11a5402a524795","modified":1598719096260},{"_id":"source/.MWebMetaData/ImgUpload-B42F7CB3840E54DFE10DF15247E9366F.data","hash":"c24f28d5e402f5e58d6e5e422888e5fc298e43c6","modified":1599100978560},{"_id":"source/.MWebMetaData/ImgUpload-B78F1F3829E2E6DD8A7022E3538D08B7.data","hash":"5a382d878edd01a16c02cf1737811c3bababcb14","modified":1599491014804},{"_id":"source/.MWebMetaData/setting.json","hash":"45624c236d61ea24b934267bb186a6eaa2ceac18","modified":1598713382178},{"_id":"source/404/index.md","hash":"8d493f624fdd29c8d0266767e56f343d549e16d8","modified":1598712465781},{"_id":"source/_posts/.DS_Store","hash":"6dc98468ad045afad58ba4d11ab3788a4d482b07","modified":1599652497400},{"_id":"source/_posts/2016-11-26.md","hash":"d335dfd30e1e2b7799d80a78200aeb689015061b","modified":1598760261922},{"_id":"source/_posts/2016-11-28.md","hash":"fa55e8c3c1e624acffcd4c28f7f23024f4257548","modified":1598760261926},{"_id":"source/_posts/2017-04-17.md","hash":"7b2ac27e159fe762720465d008e270da6ec44897","modified":1598760261917},{"_id":"source/_posts/2017-04-25.md","hash":"b13da8cd016ee5d92c0b9ef5413e7f72ed203f09","modified":1598760261913},{"_id":"source/_posts/2017-04-27.md","hash":"21060fffc3838be7b8df21f5ced1e5cafab6a487","modified":1598760261931},{"_id":"source/_posts/2017-04-28-1.md","hash":"ac60584c94ce40d66793d09b39ad9c0f85034ec3","modified":1598760261909},{"_id":"source/_posts/2017-04-28.md","hash":"413dfd292ddadf23527d0c24213feb82102ea96e","modified":1598760261904},{"_id":"source/_posts/2017-05-27.md","hash":"f8612cde52a4c90f15aa8adb8c462d540fd14f72","modified":1598760261899},{"_id":"source/_posts/2017-06-01.md","hash":"6d8f6769cd63af74a59554f0c178d92b5bf571fb","modified":1598761293268},{"_id":"source/_posts/go-sty01.md","hash":"65718622599d6d478639e4a2b30be1dbd8dd3bdb","modified":1461903352000},{"_id":"source/_posts/hw-jg.md","hash":"d2876cb7142ff7add0ec63cac1d6c7256291dcbe","modified":1461232584000},{"_id":"source/_posts/mongo-php-error.md","hash":"ea024961ab1c9fe509edf979477272d6a1737bd1","modified":1493365976000},{"_id":"source/_posts/ranyao-chuangye.md","hash":"81c6b230c8363ce271dd5f654e22a33116e9a124","modified":1461170129000},{"_id":"source/_posts/开篇.md","hash":"8f71cb4ce5e6ef3721593282678290a64380f17c","modified":1461134077000},{"_id":"source/about/index.md","hash":"9c95cabb533409d06daefc4295021ad199761efc","modified":1598712465787},{"_id":"source/books/index.md","hash":"83898a46095b51b5a41563951134b5a1d12fa4d3","modified":1598712465787},{"_id":"source/categories/index.md","hash":"47647a89e878a76f81c2dc7c4391a4658772874b","modified":1598712465787},{"_id":"source/links/index.md","hash":"b759c1969170abfc9fb3b578dd412328b8ee2b0d","modified":1598712465787},{"_id":"source/repository/index.md","hash":"ed0e082c30f233dd5c140d188f1e4bce44bdbf79","modified":1598712465788},{"_id":"source/tags/index.md","hash":"42e9c904ea63b0a7dd4033e2e8f153225bc5cda5","modified":1598712465788},{"_id":"themes/pure/screenshot/pure-theme-black.png","hash":"10b40f398af7eb7e8ba2bf2f2a959d8779fc1fe1","modified":1598712465836},{"_id":"themes/pure/screenshot/pure-theme-blue.png","hash":"6146890a68d5ea9d343c48d50151ddd5a2a1872c","modified":1598712465837},{"_id":"themes/pure/screenshot/pure-theme-green.png","hash":"12ec0c6033cb2762839fdf75434bbb4fbf946022","modified":1598712465838},{"_id":"themes/pure/screenshot/pure-theme-purple.png","hash":"9855d2eb0acd23370209354f232471df8f4f72e2","modified":1598712465839},{"_id":"themes/pure/screenshot/pure.png","hash":"8f4cfd8d7edfa4fbffdf375291302d9807f5cc1c","modified":1598712465840},{"_id":"themes/pure/_source/404/index.md","hash":"8d493f624fdd29c8d0266767e56f343d549e16d8","modified":1598712465793},{"_id":"themes/pure/_source/_data/links.yml","hash":"aa443a4508550820c77c2a4f6abff1d38ad85054","modified":1598712465793},{"_id":"themes/pure/_source/_data/gallery.yml","hash":"e2b3fad87be3d1cfde1effa655d39678ee90907e","modified":1598712465793},{"_id":"themes/pure/_source/about/index.md","hash":"9c95cabb533409d06daefc4295021ad199761efc","modified":1598712465794},{"_id":"themes/pure/_source/books/index.md","hash":"cf4163959c23244059cbbbc1c0fe379cc3b2cb73","modified":1598712465794},{"_id":"themes/pure/_source/categories/index.md","hash":"5d2a4f103d27bebbe3eef1604649d0f5c6d86ac6","modified":1598712465794},{"_id":"themes/pure/_source/links/index.md","hash":"febcf87eb0ab3c5080578275d25f3970bba39625","modified":1598712465795},{"_id":"themes/pure/_source/repository/index.md","hash":"ed0e082c30f233dd5c140d188f1e4bce44bdbf79","modified":1598712465795},{"_id":"themes/pure/_source/tags/index.md","hash":"42e9c904ea63b0a7dd4033e2e8f153225bc5cda5","modified":1598712465795},{"_id":"themes/pure/layout/_common/footer.ejs","hash":"cdc48ec70d9202b947f2a9334234d038d7014a7d","modified":1598712465798},{"_id":"themes/pure/layout/_common/head.ejs","hash":"a48ef0fa22712b29ec044b9e5134461f3a21c10d","modified":1598712465798},{"_id":"themes/pure/layout/_common/header.ejs","hash":"3d739d1e2b2991927c08ec222db123830a44a519","modified":1598712465799},{"_id":"themes/pure/layout/_common/script.ejs","hash":"0031114d2a58f8601c2869f78ceedc75a10be90d","modified":1598712465800},{"_id":"themes/pure/layout/_common/social.ejs","hash":"a35a2610e9da762df96587b76b51470507a88cad","modified":1598712465800},{"_id":"themes/pure/layout/_script/comment.ejs","hash":"6f951510bab9dc15474b6664e0329defccf29a30","modified":1598712465819},{"_id":"themes/pure/layout/_script/analytics.ejs","hash":"e756a81f8c20a187fb863b9689f2f1fa15e2f4e1","modified":1598712465819},{"_id":"themes/pure/layout/_script/douban.ejs","hash":"143087db0573772b0bdaf7f93312553158942ec7","modified":1598712465820},{"_id":"themes/pure/layout/_script/fancybox.ejs","hash":"8f1be01e70a15b2c31ae57d8c6bce54622ebf8a7","modified":1598712465820},{"_id":"themes/pure/layout/_script/mathjax.ejs","hash":"f618393ab971b2faa80d541f2e6a553d9ace9816","modified":1598712465821},{"_id":"themes/pure/layout/_script/pv.ejs","hash":"fb9b5f16029f2ccef4b83cf4facfdcdd748b65b4","modified":1598712465821},{"_id":"themes/pure/layout/_script/repository.ejs","hash":"14f2e7d4c1055ff6a5f5867dc0e9a9f6f4c28fe1","modified":1598712465822},{"_id":"themes/pure/layout/_script/search.ejs","hash":"7be33dc260ce788aa1a2cd3bd0386d95057533cb","modified":1598712465822},{"_id":"themes/pure/layout/_partial/archive-book.ejs","hash":"977f97f3636947006ad738e502858c46d4cd5ec7","modified":1598712465801},{"_id":"themes/pure/layout/_partial/archive-category.ejs","hash":"9c364fd6b5172890784141802f5f466241d233fd","modified":1598712465801},{"_id":"themes/pure/layout/_partial/archive-link.ejs","hash":"fe4d9bf526d8176683cea89b8561ced571374db0","modified":1598712465802},{"_id":"themes/pure/layout/_partial/archive-post.ejs","hash":"13039fec017332029122ef99901755fcecbfc8ea","modified":1598712465802},{"_id":"themes/pure/layout/_partial/archive-list.ejs","hash":"c66c86d6a6a90e00494c380603426fc0f4006311","modified":1598712465802},{"_id":"themes/pure/layout/_partial/archive-repository.ejs","hash":"e39dc762d9fe238cede462532e40eaa3d8651122","modified":1598712465803},{"_id":"themes/pure/layout/_partial/archive-tag.ejs","hash":"5de90244c3cedad531cccc03c40e5f9a3aef3c61","modified":1598712465803},{"_id":"themes/pure/layout/_partial/archive.ejs","hash":"4d6793f50d41fbd47dc50aa36b24d496006bba6c","modified":1598712465804},{"_id":"themes/pure/layout/_partial/article-about.ejs","hash":"7b80319daeb63401d1745b81cd9a6d1d21a4fb60","modified":1598712465804},{"_id":"themes/pure/layout/_partial/item-post.ejs","hash":"9f755b0da1ea928dece32c2050d8a04b3a9fb13b","modified":1598712465805},{"_id":"themes/pure/layout/_partial/article.ejs","hash":"0f9b71de0087d1f777d92c5a0f3873971aec5a5b","modified":1598712465805},{"_id":"themes/pure/layout/_partial/pagination.ejs","hash":"41a319642da5af07d6cfb8525796aa610b721879","modified":1598712465805},{"_id":"themes/pure/layout/_partial/sidebar-about.ejs","hash":"e10ea0176ba87e64888234bafedc01c92544352c","modified":1598712465812},{"_id":"themes/pure/layout/_partial/sidebar-toc.ejs","hash":"152538ceceb0fdef65c46470ebf0189f7b891c5b","modified":1598712465812},{"_id":"themes/pure/layout/_partial/sidebar.ejs","hash":"2aa8a9f90838e7c105e75e6d3d03cbf860bb1239","modified":1598712465813},{"_id":"themes/pure/layout/_search/baidu.ejs","hash":"67aab280a3ea34429f086cc5c3de7de17727c567","modified":1598712465823},{"_id":"themes/pure/layout/_search/index-mobile.ejs","hash":"c726e234c0166da69fdfbd3dd613a5eaf4c80258","modified":1598712465823},{"_id":"themes/pure/layout/_search/index.ejs","hash":"f8d5a9c3f777250f5fb6512bba585307f784d5cd","modified":1598712465823},{"_id":"themes/pure/layout/_search/insight.ejs","hash":"4af3e92ef98bedba9680d45699cb04dde4640536","modified":1598712465824},{"_id":"themes/pure/layout/_search/swiftype.ejs","hash":"4baeca36e410181300ae7d47ba1fb4755bcfcff0","modified":1598712465824},{"_id":"themes/pure/layout/_widget/archive.ejs","hash":"af8ad7f62877764b75d5272d9d899fd6c8e3845c","modified":1598712465825},{"_id":"themes/pure/layout/_widget/board.ejs","hash":"acd27451be52703e670ce0b313f2da6fa24071e4","modified":1598712465825},{"_id":"themes/pure/layout/_widget/recent_posts.ejs","hash":"8942d60311797a591ba2d157c5cdd23e85ceb694","modified":1598712465827},{"_id":"themes/pure/layout/_widget/tag.ejs","hash":"487628925da5fcac91463cdad3d9e55d071bd5ed","modified":1598712465827},{"_id":"themes/pure/layout/_widget/category.ejs","hash":"331b7642a0f58b9088b937436ab39076a4c5dd7e","modified":1598712465826},{"_id":"themes/pure/layout/_widget/tagcloud.ejs","hash":"3291108e5411c48b2c5b3e17adace6ffa90d1c29","modified":1598712465827},{"_id":"themes/pure/source/fonts/iconfont.eot","hash":"6819d9bb643bdeafc17bfecb0746ae641b018fdf","modified":1598712465862},{"_id":"themes/pure/source/fonts/README.md","hash":"c5772b99ad81291fb137b330813f866bdceea0a3","modified":1598712465861},{"_id":"themes/pure/source/fonts/iconfont.ttf","hash":"9b8837f9f79cf6ab794736301d0665345183a20c","modified":1598712465866},{"_id":"themes/pure/source/fonts/iconfont.woff","hash":"78d29194287b8885d25212048c4f787705212a6e","modified":1598712465867},{"_id":"themes/pure/source/images/avatar.jpg","hash":"f86eafc318f3900319b25057811720168f24d248","modified":1598712465868},{"_id":"themes/pure/source/images/thumb-default.png","hash":"e8403b97ed9251f9f5207765b0ce796c5000b4ba","modified":1598712465871},{"_id":"themes/pure/source/images/xingqiu-qrcode.jpg","hash":"ef2c2848dc79db6df7c752510651ed8ba57f2daf","modified":1598712465872},{"_id":"themes/pure/source/js/application.js","hash":"46d1fb207ce5f0acb83803f927985dfcea86f9ef","modified":1598712465873},{"_id":"themes/pure/source/js/application.min.js","hash":"34d765e982c7d6360c37f82202d99f63ac40e408","modified":1598712465873},{"_id":"themes/pure/source/js/insight.js","hash":"298e8ca42517984bd26f34caa4c45560b0e909ad","modified":1598712465873},{"_id":"themes/pure/source/js/plugin.js","hash":"a8524d42b8621bfaa06602a163c6a1f82702b91d","modified":1598712465877},{"_id":"themes/pure/source/js/plugin.min.js","hash":"07fe34638f9832702c5f81d8583c5e4e8b3d9659","modified":1598712465880},{"_id":"themes/pure/layout/_script/_analytics/baidu-analytics.ejs","hash":"f314be7860c1d5930f1600d010e3120ba5c85325","modified":1598712465814},{"_id":"themes/pure/layout/_script/_analytics/google-analytics.ejs","hash":"54f1dc9375cbdb65464e0ac1b58847aa5e8bc6a5","modified":1598712465814},{"_id":"themes/pure/layout/_script/_analytics/tencent-analytics.ejs","hash":"77defb41a1613a758ff5a6a5128c6107fc584190","modified":1598712465815},{"_id":"themes/pure/layout/_script/_comment/disqus.ejs","hash":"a051e3eddc75586e69131c29ab8c89d69626e0fd","modified":1598712465815},{"_id":"themes/pure/layout/_script/_comment/gitalk.ejs","hash":"fb01f1631c3ae7fe6211dc03233506cb344229be","modified":1598712465815},{"_id":"themes/pure/layout/_script/_comment/gitment.ejs","hash":"a64852076483395738a398deb4c10bdb0f3b7b71","modified":1598712465816},{"_id":"themes/pure/layout/_script/_comment/livere.ejs","hash":"5ab997d5ee4475d2f89f882fab4a52648dbe0e30","modified":1598712465816},{"_id":"themes/pure/layout/_script/_comment/valine.ejs","hash":"acf81f9a59dc45f197d723f70484de5fcd166577","modified":1598712465817},{"_id":"themes/pure/layout/_script/_comment/youyan.ejs","hash":"095649a173573d03b5845c2e331ec7be976b152a","modified":1598712465817},{"_id":"themes/pure/layout/_script/_search/baidu.ejs","hash":"9b60ffa2e2725a993e9cecfb81ddedd9b9361011","modified":1598712465818},{"_id":"themes/pure/layout/_script/_search/insight.ejs","hash":"3543c11d060feaf9381b5d87564b01ffef0e0a59","modified":1598712465818},{"_id":"themes/pure/layout/_partial/post/category.ejs","hash":"fcee6b4aef8b6c4627831ff8dbb2d73478511426","modified":1598712465806},{"_id":"themes/pure/layout/_partial/post/comment.ejs","hash":"3c0da69fcea6ccfd97b82d50e740107a88eec5c4","modified":1598712465807},{"_id":"themes/pure/layout/_partial/post/copyright.ejs","hash":"a9d3d05428e5844a07706c7fcfeb842e44a36a64","modified":1598712465807},{"_id":"themes/pure/layout/_partial/post/date.ejs","hash":"7d4979652998abf92a64bfae8157b70d6e514057","modified":1598712465808},{"_id":"themes/pure/layout/_partial/post/donate.ejs","hash":"a251dc34d660601a2e8b7d98b3bfe2b9023dbbce","modified":1598712465808},{"_id":"themes/pure/layout/_partial/post/gallery.ejs","hash":"3d9d81a3c693ff2378ef06ddb6810254e509de5b","modified":1598712465808},{"_id":"themes/pure/layout/_partial/post/nav.ejs","hash":"95eabc0fe4033ec61b240a16eeaf7dc62a9e3da1","modified":1598712465809},{"_id":"themes/pure/layout/_partial/post/pv.ejs","hash":"ec3ccf322432afc2761f860c5a3000ac34d46e4c","modified":1598712465809},{"_id":"themes/pure/layout/_partial/post/tag.ejs","hash":"39f53ead07f75c181a7ba93e586dd1b8171620f1","modified":1598712465810},{"_id":"themes/pure/layout/_partial/post/thumbnail.ejs","hash":"080d5c5f3e95accf51893a7092695fe32d34a087","modified":1598712465810},{"_id":"themes/pure/layout/_partial/post/title.ejs","hash":"2f275739b6f1193c123646a5a31f37d48644c667","modified":1598712465811},{"_id":"themes/pure/layout/_partial/post/wordcount.ejs","hash":"bd06c4c8449ed96aabf655fe1ae3be1f0707b81e","modified":1598712465811},{"_id":"themes/pure/source/css/style.min.css","hash":"1d23abc76726ebe042f7df4749f00f8f73338444","modified":1598712465859},{"_id":"themes/pure/source/fonts/iconfont.svg","hash":"25929e6e74f7027acd1f6467a67e95b153bcd8d5","modified":1598712465864},{"_id":"themes/pure/source/images/donate/alipayimg.png","hash":"9562f23f2eb57841c65dc769b6cc43a2cf0efa94","modified":1598712465868},{"_id":"themes/pure/source/images/favatar/SzsFox-logo.png","hash":"d71fcc73b7bc2a439d8c7ba461137856d190bd76","modified":1598712465870},{"_id":"themes/pure/source/images/donate/wechatpayimg.png","hash":"c0844d9a633696cb00ae64fde06f0f924f63b596","modified":1598712465869},{"_id":"themes/pure/source/images/favatar/chuangzaoshi-logo.png","hash":"7fa5734072050952159a02d330bbc008b5a99122","modified":1598712465870},{"_id":"themes/pure/source/images/favatar/idesign-logo.png","hash":"6b150a2dbb9912b7a7662255c27e4d4baaecee71","modified":1598712465871},{"_id":"themes/pure/source/js/jquery.min.js","hash":"5a9dcfbef655a2668e78baebeaa8dc6f41d8dabb","modified":1598712465875},{"_id":"themes/pure/source/js/plugin.js.map","hash":"1730c0cc660f863120aca0a439d7264e2e245fc5","modified":1598712465878},{"_id":"source/_posts/2020/2020-08/.DS_Store","hash":"c2b9b68c6039f1f4bc51d84c5c443a93bf59f722","modified":1598685131686},{"_id":"source/_posts/2020/2020-08/2020-08-29.md","hash":"7983fd74eaca42c3aec9125b7523462b9135bb01","modified":1598686822445},{"_id":"source/_posts/2020/2020-08/2020-08-30-1.md","hash":"da3047e1c153ff8e7c2cad69ceccbed715f5c63b","modified":1598761363634},{"_id":"source/_posts/2020/2020-08/2020-08-30.md","hash":"dc960829ec14fee546f9ac96e47724ef280c6849","modified":1598719542856},{"_id":"source/_posts/2020/2020-08/2020-08-31.md","hash":"de194b087f067467ddd249f70a58a0758263229f","modified":1598875374980},{"_id":"source/_posts/2020/2020-09/2020-09-02.md","hash":"9f57248f4ace99c8724a6fbc112f4fa7b371904f","modified":1599102320989},{"_id":"source/_posts/2020/2020-09/2020-09-07.md","hash":"cc3352effe704d73d73fd4fb9543af07be6c301c","modified":1599493058157},{"_id":"source/_posts/2020/2020-09/2020-09-09.md","hash":"ec227b1e2c4ed71fe89dac44ff2b7b48a28030ec","modified":1599617529571},{"_id":"themes/pure/source/css/style.css","hash":"3b693ce41c2e35ece4773593e94b4c17aeaee02f","modified":1598712465857},{"_id":"source/_posts/2020/2020-08/media/OIP-1.jpeg","hash":"43652a8eca0de72456d2e21e995e91fc24a67d45","modified":1598685086276},{"_id":"source/_posts/2020/2020-08/media/OIP-2.jpeg","hash":"43652a8eca0de72456d2e21e995e91fc24a67d45","modified":1598685086276},{"_id":"source/_posts/2020/2020-08/media/OIP-3.jpeg","hash":"43652a8eca0de72456d2e21e995e91fc24a67d45","modified":1598685086276},{"_id":"source/_posts/2020/2020-08/media/OIP.jpeg","hash":"43652a8eca0de72456d2e21e995e91fc24a67d45","modified":1598685086276},{"_id":"source/_posts/2020/2020-08/media/OIP-4.jpeg","hash":"43652a8eca0de72456d2e21e995e91fc24a67d45","modified":1598685086276},{"_id":"source/_posts/2020/2020-08/media/WechatIMG151.png","hash":"75d501236e66376f9ead74584000089f7e2b4334","modified":1598859942266},{"_id":"source/_posts/2020/2020-09/media/OIP -2-.jpeg","hash":"64a7837257e358c5f9e244fe7e1d2f19423f83b0","modified":1599484066181},{"_id":"source/_posts/2020/2020-09/media/WechatIMG508.jpeg","hash":"57277000e3eec8d5a278b815170bcb8b14aab9ba","modified":1599485031710},{"_id":"source/_posts/2020/2020-09/media/程序内存运行.jpg","hash":"f7a6c3061dc55ad31da1bf6877d7c1ff70c7383c","modified":1599100903802},{"_id":"source/_posts/2020/2020-08/media/1598719074737.jpg","hash":"ee3374c1eb0f945d6d004876b09a99c3bc6246d1","modified":1598719077179},{"_id":"source/_posts/2020/2020-09/media/1599484611181.jpg","hash":"4ce9aed2d3bb7f1556df580972842e73912baab7","modified":1599484613457},{"_id":"source/_posts/2020/2020-09/media/WechatIMG159.jpeg","hash":"3ab54847f0c7180f803b78b23613340969fdb0a6","modified":1599485420498},{"_id":"source/_posts/2020/2020-09/media/1599064164048.jpg","hash":"13d337c34b36ae50d612ac4b8fb41158af6a9743","modified":1599064167142},{"_id":"source/_posts/2020/2020-08/media/1598874970974.jpg","hash":"fade03390ca0f2accd1cef71cb7c2e1ea10c22d4","modified":1598874973371},{"_id":"source/_posts/2020/2020-09/media/WechatIMG509.png","hash":"a60c44e45e820bec676ef325100e422d5235d6cf","modified":1599485103371},{"_id":"themes/pure/screenshot/pure.psd","hash":"a31cea40b45bdc31f051fca2f1e2f4ecbaee1a94","modified":1598712465854},{"_id":"public/baidusitemap.xml","hash":"775ab0504ae9027f80ca369bd4e4c38ae2e977f5","modified":1600361377712},{"_id":"public/atom.xml","hash":"ff5678beab7e37a5a013caa55104c132ec10e46e","modified":1600361378214},{"_id":"public/content.json","hash":"6662e1a7f3ef70dd93421faad40073fb710e15f8","modified":1600361377715},{"_id":"public/sitemap.xml","hash":"c453ab01283238ec49b50cf0610b8d5a8390eb12","modified":1600361378213},{"_id":"public/404.html","hash":"9919715592805f1cd9002d4928950b9f2e27f829","modified":1600361378258},{"_id":"public/about/index.html","hash":"e26007e18b381e72747b36d1ee45f4e301146b04","modified":1600361378258},{"_id":"public/books/index.html","hash":"b008bca58893b2566d1e97e1423189787b3db934","modified":1600361378297},{"_id":"public/categories/index.html","hash":"27ddc66c7fcad2eb81b4e9733b06431d532924d2","modified":1600361378296},{"_id":"public/links/index.html","hash":"b20d652810d940091d81b1aa2f661e5c30c2f219","modified":1600361378297},{"_id":"public/tags/index.html","hash":"17fe46182bfea26e07433d195182ae1b2117f7ec","modified":1600361378297},{"_id":"public/repository/index.html","hash":"e34d2eb61265e2f68deb95b25295af933b3f6841","modified":1600361378297},{"_id":"public/20202/09/09/2020/2020-09/2020-09-09/index.html","hash":"b2ac199b1aaf18ea314e482b4ff7875c898660c2","modified":1599623767486},{"_id":"public/20202/09/07/2020/2020-09/2020-09-07/index.html","hash":"39d85884d8d6f7f5771bd76be29df0305efb01d9","modified":1600361378297},{"_id":"public/2020/09/03/2020/2020-09/2020-09-02/index.html","hash":"d066a96db444b0f016b9bd15f663e83ad5993ec3","modified":1600361378297},{"_id":"public/2020/08/31/2020/2020-08/2020-08-31/index.html","hash":"5dfb48bfae41dafedba849cf6c5d404bf27374b7","modified":1600361378298},{"_id":"public/2020/08/30/2020/2020-08/2020-08-30-1/index.html","hash":"95456080c899206bd8e86b2834d99af244d1e8a4","modified":1600361378298},{"_id":"public/2020/08/30/2020/2020-08/2020-08-30/index.html","hash":"d06e121ca4c37303f9c0df112bade81d121703e3","modified":1600361378298},{"_id":"public/2020/08/29/2020/2020-08/2020-08-29/index.html","hash":"de2dc522312a3cc2436f161b272cc98fdaefdae6","modified":1600361378298},{"_id":"public/2017/06/01/2017-06-01/index.html","hash":"a43f7edcfb6dea990e1cb657d7a46afd2d26f8a8","modified":1600361378298},{"_id":"public/2017/05/27/2017-05-27/index.html","hash":"44ebe216e0b615f2611bf08c6425afd8e4680bd2","modified":1600361378298},{"_id":"public/2017/04/28/2017-04-28-1/index.html","hash":"de7e6da4775e1d210b7961eca6f2487b0bb310a9","modified":1600361378298},{"_id":"public/2017/04/28/2017-04-28/index.html","hash":"f2a705e9aa85a00d975e1310c7681f67bb79662d","modified":1600361378298},{"_id":"public/2017/04/27/2017-04-27/index.html","hash":"6e5f9fe01d6876b024fb7635f08834be5d39d62e","modified":1600361378298},{"_id":"public/2017/04/25/2017-04-25/index.html","hash":"4b890bd9a6712481282b9d131456777c409bf443","modified":1600361378298},{"_id":"public/2017/04/17/2017-04-17/index.html","hash":"b948a027415de4aeb4d1f9b54eb9ab25d2400e2f","modified":1600361378298},{"_id":"public/2016/11/28/2016-11-28/index.html","hash":"db8093353682bd308767671ad814cba13f86c38e","modified":1600361378298},{"_id":"public/2016/11/26/2016-11-26/index.html","hash":"e7ba52374257d995229c846845b35e80ed229980","modified":1600361378298},{"_id":"public/2016/04/28/go-sty01/index.html","hash":"1fc6b2345bbd67a8fbe155c13edc78bfd373faea","modified":1600361378298},{"_id":"public/2016/05/18/mongo-php-error/index.html","hash":"bada5fbfa6dc3b4ecb6cda99a12a208e53d4954b","modified":1600361378298},{"_id":"public/2016/04/21/hw-jg/index.html","hash":"298ab372e542b2bb376d70146ddfdd736619b90d","modified":1600361378298},{"_id":"public/2016/04/20/ranyao-chuangye/index.html","hash":"8185fb25ad10a555d54350d2a39b84f75ba10cf5","modified":1600361378298},{"_id":"public/2016/04/20/开篇/index.html","hash":"017ae350ee51f4ee9ed09542e03c4c56efed6ef0","modified":1600361378299},{"_id":"public/archives/index.html","hash":"b4f6b0356192a3b31d2aebcb5ab160bed277386a","modified":1600361378299},{"_id":"public/archives/page/2/index.html","hash":"b395111412b6863c148eb4d38f210c45950c6795","modified":1600361378299},{"_id":"public/archives/page/3/index.html","hash":"49ba7f05a662b4e69bd240c32d421c2d0f0ab04c","modified":1600361378299},{"_id":"public/archives/2016/index.html","hash":"f251f778ff1ec90c62b090e57aecb948c079e735","modified":1600361378299},{"_id":"public/archives/2016/05/index.html","hash":"4f3fed114d0cf4454666eadcc67b48972313b7d6","modified":1600361378299},{"_id":"public/archives/2016/11/index.html","hash":"0910087ac2340b3738dde00842d857ad1845db09","modified":1600361378299},{"_id":"public/archives/2016/04/index.html","hash":"7f67de91d76f8c878c232a80dfc69987cdf84b90","modified":1600361378299},{"_id":"public/archives/2017/index.html","hash":"f0cf29b8e637199e262ffb0c21bf4f6ff00f006f","modified":1600361378299},{"_id":"public/archives/2017/04/index.html","hash":"ed8b06f9f1d5aeb3cd92a5a01e1696f8961f18cd","modified":1600361378299},{"_id":"public/archives/2017/05/index.html","hash":"09e058d114521588db27304630d3e7d57f60ada6","modified":1600361378299},{"_id":"public/archives/2017/06/index.html","hash":"8951f56fdd1d5dab17862b00fbea7f2f29f474aa","modified":1600361378299},{"_id":"public/archives/2020/index.html","hash":"e871b80c905c34b6d1e50e29079eae3272a0ee33","modified":1600361378299},{"_id":"public/archives/2020/08/index.html","hash":"9071dcabe0fd3aad8d4f89e0260238b8168b2278","modified":1600361378299},{"_id":"public/archives/2020/09/index.html","hash":"bdcdfb8a58d1cc3c6d07497ba6d020148f1c9689","modified":1600361378299},{"_id":"public/archives/20202/index.html","hash":"e79926ff2f4606aa26b855ef0d34eacb22e5bb79","modified":1600361378299},{"_id":"public/archives/20202/09/index.html","hash":"764f7327fa5ebcfdd9029cd880e0963ae831d5d8","modified":1600361378299},{"_id":"public/index.html","hash":"424f20658955fe558adfb875a726eb42a0556792","modified":1600361378299},{"_id":"public/page/2/index.html","hash":"afff1837ceda00b3904c261d03682f1694a19c62","modified":1600361378299},{"_id":"public/page/3/index.html","hash":"ee16965d9b23415295d98f7d74b9d14b147e0e4e","modified":1600361378300},{"_id":"public/categories/test/index.html","hash":"831575f6d0085a7c375c56c38211be7873da357b","modified":1599623767488},{"_id":"public/tags/go/index.html","hash":"a615805a0540117d61aed5e3ecffad9c158cff35","modified":1600361378300},{"_id":"public/tags/delve/index.html","hash":"308d39b8d147bf256cc3f94672edd588a0ec837e","modified":1600361378300},{"_id":"public/tags/ubuntu/index.html","hash":"5c90f342c60df6806381a3ccd8552bd865d44fdd","modified":1600361378300},{"_id":"public/tags/性能测试/index.html","hash":"2cbb186c2496d03dea7287c8c11f60079f2083b6","modified":1600361378300},{"_id":"public/tags/docker/index.html","hash":"1171c6297a0dcc9564dbc7912d8a5f510aa48035","modified":1600361378300},{"_id":"public/tags/php/index.html","hash":"a10797d192e05a2bf79255a0731fd26856d9697c","modified":1600361378300},{"_id":"public/tags/nodejs/index.html","hash":"eff542f6c0ea159b44b3ac42041a234827bf0ffe","modified":1600361378300},{"_id":"public/tags/nginx/index.html","hash":"649c148e993259d063aeb3e3669e4ec1e082b726","modified":1600361378300},{"_id":"public/tags/phpstrom/index.html","hash":"a4568f687ae86794b6a03af39468c3dbf3bcaa5e","modified":1600361378300},{"_id":"public/tags/jetbrains/index.html","hash":"649d1d799be826c7b2457de860f0797f1e7ed62e","modified":1600361378300},{"_id":"public/tags/operator-mono/index.html","hash":"3c87d8adef978ea7d63270c8a1500d28115954f5","modified":1600361378300},{"_id":"public/tags/fira-code/index.html","hash":"c7e9019bdb0ccd8a76ca7b4f0faa3553968f2345","modified":1600361378300},{"_id":"public/tags/php-jit/index.html","hash":"ab3a5b3b157c09baadbf77b31e8502879db1512f","modified":1600361378300},{"_id":"public/tags/golang/index.html","hash":"b6dee21fbfc4903e5b94f16b6d02148428130a94","modified":1600361378300},{"_id":"public/tags/架构/index.html","hash":"253b08b89bdff2ba7c3c67eb2e0d162c11482df5","modified":1600361378300},{"_id":"public/tags/mongo/index.html","hash":"62f719d08e91d697098da7af965a11070bbb31c0","modified":1600361378300},{"_id":"public/tags/php-mongo/index.html","hash":"abb3abd0293014d438d7681d5c4db7186e682f95","modified":1600361378300},{"_id":"public/tags/swoole/index.html","hash":"2d72b7c4d09205b85fc3f540e27e2c3ab44e9b5c","modified":1600361378301},{"_id":"public/tags/tcp/index.html","hash":"ae5f3198e3f6656c25d9ea35bdadd35ba6c1194b","modified":1600361378301},{"_id":"public/tags/gitlab/index.html","hash":"6480fe005ebbbed12a78dfbd84810aaa01069348","modified":1600361378301},{"_id":"public/tags/linux/index.html","hash":"0a05273f24818485a49a1e2c02fd4df964b7d32d","modified":1600361378301},{"_id":"public/tags/内网穿透/index.html","hash":"21eab342a2e87b1142c926087c39f2bf91de40d8","modified":1600361378301},{"_id":"public/tags/frp/index.html","hash":"3ceef10b695becf07942107cc81a65f5144bc5fe","modified":1600361378301},{"_id":"public/tags/hexo/index.html","hash":"d66d83551f19752bfab7d112cb62d8f79f659827","modified":1600361378301},{"_id":"public/tags/pure/index.html","hash":"5eb541f8a096186b3d4cc093fa351d0add0c4638","modified":1600361378301},{"_id":"public/tags/c/index.html","hash":"d61f5291baaa87e8d94f22d41d4f38952d6c2e9c","modified":1600361378301},{"_id":"public/tags/内存/index.html","hash":"e7d66c4b787fd63fe0dcd42e6d78d52bb2cd43ee","modified":1600361378301},{"_id":"public/tags/堆栈/index.html","hash":"aa79dc7efb09aa89654ac40837e660c92423bf53","modified":1600361378301},{"_id":"public/tags/树莓派/index.html","hash":"e1787200503331e8157ac9950d5e2275af72839a","modified":1600361378301},{"_id":"public/tags/test/index.html","hash":"faebbf4700fee1ad8e83d83efef30aa217824a6b","modified":1599623767489},{"_id":"public/favicon.png","hash":"89875d3b018552e396fc5f0bd8ff5d9f5d4a5d71","modified":1599623767493},{"_id":"public/fonts/iconfont.eot","hash":"6819d9bb643bdeafc17bfecb0746ae641b018fdf","modified":1599623767493},{"_id":"public/fonts/iconfont.ttf","hash":"9b8837f9f79cf6ab794736301d0665345183a20c","modified":1599623767493},{"_id":"public/fonts/iconfont.woff","hash":"78d29194287b8885d25212048c4f787705212a6e","modified":1599623767493},{"_id":"public/images/thumb-default.png","hash":"e8403b97ed9251f9f5207765b0ce796c5000b4ba","modified":1599623767493},{"_id":"public/images/avatar.jpg","hash":"f86eafc318f3900319b25057811720168f24d248","modified":1599623767493},{"_id":"public/images/xingqiu-qrcode.jpg","hash":"ef2c2848dc79db6df7c752510651ed8ba57f2daf","modified":1599623767493},{"_id":"public/images/donate/alipayimg.png","hash":"9562f23f2eb57841c65dc769b6cc43a2cf0efa94","modified":1599623767493},{"_id":"public/images/favatar/SzsFox-logo.png","hash":"d71fcc73b7bc2a439d8c7ba461137856d190bd76","modified":1599623767494},{"_id":"public/images/donate/wechatpayimg.png","hash":"c0844d9a633696cb00ae64fde06f0f924f63b596","modified":1599623767494},{"_id":"public/images/favatar/chuangzaoshi-logo.png","hash":"7fa5734072050952159a02d330bbc008b5a99122","modified":1599623767494},{"_id":"public/images/favatar/idesign-logo.png","hash":"6b150a2dbb9912b7a7662255c27e4d4baaecee71","modified":1599623767494},{"_id":"public/js/application.min.js","hash":"34d765e982c7d6360c37f82202d99f63ac40e408","modified":1599623767509},{"_id":"public/js/insight.js","hash":"298e8ca42517984bd26f34caa4c45560b0e909ad","modified":1599623767509},{"_id":"public/js/plugin.min.js","hash":"07fe34638f9832702c5f81d8583c5e4e8b3d9659","modified":1599623767509},{"_id":"public/js/application.js","hash":"46d1fb207ce5f0acb83803f927985dfcea86f9ef","modified":1599623767509},{"_id":"public/js/plugin.js","hash":"a8524d42b8621bfaa06602a163c6a1f82702b91d","modified":1599623767509},{"_id":"public/css/style.min.css","hash":"1d23abc76726ebe042f7df4749f00f8f73338444","modified":1599623767509},{"_id":"public/js/jquery.min.js","hash":"5a9dcfbef655a2668e78baebeaa8dc6f41d8dabb","modified":1599623767509},{"_id":"public/css/style.css","hash":"3b693ce41c2e35ece4773593e94b4c17aeaee02f","modified":1599623767510},{"_id":"public/fonts/README.html","hash":"26a13286f808d3ef09314df865be3049eef3906f","modified":1599623767510},{"_id":"public/fonts/iconfont.svg","hash":"25929e6e74f7027acd1f6467a67e95b153bcd8d5","modified":1599623767510},{"_id":"public/js/plugin.js.map","hash":"1730c0cc660f863120aca0a439d7264e2e245fc5","modified":1599623767510},{"_id":"source/_posts/2020/2020-09/2020-09-18.md","hash":"d33af6a2a576905c387eb25a3c1debe192538ed6","modified":1600361345433},{"_id":"source/_posts/2020/2020-09/media/python生态工具.jpeg","hash":"d527a51a0c1879130171c6c8af64e27f49fde30a","modified":1600356750439},{"_id":"public/2020/09/18/2020/2020-09/2020-09-18/index.html","hash":"5acaccd5d50ae75c8c613a8d0d5a0562d65cf7ec","modified":1600361378303},{"_id":"public/categories/python/index.html","hash":"1c313fac821c87970a565fc4147b5b0f85d54948","modified":1600361378303},{"_id":"public/tags/python/index.html","hash":"6516b3c0ab0e6fa823942ccb89d24c8dde6d301a","modified":1600361378303},{"_id":"public/tags/pyenv/index.html","hash":"f2979d8718fdc8ecc8cfdadba7a8031e757b58c9","modified":1600361378303}],"Category":[{"name":"test","_id":"ckeuuot290027ip9kr4arnyl7"},{"name":"python","_id":"ckf71udd000017l9kfd0ux64t"}],"Data":[],"Page":[{"title":"404 Not Found：该页无法显示","toc":false,"comments":0,"_content":"<script type=\"text/javascript\" src=\"//www.qq.com/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"<%- config.url %>\" homePageName=\"回到我的主页\"></script>\n","source":"404/index.md","raw":"---\ntitle: 404 Not Found：该页无法显示\ntoc: false\ncomments: false\npermalink: /404\n---\n<script type=\"text/javascript\" src=\"//www.qq.com/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"<%- config.url %>\" homePageName=\"回到我的主页\"></script>\n","date":"2020-08-29T14:47:45.781Z","updated":"2020-08-29T14:47:45.781Z","path":"/404.html","layout":"page","_id":"ckeuuoszq0000ip9kxxt4sc1v","content":"<script type=\"text/javascript\" src=\"//www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"<%- config.url %>\" homepagename=\"回到我的主页\"></script>\n","site":{"data":{}},"excerpt":"","more":"<script type=\"text/javascript\" src=\"//www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"<%- config.url %>\" homepagename=\"回到我的主页\"></script>\n"},{"title":"关于","description":"个人简介","layout":"about","comments":0,"sidebar":"custom","_content":"个人详细介绍","source":"about/index.md","raw":"---\ntitle: 关于\ndescription: 个人简介\nlayout: about\ncomments: false\nsidebar: custom\n---\n个人详细介绍","date":"2020-08-29T14:47:45.787Z","updated":"2020-08-29T14:47:45.787Z","path":"about/index.html","_id":"ckeuuoszx0002ip9k6hl5wneb","content":"<p>个人详细介绍</p>\n","site":{"data":{}},"excerpt":"","more":"<p>个人详细介绍</p>\n"},{"title":"书单","layout":"books","comments":0,"sidebar":"none","_content":"\n# douban 豆瓣书单\ndouban:\n  user: webwlsong # 豆瓣用户名\n  start: 0 # 从哪一条记录开始\n  count: 100 # 获取豆瓣书单数据条\n","source":"books/index.md","raw":"---\ntitle: 书单\nlayout: books\ncomments: false\nsidebar: none\n---\n\n# douban 豆瓣书单\ndouban:\n  user: webwlsong # 豆瓣用户名\n  start: 0 # 从哪一条记录开始\n  count: 100 # 获取豆瓣书单数据条\n","date":"2020-08-29T14:47:45.787Z","updated":"2020-08-29T14:47:45.787Z","path":"books/index.html","_id":"ckeuuot020005ip9k0qinkwfi","content":"<h1 id=\"douban-豆瓣书单\"><a class=\"markdownIt-Anchor\" href=\"#douban-豆瓣书单\"></a> douban 豆瓣书单</h1>\n<p>douban:<br>\nuser: webwlsong # 豆瓣用户名<br>\nstart: 0 # 从哪一条记录开始<br>\ncount: 100 # 获取豆瓣书单数据条</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"douban-豆瓣书单\"><a class=\"markdownIt-Anchor\" href=\"#douban-豆瓣书单\"></a> douban 豆瓣书单</h1>\n<p>douban:<br>\nuser: webwlsong # 豆瓣用户名<br>\nstart: 0 # 从哪一条记录开始<br>\ncount: 100 # 获取豆瓣书单数据条</p>\n"},{"title":"分类","layout":"categories","comments":0,"_content":"\n# Github\ngithub: \n  username: webwlsong  # github username","source":"categories/index.md","raw":"---\ntitle: 分类\nlayout: categories\ncomments: false\n---\n\n# Github\ngithub: \n  username: webwlsong  # github username","date":"2020-08-29T14:47:45.787Z","updated":"2020-08-29T14:47:45.787Z","path":"categories/index.html","_id":"ckeuuot040007ip9kvgqldjik","content":"<h1 id=\"github\"><a class=\"markdownIt-Anchor\" href=\"#github\"></a> Github</h1>\n<p>github:<br>\nusername: webwlsong  # github username</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"github\"><a class=\"markdownIt-Anchor\" href=\"#github\"></a> Github</h1>\n<p>github:<br>\nusername: webwlsong  # github username</p>\n"},{"title":"友情链接","layout":"links","comments":1,"sidebar":"none","_content":"\n\nName:\n    link: http://example.com\n    avatar: http://example.com/avatar.png\n    desc: \"这是一个描述\"","source":"links/index.md","raw":"---\ntitle: 友情链接\nlayout: links\ncomments: true\nsidebar: none\n---\n\n\nName:\n    link: http://example.com\n    avatar: http://example.com/avatar.png\n    desc: \"这是一个描述\"","date":"2020-08-29T14:47:45.787Z","updated":"2020-08-29T14:47:45.787Z","path":"links/index.html","_id":"ckeuuot070009ip9krbit3jv8","content":"<p>Name:<br>\nlink: <a href=\"http://example.com\" target=\"_blank\" rel=\"noopener\">http://example.com</a><br>\navatar: <a href=\"http://example.com/avatar.png\" target=\"_blank\" rel=\"noopener\">http://example.com/avatar.png</a><br>\ndesc: “这是一个描述”</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Name:<br>\nlink: <a href=\"http://example.com\" target=\"_blank\" rel=\"noopener\">http://example.com</a><br>\navatar: <a href=\"http://example.com/avatar.png\" target=\"_blank\" rel=\"noopener\">http://example.com/avatar.png</a><br>\ndesc: “这是一个描述”</p>\n"},{"title":"标签","layout":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"---\ntitle: 标签\nlayout: tags\ncomments: false\n---\n","date":"2020-08-29T14:47:45.788Z","updated":"2020-08-29T14:47:45.788Z","path":"tags/index.html","_id":"ckeuuot14001sip9kcxl6hg8c","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"Repositories","layout":"repository","comments":0,"sidebar":"none","_content":"","source":"repository/index.md","raw":"---\ntitle: Repositories\nlayout: repository\ncomments: false\nsidebar: none\n---\n","date":"2020-08-29T14:47:45.788Z","updated":"2020-08-29T14:47:45.788Z","path":"repository/index.html","_id":"ckeuuot15001tip9klg2bmuwf","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"解决go delve 不能使用 OS X cannot get thread count","date":"2016-11-25T16:00:00.000Z","_content":"\ngo Delve 报错\n\nmac 解决方法如下：\n我的go版本 ：go version go1.7.3 darwin/amd64\n\n\n\nhttps://github.com/derekparker/delve/issues/645\n`\n1. go into your GOPATH\n2. create folder $GOPATH/src/github.com/derekparker/, and go into this folder.\n3. 'cd $GOPATH/src/github.com/derekparker/'\n4. git clone https://github.com/derekparker/delve.git\n5. cd delve\n6. git fetch origin pull/665/head\n7. git checkout FETCH_HEAD\n8. CERT=dlv-cert make install\n`\n\n\n","source":"_posts/2016-11-26.md","raw":"---\ntitle: 解决go delve 不能使用 OS X cannot get thread count\ndate: 2016-11-26\ntags: [go,delve]\n---\n\ngo Delve 报错\n\nmac 解决方法如下：\n我的go版本 ：go version go1.7.3 darwin/amd64\n\n\n\nhttps://github.com/derekparker/delve/issues/645\n`\n1. go into your GOPATH\n2. create folder $GOPATH/src/github.com/derekparker/, and go into this folder.\n3. 'cd $GOPATH/src/github.com/derekparker/'\n4. git clone https://github.com/derekparker/delve.git\n5. cd delve\n6. git fetch origin pull/665/head\n7. git checkout FETCH_HEAD\n8. CERT=dlv-cert make install\n`\n\n\n","slug":"2016-11-26","published":1,"updated":"2020-08-30T04:04:21.922Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuoszs0001ip9kipcdmpzr","content":"<p>go Delve 报错</p>\n<p>mac 解决方法如下：<br>\n我的go版本 ：go version go1.7.3 darwin/amd64</p>\n<p><a href=\"https://github.com/derekparker/delve/issues/645\" target=\"_blank\" rel=\"noopener\">https://github.com/derekparker/delve/issues/645</a><br>\n`</p>\n<ol>\n<li>go into your GOPATH</li>\n<li>create folder $GOPATH/src/github.com/derekparker/, and go into this folder.</li>\n<li>‘cd $GOPATH/src/github.com/derekparker/’</li>\n<li>git clone <a href=\"https://github.com/derekparker/delve.git\" target=\"_blank\" rel=\"noopener\">https://github.com/derekparker/delve.git</a></li>\n<li>cd delve</li>\n<li>git fetch origin pull/665/head</li>\n<li>git checkout FETCH_HEAD</li>\n<li>CERT=dlv-cert make install<br>\n`</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<p>go Delve 报错</p>\n<p>mac 解决方法如下：<br>\n我的go版本 ：go version go1.7.3 darwin/amd64</p>\n<p><a href=\"https://github.com/derekparker/delve/issues/645\" target=\"_blank\" rel=\"noopener\">https://github.com/derekparker/delve/issues/645</a><br>\n`</p>\n<ol>\n<li>go into your GOPATH</li>\n<li>create folder $GOPATH/src/github.com/derekparker/, and go into this folder.</li>\n<li>‘cd $GOPATH/src/github.com/derekparker/’</li>\n<li>git clone <a href=\"https://github.com/derekparker/delve.git\" target=\"_blank\" rel=\"noopener\">https://github.com/derekparker/delve.git</a></li>\n<li>cd delve</li>\n<li>git fetch origin pull/665/head</li>\n<li>git checkout FETCH_HEAD</li>\n<li>CERT=dlv-cert make install<br>\n`</li>\n</ol>\n"},{"title":"docker ubuntu ping source 不能使用","date":"2016-11-27T16:00:00.000Z","_content":"\n# 使用docker 拉取ubunut 镜像\n我本地使用的ubuntu 镜像版本如下：\n\n```\nsh-4.3# cat /etc/issue\nUbuntu 16.04.1 LTS \\n \\l\n\nsh-4.3#\n```\n\n\n\n\n##   拉取ubuntu进行，你会发现有的镜像Ping都不通\n\n解决方法： apt-get update 更新源\n\n## source 和 ubunut的代码补全也不能使用\n\n\nshell脚本中source  时提示 source: not found\n\n\nDebian和Ubuntu中，/bin/sh默认已经指向dash，这是一个不同于bash的shell，它主要是为了执行脚本而出现，而不是交互，它速度更快，但功能相比bash要少很多，语法严格遵守POSIX标准\n\ndash不是为交互而生的，所以我们在使用过程中还是习惯的修改成bash\n\n\n```\nls -l /bin/sh  \n显示 /bin/sh  ->dash \n显示使用的是dash \n```\n修改默认的shell \n\n```\nsudo dpkg-reconfigure dash\n\n再次检查一下， ls /bin/sh -al 发现软链接指向/bin/bash\n\n```\n\n##  恢复ubuntu bash下的自动补全\n\n\n```\n\n1. 确认/etc/bash_completion是否存在，如果没有就安装一个：\n2. apt-get install bash-completion\n在用户的shell中运行：\n3. source /etc/bash_completion\n\n```\n\n##  添加新的用户 ubuntn下面\n\n```\nuseradd  -m username  //ubuntu 自动创建用户目录\npasswd username  //创建密码\nusermod -a -G sudo username //用户拥有权限\n\nubuntu 默认的是dash shell\n\n修改成 bash\nvi /etc/passwd \n1.username:x:1000:1000::/home/username\n修成成如下：\n2. username:x:1000:1000::/home/username:/bin/bash\n```\n\n\n","source":"_posts/2016-11-28.md","raw":"---\ntitle: docker ubuntu ping source 不能使用\ndate: 2016-11-28\ntags: [ubuntu,docker]\n---\n\n# 使用docker 拉取ubunut 镜像\n我本地使用的ubuntu 镜像版本如下：\n\n```\nsh-4.3# cat /etc/issue\nUbuntu 16.04.1 LTS \\n \\l\n\nsh-4.3#\n```\n\n\n\n\n##   拉取ubuntu进行，你会发现有的镜像Ping都不通\n\n解决方法： apt-get update 更新源\n\n## source 和 ubunut的代码补全也不能使用\n\n\nshell脚本中source  时提示 source: not found\n\n\nDebian和Ubuntu中，/bin/sh默认已经指向dash，这是一个不同于bash的shell，它主要是为了执行脚本而出现，而不是交互，它速度更快，但功能相比bash要少很多，语法严格遵守POSIX标准\n\ndash不是为交互而生的，所以我们在使用过程中还是习惯的修改成bash\n\n\n```\nls -l /bin/sh  \n显示 /bin/sh  ->dash \n显示使用的是dash \n```\n修改默认的shell \n\n```\nsudo dpkg-reconfigure dash\n\n再次检查一下， ls /bin/sh -al 发现软链接指向/bin/bash\n\n```\n\n##  恢复ubuntu bash下的自动补全\n\n\n```\n\n1. 确认/etc/bash_completion是否存在，如果没有就安装一个：\n2. apt-get install bash-completion\n在用户的shell中运行：\n3. source /etc/bash_completion\n\n```\n\n##  添加新的用户 ubuntn下面\n\n```\nuseradd  -m username  //ubuntu 自动创建用户目录\npasswd username  //创建密码\nusermod -a -G sudo username //用户拥有权限\n\nubuntu 默认的是dash shell\n\n修改成 bash\nvi /etc/passwd \n1.username:x:1000:1000::/home/username\n修成成如下：\n2. username:x:1000:1000::/home/username:/bin/bash\n```\n\n\n","slug":"2016-11-28","published":1,"updated":"2020-08-30T04:04:21.926Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuoszy0003ip9ki3i50600","content":"<h1 id=\"使用docker-拉取ubunut-镜像\"><a class=\"markdownIt-Anchor\" href=\"#使用docker-拉取ubunut-镜像\"></a> 使用docker 拉取ubunut 镜像</h1>\n<p>我本地使用的ubuntu 镜像版本如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sh-4.3# cat /etc/issue</span><br><span class=\"line\">Ubuntu 16.04.1 LTS \\n \\l</span><br><span class=\"line\"></span><br><span class=\"line\">sh-4.3#</span><br></pre></td></tr></table></figure>\n<h2 id=\"拉取ubuntu进行你会发现有的镜像ping都不通\"><a class=\"markdownIt-Anchor\" href=\"#拉取ubuntu进行你会发现有的镜像ping都不通\"></a> 拉取ubuntu进行，你会发现有的镜像Ping都不通</h2>\n<p>解决方法： apt-get update 更新源</p>\n<h2 id=\"source-和-ubunut的代码补全也不能使用\"><a class=\"markdownIt-Anchor\" href=\"#source-和-ubunut的代码补全也不能使用\"></a> source 和 ubunut的代码补全也不能使用</h2>\n<p>shell脚本中source  时提示 source: not found</p>\n<p>Debian和Ubuntu中，/bin/sh默认已经指向dash，这是一个不同于bash的shell，它主要是为了执行脚本而出现，而不是交互，它速度更快，但功能相比bash要少很多，语法严格遵守POSIX标准</p>\n<p>dash不是为交互而生的，所以我们在使用过程中还是习惯的修改成bash</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -l /bin/sh  </span><br><span class=\"line\">显示 /bin/sh  -&gt;dash </span><br><span class=\"line\">显示使用的是dash</span><br></pre></td></tr></table></figure>\n<p>修改默认的shell</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo dpkg-reconfigure dash</span><br><span class=\"line\"></span><br><span class=\"line\">再次检查一下， ls /bin/sh -al 发现软链接指向/bin/bash</span><br></pre></td></tr></table></figure>\n<h2 id=\"恢复ubuntu-bash下的自动补全\"><a class=\"markdownIt-Anchor\" href=\"#恢复ubuntu-bash下的自动补全\"></a> 恢复ubuntu bash下的自动补全</h2>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">1. 确认/etc/bash_completion是否存在，如果没有就安装一个：</span><br><span class=\"line\">2. apt-get install bash-completion</span><br><span class=\"line\">在用户的shell中运行：</span><br><span class=\"line\">3. source /etc/bash_completion</span><br></pre></td></tr></table></figure>\n<h2 id=\"添加新的用户-ubuntn下面\"><a class=\"markdownIt-Anchor\" href=\"#添加新的用户-ubuntn下面\"></a> 添加新的用户 ubuntn下面</h2>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">useradd  -m username  //ubuntu 自动创建用户目录</span><br><span class=\"line\">passwd username  //创建密码</span><br><span class=\"line\">usermod -a -G sudo username //用户拥有权限</span><br><span class=\"line\"></span><br><span class=\"line\">ubuntu 默认的是dash shell</span><br><span class=\"line\"></span><br><span class=\"line\">修改成 bash</span><br><span class=\"line\">vi /etc/passwd </span><br><span class=\"line\">1.username:x:1000:1000::/home/username</span><br><span class=\"line\">修成成如下：</span><br><span class=\"line\">2. username:x:1000:1000::/home/username:/bin/bash</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"使用docker-拉取ubunut-镜像\"><a class=\"markdownIt-Anchor\" href=\"#使用docker-拉取ubunut-镜像\"></a> 使用docker 拉取ubunut 镜像</h1>\n<p>我本地使用的ubuntu 镜像版本如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sh-4.3# cat /etc/issue</span><br><span class=\"line\">Ubuntu 16.04.1 LTS \\n \\l</span><br><span class=\"line\"></span><br><span class=\"line\">sh-4.3#</span><br></pre></td></tr></table></figure>\n<h2 id=\"拉取ubuntu进行你会发现有的镜像ping都不通\"><a class=\"markdownIt-Anchor\" href=\"#拉取ubuntu进行你会发现有的镜像ping都不通\"></a> 拉取ubuntu进行，你会发现有的镜像Ping都不通</h2>\n<p>解决方法： apt-get update 更新源</p>\n<h2 id=\"source-和-ubunut的代码补全也不能使用\"><a class=\"markdownIt-Anchor\" href=\"#source-和-ubunut的代码补全也不能使用\"></a> source 和 ubunut的代码补全也不能使用</h2>\n<p>shell脚本中source  时提示 source: not found</p>\n<p>Debian和Ubuntu中，/bin/sh默认已经指向dash，这是一个不同于bash的shell，它主要是为了执行脚本而出现，而不是交互，它速度更快，但功能相比bash要少很多，语法严格遵守POSIX标准</p>\n<p>dash不是为交互而生的，所以我们在使用过程中还是习惯的修改成bash</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -l /bin/sh  </span><br><span class=\"line\">显示 /bin/sh  -&gt;dash </span><br><span class=\"line\">显示使用的是dash</span><br></pre></td></tr></table></figure>\n<p>修改默认的shell</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo dpkg-reconfigure dash</span><br><span class=\"line\"></span><br><span class=\"line\">再次检查一下， ls /bin/sh -al 发现软链接指向/bin/bash</span><br></pre></td></tr></table></figure>\n<h2 id=\"恢复ubuntu-bash下的自动补全\"><a class=\"markdownIt-Anchor\" href=\"#恢复ubuntu-bash下的自动补全\"></a> 恢复ubuntu bash下的自动补全</h2>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">1. 确认/etc/bash_completion是否存在，如果没有就安装一个：</span><br><span class=\"line\">2. apt-get install bash-completion</span><br><span class=\"line\">在用户的shell中运行：</span><br><span class=\"line\">3. source /etc/bash_completion</span><br></pre></td></tr></table></figure>\n<h2 id=\"添加新的用户-ubuntn下面\"><a class=\"markdownIt-Anchor\" href=\"#添加新的用户-ubuntn下面\"></a> 添加新的用户 ubuntn下面</h2>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">useradd  -m username  //ubuntu 自动创建用户目录</span><br><span class=\"line\">passwd username  //创建密码</span><br><span class=\"line\">usermod -a -G sudo username //用户拥有权限</span><br><span class=\"line\"></span><br><span class=\"line\">ubuntu 默认的是dash shell</span><br><span class=\"line\"></span><br><span class=\"line\">修改成 bash</span><br><span class=\"line\">vi /etc/passwd </span><br><span class=\"line\">1.username:x:1000:1000::/home/username</span><br><span class=\"line\">修成成如下：</span><br><span class=\"line\">2. username:x:1000:1000::/home/username:/bin/bash</span><br></pre></td></tr></table></figure>\n"},{"title":"测试一下 qq和淘宝网页的测试","date":"2017-04-16T16:00:00.000Z","_content":"\n\n为什么做这个测试？最近有人你们的app接口能支持多大的并发，能支持多少的用户。\n答： 这个本身就是个伪命题，没有场景话，很难回答。就好像，你们怎么做优化，这本身也是个伪命题。\n如果要回答，网上google一下，有很多，问题在于你们的场景能用的到吗？如果要谈，这个很大的话题。\n每个话题展开都能谈很久。\n\n## 延迟分析\n\n同城机房网络(0.5ms~2ms) max(1000qps)\njvm-gc(50ms左右) max(20qps)\n如果是异地机房，例如北京到上海机房，一次网络往返可能就13～20毫秒延迟。max(50qps)\n\n![测试图](2017-04-17 at 14.04.47.gif)\n（测试图）\n\n\n","source":"_posts/2017-04-17.md","raw":"---\ntitle: 测试一下 qq和淘宝网页的测试\ndate: 2017-04-17\ntags: [性能测试]\n---\n\n\n为什么做这个测试？最近有人你们的app接口能支持多大的并发，能支持多少的用户。\n答： 这个本身就是个伪命题，没有场景话，很难回答。就好像，你们怎么做优化，这本身也是个伪命题。\n如果要回答，网上google一下，有很多，问题在于你们的场景能用的到吗？如果要谈，这个很大的话题。\n每个话题展开都能谈很久。\n\n## 延迟分析\n\n同城机房网络(0.5ms~2ms) max(1000qps)\njvm-gc(50ms左右) max(20qps)\n如果是异地机房，例如北京到上海机房，一次网络往返可能就13～20毫秒延迟。max(50qps)\n\n![测试图](2017-04-17 at 14.04.47.gif)\n（测试图）\n\n\n","slug":"2017-04-17","published":1,"updated":"2020-08-30T04:04:21.917Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot030006ip9khasg3xgo","content":"<p>为什么做这个测试？最近有人你们的app接口能支持多大的并发，能支持多少的用户。<br>\n答： 这个本身就是个伪命题，没有场景话，很难回答。就好像，你们怎么做优化，这本身也是个伪命题。<br>\n如果要回答，网上google一下，有很多，问题在于你们的场景能用的到吗？如果要谈，这个很大的话题。<br>\n每个话题展开都能谈很久。</p>\n<h2 id=\"延迟分析\"><a class=\"markdownIt-Anchor\" href=\"#延迟分析\"></a> 延迟分析</h2>\n<p>同城机房网络(0.5ms~2ms) max(1000qps)<br>\njvm-gc(50ms左右) max(20qps)<br>\n如果是异地机房，例如北京到上海机房，一次网络往返可能就13～20毫秒延迟。max(50qps)</p>\n<p>![测试图](2017-04-17 at 14.04.47.gif)<br>\n（测试图）</p>\n","site":{"data":{}},"excerpt":"","more":"<p>为什么做这个测试？最近有人你们的app接口能支持多大的并发，能支持多少的用户。<br>\n答： 这个本身就是个伪命题，没有场景话，很难回答。就好像，你们怎么做优化，这本身也是个伪命题。<br>\n如果要回答，网上google一下，有很多，问题在于你们的场景能用的到吗？如果要谈，这个很大的话题。<br>\n每个话题展开都能谈很久。</p>\n<h2 id=\"延迟分析\"><a class=\"markdownIt-Anchor\" href=\"#延迟分析\"></a> 延迟分析</h2>\n<p>同城机房网络(0.5ms~2ms) max(1000qps)<br>\njvm-gc(50ms左右) max(20qps)<br>\n如果是异地机房，例如北京到上海机房，一次网络往返可能就13～20毫秒延迟。max(50qps)</p>\n<p>![测试图](2017-04-17 at 14.04.47.gif)<br>\n（测试图）</p>\n"},{"title":"php nodejs nginx 进程模型对比","date":"2017-04-24T16:00:00.000Z","_content":"\n\n## PHP 进程模型\n\nPHP-FPM 是 PHP 针对 FastCGI 协议的具体实现，也是 PHP 在多种服务器端应用编程端口（SAPI：cgi、fast-cgi、cli、isapi、apache）里使用最普遍、性能最佳的一款进程管理器。\n\nPHP-FPM 这种模型是非常典型的多进程同步模型，意味着一个请求对应一个进程线程，并且 IO 是同步阻塞的。所以尽管 PHP-FPM 维护着独立的 CGI 进程池、系统也可以很轻松的管理进程的生命周期，\n\n受制于服务器的硬件设施，PHP-FPM 需要指定合理的 php-fpm.conf 配置：\n\n```php-fpm\npm.max_children # 子进程最大数\npm.start_servers # 启动时的子进程数\npm.min_spare_servers # 最小空闲进程数，空闲进程不够时自动补充\npm.max_spare_servers # 最大空闲进程数，空闲进程超过时自动清理\npm.max_requests = 1000 # 子进程请求数阈值，超过后自动回收\n```\n\nPHP 进程本身并不存在内存泄露的问题，每个进程完成请求处理后会回收内存，但是并不会释放给操作系统，这就导致大量内存被 PHP-FPM 占用而无法释放，请求量升高时性能骤降。\n\n所以 PHP-FPM 需要控制单个子进程请求次数的阈值。很多人会误以为 max_requests 控制了进程的并发连接数，实际上 PHP-FPM 模式下的进程是单一线程的，请求无法并发。这个参数的真正意义是提供请求计数器的功能，超过阈值数目后自动回收，缓解内存压力。\n\n## nginx进程模型\n\nNginx 是非阻塞IO & IO复用模型，通过操作系统提供的类似 epoll 的功能，可以在一个线程里处理多个客户端的请求。\nNginx 的进程就是线程，即每个进程里只有一个线程，但这一个线程可以服务多个客户端。\n\nnginx在启动后，会有一个master进程和多个worker进程。master进程主要用来管理worker进程，包含：接收来自外界的信号，向各worker进程发送信号，监控worker进程的运行状态，当worker进程退出后(异常情况下)，会自动重新启动新的worker进程。而基本的网络事件，则是放在worker进程中来处理了。多个worker进程之间是对等的，他们同等竞争来自客户端的请求，各进程互相之间是独立的。一个请求，只可能在一个worker进程中处理，一个worker进程，不可能处理其它进程的请求。worker进程的个数是可以设置的，一般我们会设置与机器cpu核数一致，这里面的原因与nginx的进程模型以及事件处理模型是分不开的\n\n因此才有了异步非阻塞的事件处理机制。具体到系统调用就是像select/poll/epoll/kqueue这样的系统调用。他们提供了一种机制，让你可以同时监控多个事件，调用他们是阻塞的，但可以设置超时时间，在超时时间之内，如果有事件准备好了，就返回。这种机制解决了我们上面两个问题。\n\n\n以epoll为例：当事件没有准备好时，就放入epoll里面。如果有事件准备好了，那么就去处理；如果事件返回的是EAGAIN，那么继续将其放入epoll里面。从而，只要有事件准备好了，我们就去处理她，只有当所有时间都没有准备好时，才在epoll里面等着。这样，我们就可以并发处理大量的并发了，当然，这里的并发请求，是指未处理完的请求，线程只有一个，所以同时能处理的请求当然只有一个了，只是在请求间进行不断地切换而已，切换也是因为异步事件未准备好，而主动让出的。这里的切换是没有任何代价，你可以理解为循环处理多个准备好的事件，事实上就是这样的。\n\n## nodejs 进程模型\n\n我们都知道nodejs最大的特点就是单进程、无阻塞运行，并且是异步事件驱动的。Nodejs的这些特性能够很好的解决一些问题，例如在服务器开发中，并发的请求处理是个大问题，阻塞式的函数会导致资源浪费和时间延迟。通过事件注册、异步函数，开发人员可以提高资源的利用率，性能也会改善。既然Node.js采用单进程、单线程模式，那么在如今多核硬件流行的环境中，单核性能出色的Nodejs如何利用多核CPU呢？创始人Ryan Dahl建议，运行多个Nodejs进程，利用某些通信机制来协调各项任务。目前，已经有不少第三方的Node.js多进程支持模块发布，而NodeJS 0.6.x 以上的版本提供了一个cluster模块 ,允许创建“共享同一个socket”的一组进程,用来分担负载压力。\n\n","source":"_posts/2017-04-25.md","raw":"---\ntitle: php nodejs nginx 进程模型对比\ndate: 2017-04-25\ntags: [php,nodejs,nginx]\n---\n\n\n## PHP 进程模型\n\nPHP-FPM 是 PHP 针对 FastCGI 协议的具体实现，也是 PHP 在多种服务器端应用编程端口（SAPI：cgi、fast-cgi、cli、isapi、apache）里使用最普遍、性能最佳的一款进程管理器。\n\nPHP-FPM 这种模型是非常典型的多进程同步模型，意味着一个请求对应一个进程线程，并且 IO 是同步阻塞的。所以尽管 PHP-FPM 维护着独立的 CGI 进程池、系统也可以很轻松的管理进程的生命周期，\n\n受制于服务器的硬件设施，PHP-FPM 需要指定合理的 php-fpm.conf 配置：\n\n```php-fpm\npm.max_children # 子进程最大数\npm.start_servers # 启动时的子进程数\npm.min_spare_servers # 最小空闲进程数，空闲进程不够时自动补充\npm.max_spare_servers # 最大空闲进程数，空闲进程超过时自动清理\npm.max_requests = 1000 # 子进程请求数阈值，超过后自动回收\n```\n\nPHP 进程本身并不存在内存泄露的问题，每个进程完成请求处理后会回收内存，但是并不会释放给操作系统，这就导致大量内存被 PHP-FPM 占用而无法释放，请求量升高时性能骤降。\n\n所以 PHP-FPM 需要控制单个子进程请求次数的阈值。很多人会误以为 max_requests 控制了进程的并发连接数，实际上 PHP-FPM 模式下的进程是单一线程的，请求无法并发。这个参数的真正意义是提供请求计数器的功能，超过阈值数目后自动回收，缓解内存压力。\n\n## nginx进程模型\n\nNginx 是非阻塞IO & IO复用模型，通过操作系统提供的类似 epoll 的功能，可以在一个线程里处理多个客户端的请求。\nNginx 的进程就是线程，即每个进程里只有一个线程，但这一个线程可以服务多个客户端。\n\nnginx在启动后，会有一个master进程和多个worker进程。master进程主要用来管理worker进程，包含：接收来自外界的信号，向各worker进程发送信号，监控worker进程的运行状态，当worker进程退出后(异常情况下)，会自动重新启动新的worker进程。而基本的网络事件，则是放在worker进程中来处理了。多个worker进程之间是对等的，他们同等竞争来自客户端的请求，各进程互相之间是独立的。一个请求，只可能在一个worker进程中处理，一个worker进程，不可能处理其它进程的请求。worker进程的个数是可以设置的，一般我们会设置与机器cpu核数一致，这里面的原因与nginx的进程模型以及事件处理模型是分不开的\n\n因此才有了异步非阻塞的事件处理机制。具体到系统调用就是像select/poll/epoll/kqueue这样的系统调用。他们提供了一种机制，让你可以同时监控多个事件，调用他们是阻塞的，但可以设置超时时间，在超时时间之内，如果有事件准备好了，就返回。这种机制解决了我们上面两个问题。\n\n\n以epoll为例：当事件没有准备好时，就放入epoll里面。如果有事件准备好了，那么就去处理；如果事件返回的是EAGAIN，那么继续将其放入epoll里面。从而，只要有事件准备好了，我们就去处理她，只有当所有时间都没有准备好时，才在epoll里面等着。这样，我们就可以并发处理大量的并发了，当然，这里的并发请求，是指未处理完的请求，线程只有一个，所以同时能处理的请求当然只有一个了，只是在请求间进行不断地切换而已，切换也是因为异步事件未准备好，而主动让出的。这里的切换是没有任何代价，你可以理解为循环处理多个准备好的事件，事实上就是这样的。\n\n## nodejs 进程模型\n\n我们都知道nodejs最大的特点就是单进程、无阻塞运行，并且是异步事件驱动的。Nodejs的这些特性能够很好的解决一些问题，例如在服务器开发中，并发的请求处理是个大问题，阻塞式的函数会导致资源浪费和时间延迟。通过事件注册、异步函数，开发人员可以提高资源的利用率，性能也会改善。既然Node.js采用单进程、单线程模式，那么在如今多核硬件流行的环境中，单核性能出色的Nodejs如何利用多核CPU呢？创始人Ryan Dahl建议，运行多个Nodejs进程，利用某些通信机制来协调各项任务。目前，已经有不少第三方的Node.js多进程支持模块发布，而NodeJS 0.6.x 以上的版本提供了一个cluster模块 ,允许创建“共享同一个socket”的一组进程,用来分担负载压力。\n\n","slug":"2017-04-25","published":1,"updated":"2020-08-30T04:04:21.913Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot050008ip9kin21e1v3","content":"<h2 id=\"php-进程模型\"><a class=\"markdownIt-Anchor\" href=\"#php-进程模型\"></a> PHP 进程模型</h2>\n<p>PHP-FPM 是 PHP 针对 FastCGI 协议的具体实现，也是 PHP 在多种服务器端应用编程端口（SAPI：cgi、fast-cgi、cli、isapi、apache）里使用最普遍、性能最佳的一款进程管理器。</p>\n<p>PHP-FPM 这种模型是非常典型的多进程同步模型，意味着一个请求对应一个进程线程，并且 IO 是同步阻塞的。所以尽管 PHP-FPM 维护着独立的 CGI 进程池、系统也可以很轻松的管理进程的生命周期，</p>\n<p>受制于服务器的硬件设施，PHP-FPM 需要指定合理的 php-fpm.conf 配置：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pm.max_children # 子进程最大数</span><br><span class=\"line\">pm.start_servers # 启动时的子进程数</span><br><span class=\"line\">pm.min_spare_servers # 最小空闲进程数，空闲进程不够时自动补充</span><br><span class=\"line\">pm.max_spare_servers # 最大空闲进程数，空闲进程超过时自动清理</span><br><span class=\"line\">pm.max_requests = 1000 # 子进程请求数阈值，超过后自动回收</span><br></pre></td></tr></table></figure>\n<p>PHP 进程本身并不存在内存泄露的问题，每个进程完成请求处理后会回收内存，但是并不会释放给操作系统，这就导致大量内存被 PHP-FPM 占用而无法释放，请求量升高时性能骤降。</p>\n<p>所以 PHP-FPM 需要控制单个子进程请求次数的阈值。很多人会误以为 max_requests 控制了进程的并发连接数，实际上 PHP-FPM 模式下的进程是单一线程的，请求无法并发。这个参数的真正意义是提供请求计数器的功能，超过阈值数目后自动回收，缓解内存压力。</p>\n<h2 id=\"nginx进程模型\"><a class=\"markdownIt-Anchor\" href=\"#nginx进程模型\"></a> nginx进程模型</h2>\n<p>Nginx 是非阻塞IO &amp; IO复用模型，通过操作系统提供的类似 epoll 的功能，可以在一个线程里处理多个客户端的请求。<br>\nNginx 的进程就是线程，即每个进程里只有一个线程，但这一个线程可以服务多个客户端。</p>\n<p>nginx在启动后，会有一个master进程和多个worker进程。master进程主要用来管理worker进程，包含：接收来自外界的信号，向各worker进程发送信号，监控worker进程的运行状态，当worker进程退出后(异常情况下)，会自动重新启动新的worker进程。而基本的网络事件，则是放在worker进程中来处理了。多个worker进程之间是对等的，他们同等竞争来自客户端的请求，各进程互相之间是独立的。一个请求，只可能在一个worker进程中处理，一个worker进程，不可能处理其它进程的请求。worker进程的个数是可以设置的，一般我们会设置与机器cpu核数一致，这里面的原因与nginx的进程模型以及事件处理模型是分不开的</p>\n<p>因此才有了异步非阻塞的事件处理机制。具体到系统调用就是像select/poll/epoll/kqueue这样的系统调用。他们提供了一种机制，让你可以同时监控多个事件，调用他们是阻塞的，但可以设置超时时间，在超时时间之内，如果有事件准备好了，就返回。这种机制解决了我们上面两个问题。</p>\n<p>以epoll为例：当事件没有准备好时，就放入epoll里面。如果有事件准备好了，那么就去处理；如果事件返回的是EAGAIN，那么继续将其放入epoll里面。从而，只要有事件准备好了，我们就去处理她，只有当所有时间都没有准备好时，才在epoll里面等着。这样，我们就可以并发处理大量的并发了，当然，这里的并发请求，是指未处理完的请求，线程只有一个，所以同时能处理的请求当然只有一个了，只是在请求间进行不断地切换而已，切换也是因为异步事件未准备好，而主动让出的。这里的切换是没有任何代价，你可以理解为循环处理多个准备好的事件，事实上就是这样的。</p>\n<h2 id=\"nodejs-进程模型\"><a class=\"markdownIt-Anchor\" href=\"#nodejs-进程模型\"></a> nodejs 进程模型</h2>\n<p>我们都知道nodejs最大的特点就是单进程、无阻塞运行，并且是异步事件驱动的。Nodejs的这些特性能够很好的解决一些问题，例如在服务器开发中，并发的请求处理是个大问题，阻塞式的函数会导致资源浪费和时间延迟。通过事件注册、异步函数，开发人员可以提高资源的利用率，性能也会改善。既然Node.js采用单进程、单线程模式，那么在如今多核硬件流行的环境中，单核性能出色的Nodejs如何利用多核CPU呢？创始人Ryan Dahl建议，运行多个Nodejs进程，利用某些通信机制来协调各项任务。目前，已经有不少第三方的Node.js多进程支持模块发布，而NodeJS 0.6.x 以上的版本提供了一个cluster模块 ,允许创建“共享同一个socket”的一组进程,用来分担负载压力。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"php-进程模型\"><a class=\"markdownIt-Anchor\" href=\"#php-进程模型\"></a> PHP 进程模型</h2>\n<p>PHP-FPM 是 PHP 针对 FastCGI 协议的具体实现，也是 PHP 在多种服务器端应用编程端口（SAPI：cgi、fast-cgi、cli、isapi、apache）里使用最普遍、性能最佳的一款进程管理器。</p>\n<p>PHP-FPM 这种模型是非常典型的多进程同步模型，意味着一个请求对应一个进程线程，并且 IO 是同步阻塞的。所以尽管 PHP-FPM 维护着独立的 CGI 进程池、系统也可以很轻松的管理进程的生命周期，</p>\n<p>受制于服务器的硬件设施，PHP-FPM 需要指定合理的 php-fpm.conf 配置：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pm.max_children # 子进程最大数</span><br><span class=\"line\">pm.start_servers # 启动时的子进程数</span><br><span class=\"line\">pm.min_spare_servers # 最小空闲进程数，空闲进程不够时自动补充</span><br><span class=\"line\">pm.max_spare_servers # 最大空闲进程数，空闲进程超过时自动清理</span><br><span class=\"line\">pm.max_requests = 1000 # 子进程请求数阈值，超过后自动回收</span><br></pre></td></tr></table></figure>\n<p>PHP 进程本身并不存在内存泄露的问题，每个进程完成请求处理后会回收内存，但是并不会释放给操作系统，这就导致大量内存被 PHP-FPM 占用而无法释放，请求量升高时性能骤降。</p>\n<p>所以 PHP-FPM 需要控制单个子进程请求次数的阈值。很多人会误以为 max_requests 控制了进程的并发连接数，实际上 PHP-FPM 模式下的进程是单一线程的，请求无法并发。这个参数的真正意义是提供请求计数器的功能，超过阈值数目后自动回收，缓解内存压力。</p>\n<h2 id=\"nginx进程模型\"><a class=\"markdownIt-Anchor\" href=\"#nginx进程模型\"></a> nginx进程模型</h2>\n<p>Nginx 是非阻塞IO &amp; IO复用模型，通过操作系统提供的类似 epoll 的功能，可以在一个线程里处理多个客户端的请求。<br>\nNginx 的进程就是线程，即每个进程里只有一个线程，但这一个线程可以服务多个客户端。</p>\n<p>nginx在启动后，会有一个master进程和多个worker进程。master进程主要用来管理worker进程，包含：接收来自外界的信号，向各worker进程发送信号，监控worker进程的运行状态，当worker进程退出后(异常情况下)，会自动重新启动新的worker进程。而基本的网络事件，则是放在worker进程中来处理了。多个worker进程之间是对等的，他们同等竞争来自客户端的请求，各进程互相之间是独立的。一个请求，只可能在一个worker进程中处理，一个worker进程，不可能处理其它进程的请求。worker进程的个数是可以设置的，一般我们会设置与机器cpu核数一致，这里面的原因与nginx的进程模型以及事件处理模型是分不开的</p>\n<p>因此才有了异步非阻塞的事件处理机制。具体到系统调用就是像select/poll/epoll/kqueue这样的系统调用。他们提供了一种机制，让你可以同时监控多个事件，调用他们是阻塞的，但可以设置超时时间，在超时时间之内，如果有事件准备好了，就返回。这种机制解决了我们上面两个问题。</p>\n<p>以epoll为例：当事件没有准备好时，就放入epoll里面。如果有事件准备好了，那么就去处理；如果事件返回的是EAGAIN，那么继续将其放入epoll里面。从而，只要有事件准备好了，我们就去处理她，只有当所有时间都没有准备好时，才在epoll里面等着。这样，我们就可以并发处理大量的并发了，当然，这里的并发请求，是指未处理完的请求，线程只有一个，所以同时能处理的请求当然只有一个了，只是在请求间进行不断地切换而已，切换也是因为异步事件未准备好，而主动让出的。这里的切换是没有任何代价，你可以理解为循环处理多个准备好的事件，事实上就是这样的。</p>\n<h2 id=\"nodejs-进程模型\"><a class=\"markdownIt-Anchor\" href=\"#nodejs-进程模型\"></a> nodejs 进程模型</h2>\n<p>我们都知道nodejs最大的特点就是单进程、无阻塞运行，并且是异步事件驱动的。Nodejs的这些特性能够很好的解决一些问题，例如在服务器开发中，并发的请求处理是个大问题，阻塞式的函数会导致资源浪费和时间延迟。通过事件注册、异步函数，开发人员可以提高资源的利用率，性能也会改善。既然Node.js采用单进程、单线程模式，那么在如今多核硬件流行的环境中，单核性能出色的Nodejs如何利用多核CPU呢？创始人Ryan Dahl建议，运行多个Nodejs进程，利用某些通信机制来协调各项任务。目前，已经有不少第三方的Node.js多进程支持模块发布，而NodeJS 0.6.x 以上的版本提供了一个cluster模块 ,允许创建“共享同一个socket”的一组进程,用来分担负载压力。</p>\n"},{"title":"IntelliJ Idea 2017 免费激活方法","date":"2017-04-26T16:00:00.000Z","_content":"\n\n1. 第一种方法：\n到网站 http://idea.lanyus.com/ 获取注册码。\n\n2. 第二种方法：\n首先：`0.0.0.0 account.jetbrains.com` 添加到`hosts`\n填入下面的license server:\n\n　　http://intellij.mandroid.cn/\n　　http://idea.imsxm.com/\n　　http://idea.iteblog.com/key.php\n\n以上方法验证均可以\n\n","source":"_posts/2017-04-27.md","raw":"\n---\ntitle: IntelliJ Idea 2017 免费激活方法\ndate: 2017-04-27\ntags: [phpstrom,jetbrains]\n---\n\n\n1. 第一种方法：\n到网站 http://idea.lanyus.com/ 获取注册码。\n\n2. 第二种方法：\n首先：`0.0.0.0 account.jetbrains.com` 添加到`hosts`\n填入下面的license server:\n\n　　http://intellij.mandroid.cn/\n　　http://idea.imsxm.com/\n　　http://idea.iteblog.com/key.php\n\n以上方法验证均可以\n\n","slug":"2017-04-27","published":1,"updated":"2020-08-30T04:04:21.931Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot07000aip9km41ejcvb","content":"<ol>\n<li>\n<p>第一种方法：<br>\n到网站 <a href=\"http://idea.lanyus.com/\" target=\"_blank\" rel=\"noopener\">http://idea.lanyus.com/</a> 获取注册码。</p>\n</li>\n<li>\n<p>第二种方法：<br>\n首先：<code>0.0.0.0 account.jetbrains.com</code> 添加到<code>hosts</code><br>\n填入下面的license server:</p>\n</li>\n</ol>\n<p><a href=\"http://intellij.mandroid.cn/\" target=\"_blank\" rel=\"noopener\">http://intellij.mandroid.cn/</a><br>\n　　<a href=\"http://idea.imsxm.com/\" target=\"_blank\" rel=\"noopener\">http://idea.imsxm.com/</a><br>\n　　<a href=\"http://idea.iteblog.com/key.php\" target=\"_blank\" rel=\"noopener\">http://idea.iteblog.com/key.php</a></p>\n<p>以上方法验证均可以</p>\n","site":{"data":{}},"excerpt":"","more":"<ol>\n<li>\n<p>第一种方法：<br>\n到网站 <a href=\"http://idea.lanyus.com/\" target=\"_blank\" rel=\"noopener\">http://idea.lanyus.com/</a> 获取注册码。</p>\n</li>\n<li>\n<p>第二种方法：<br>\n首先：<code>0.0.0.0 account.jetbrains.com</code> 添加到<code>hosts</code><br>\n填入下面的license server:</p>\n</li>\n</ol>\n<p><a href=\"http://intellij.mandroid.cn/\" target=\"_blank\" rel=\"noopener\">http://intellij.mandroid.cn/</a><br>\n　　<a href=\"http://idea.imsxm.com/\" target=\"_blank\" rel=\"noopener\">http://idea.imsxm.com/</a><br>\n　　<a href=\"http://idea.iteblog.com/key.php\" target=\"_blank\" rel=\"noopener\">http://idea.iteblog.com/key.php</a></p>\n<p>以上方法验证均可以</p>\n"},{"title":"Nginx 限流","date":"2017-04-27T16:00:00.000Z","_content":"\n\n电商平台营销时候，经常会碰到的大流量问题,\n除了做流量分流处理，可能还要做用户黑白名单、信誉分析，进而根据用户ip信誉权重做相应的流量拦截、限制流量。Nginx自身有的请求限制模块ngx_http_limit_req_module、流量限制模块ngx_stream_limit_conn_module基于令牌桶算法，可以方便的控制令牌速率，自定义调节限流，实现基本的限流控制。\n\n对于提供下载的网站，肯定是要进行流量控制的，例如软件下载站、视频服务等。它也可以减少一些爬虫程序或者DDOS的攻击。\n\n对这两个模块的介绍的文章也不少，这里转载一篇hopestar的文章: nginx限制IP连接数的范例参考， 因为他介绍的很简洁。\n\n> 如何Nginx限制同一个ip的连接数，限制并发数目:\n\n##  1. 限流\n \n*  添加limit_zone和limit_req_zone;  \n这个变量只能在http使用 :\n\n```powershell\nvi /export/servers/nginx/conf/nginx.conf \nlimit_zone one  $binary_remote_addr  20m;\nlimit_req_zone  $binary_remote_addr  zone=req_one:20m rate=12r/s; \n    \n```\n\n* 添加limit_conn 和limit_req\n   \n这个变量可以在`http`, `server`, `location`使用 我是限制nginx上的所有服务，所以添加到http里面 （如果你需要限制部分服务，可在nginx/conf/domains里面选择相应的server或者location添加上便可）\n\n```powershell   \nvi /export/servers/nginx/conf/nginx.conf \nlimit_zone one $binary_remote_addr 20m;\nlimit_req_zone $binary_remote_addr zone=req_one:20m rate=12r/s;\nlimit_conn one 10;\nlimit_req zone=req_one burst=120;\n```\n\n参数详解(数值按具体需要和服务器承载能力设置,):\n\n```powershell\nlimit_zone，是针对每个变量(这里指IP，即$binary_remote_addr)定义一个存储session状态的容器。  \n            这个示例中定义了一个20m的容器，按照32bytes/session，  \n            可以处理640000个session。 \nlimit_req_zone 与limit_zone类似。rate是请求频率. 每秒允许12个请求。\nlimit_conn  one 10 : 表示一个IP能发起10个并发连接数\nlimit_req: 与limit_req_zone对应。burst表示缓存住的请求数。\n```\n示例：\n    \n```nginx\nhttp\n{\n    limit_zone one  $binary_remote_addr  20m;\n    limit_req_zone  $binary_remote_addr  zone=req_one:20m rate=12r/s;\n    limit_conn   one  10;\n    limit_req   zone=req_one burst=120;\n    server  {\n        listen          80;\n        server_name     status.xxx.com ;\n        location / {\n                 stub_status            on;\n                 access_log             off;\n        }\n    }\n}\n```\n\n重启nginx\n    \n```vim\n/export/servers/nginx/sbin/nginx -s reload\n```\n\n## 2. nginx白名单设置\n\n以上配置会对所有的ip都进行限制，有些时候我们不希望对搜索引擎的蜘蛛或者某些自己的代理机过来的请求进行限制， 对于特定的白名单ip我们可以借助geo指令实现。\n\n先在nginx的请求日志进行统计，查看那个ip的访问量比较大， 运行:\n    \n```vim\ncat access.log | grep \"03/Jun\" |awk '{print $1}'|sort |uniq -c|sort -nrk 1|head -n 10\n#列出访问日志里面在6月3号这天前10个访问量最大的ip.\n```\n    \n接下来就可以对这些IP进行分析了。看哪些需要进行白名单设置。\n    \n```nginx\nhttp\n{\n    geo  $limited  { # the variable created is $limited\n        default          1;\n        127.0.0.1/32     0;\n        10.12.212.63     0;\n    }\n    map $limited $limit {\n        1 $binary_remote_addr;\n        0 \"\";\n    }\n    limit_zone one  $binary_remote_addr  20m;\n    limit_req_zone  $limit  zone=req_one:20m rate=20r/s;\n    limit_conn   one  10;\n    limit_req   zone=req_one burst=120;\n}    \n```\n    \n上面两个需要用到map和geo模块，这是nginx自带的模块，有的运维喜欢把他们关闭，自己`./sbin/nginx -V` 留意一下。把配置的`--whithout-XXX-module `去掉重新编译一下就可以了。 上面这段配置的意思是：\n\ngeo指令定义了一个白名单$limited变量，默认值为1，如果客户端ip在上面的范围内，$limited的值为0\n使用map指令映射搜索引擎客户端的ip为空串，如果不是搜索引擎就显示本身真实的ip，这样搜索引擎ip就不能存到limit_req_zone内存session中，所以不会限制搜索引擎的ip访问\n    \n## 3. 获取客户端的真实IP\n\n顺带一提，为了获取客户端的真实IP。该模块需要安装read_ip模块，运维应该默认有安装。没有的话也可自行安装： 配置方式相当简单，重新编译 Nginx 加上 --with-http_realip_module 参数，如：\n    \n```powershell\n./configure --prefix=/opt/nginx --with-http_stub_status_module  --with-pcre=../pcre-6.6 --with-http_realip_module\nmake\nmake install\n```\n\n在server中增加:\n\n```nginx\nset_real_ip_from   192.168.1.0/24;\nset_real_ip_from   192.168.2.1;\nreal_ip_header     [X-Real-IP|X-Forwarded-For];\n```\n\n需要说明的地方就是设置IP源的时候可以设置单个IP，也可以设置IP段，另外是使用X-Real-IP还是X-Forwarded-For，取决于前面的服务器有哪个头。\n    \nset_real_ip_from 设置的IP端可以让运维查看日志，看下你的请求是来自哪些ip段。\n    \n重新加载一下服务，差不多就OK了。\n    \n再查看日志的话，应该可以看到客户端的真实IP了。\n    \n注意：如果未安装该模块的话你的获取到的IP端可能是来自前端代理（如squid）的IP，结果就是多个用户被当成单个用户对待，导致应用不能响应。 \n    \n再PS一下： 自测: 有条件的自己可以用ab或者webben自测一下。\n    \n未安装前压测的话，因为有大量请求，所以access.log会有大量日志，而error.log日志没有变化。\n    \n```powershell\n➜  ~ webbench  -c 30 -t 30 http://xxx.com\nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\nBenchmarking: GET http://xxx.com  \n30 clients, running 30 sec.\nSpeed=193468 pages/min, 1254317 bytes/sec.\nRequests: 96734 susceed, 0 failed.\n```\n\n安装后会发现很多超出的请求会返回503,所以access.log日志变化不快，error.log有大量记录,提示limit_reque缓住了多少请求。\n\n```powershell\n➜  ~ webbench  -c 30 -t 30 http://xxxx.com\nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\nBenchmarking: GET http://xxx.com  \n30 clients, running 30 sec.\nSpeed=120 pages/min, 778 bytes/sec.\nRequests: 60 susceed, 0 failed.\n```\n   \n\n\n\n\n\n\n\n\n","source":"_posts/2017-04-28-1.md","raw":"---\ntitle: Nginx 限流\ndate: 2017-04-28\ntags: [nginx]\n---\n\n\n电商平台营销时候，经常会碰到的大流量问题,\n除了做流量分流处理，可能还要做用户黑白名单、信誉分析，进而根据用户ip信誉权重做相应的流量拦截、限制流量。Nginx自身有的请求限制模块ngx_http_limit_req_module、流量限制模块ngx_stream_limit_conn_module基于令牌桶算法，可以方便的控制令牌速率，自定义调节限流，实现基本的限流控制。\n\n对于提供下载的网站，肯定是要进行流量控制的，例如软件下载站、视频服务等。它也可以减少一些爬虫程序或者DDOS的攻击。\n\n对这两个模块的介绍的文章也不少，这里转载一篇hopestar的文章: nginx限制IP连接数的范例参考， 因为他介绍的很简洁。\n\n> 如何Nginx限制同一个ip的连接数，限制并发数目:\n\n##  1. 限流\n \n*  添加limit_zone和limit_req_zone;  \n这个变量只能在http使用 :\n\n```powershell\nvi /export/servers/nginx/conf/nginx.conf \nlimit_zone one  $binary_remote_addr  20m;\nlimit_req_zone  $binary_remote_addr  zone=req_one:20m rate=12r/s; \n    \n```\n\n* 添加limit_conn 和limit_req\n   \n这个变量可以在`http`, `server`, `location`使用 我是限制nginx上的所有服务，所以添加到http里面 （如果你需要限制部分服务，可在nginx/conf/domains里面选择相应的server或者location添加上便可）\n\n```powershell   \nvi /export/servers/nginx/conf/nginx.conf \nlimit_zone one $binary_remote_addr 20m;\nlimit_req_zone $binary_remote_addr zone=req_one:20m rate=12r/s;\nlimit_conn one 10;\nlimit_req zone=req_one burst=120;\n```\n\n参数详解(数值按具体需要和服务器承载能力设置,):\n\n```powershell\nlimit_zone，是针对每个变量(这里指IP，即$binary_remote_addr)定义一个存储session状态的容器。  \n            这个示例中定义了一个20m的容器，按照32bytes/session，  \n            可以处理640000个session。 \nlimit_req_zone 与limit_zone类似。rate是请求频率. 每秒允许12个请求。\nlimit_conn  one 10 : 表示一个IP能发起10个并发连接数\nlimit_req: 与limit_req_zone对应。burst表示缓存住的请求数。\n```\n示例：\n    \n```nginx\nhttp\n{\n    limit_zone one  $binary_remote_addr  20m;\n    limit_req_zone  $binary_remote_addr  zone=req_one:20m rate=12r/s;\n    limit_conn   one  10;\n    limit_req   zone=req_one burst=120;\n    server  {\n        listen          80;\n        server_name     status.xxx.com ;\n        location / {\n                 stub_status            on;\n                 access_log             off;\n        }\n    }\n}\n```\n\n重启nginx\n    \n```vim\n/export/servers/nginx/sbin/nginx -s reload\n```\n\n## 2. nginx白名单设置\n\n以上配置会对所有的ip都进行限制，有些时候我们不希望对搜索引擎的蜘蛛或者某些自己的代理机过来的请求进行限制， 对于特定的白名单ip我们可以借助geo指令实现。\n\n先在nginx的请求日志进行统计，查看那个ip的访问量比较大， 运行:\n    \n```vim\ncat access.log | grep \"03/Jun\" |awk '{print $1}'|sort |uniq -c|sort -nrk 1|head -n 10\n#列出访问日志里面在6月3号这天前10个访问量最大的ip.\n```\n    \n接下来就可以对这些IP进行分析了。看哪些需要进行白名单设置。\n    \n```nginx\nhttp\n{\n    geo  $limited  { # the variable created is $limited\n        default          1;\n        127.0.0.1/32     0;\n        10.12.212.63     0;\n    }\n    map $limited $limit {\n        1 $binary_remote_addr;\n        0 \"\";\n    }\n    limit_zone one  $binary_remote_addr  20m;\n    limit_req_zone  $limit  zone=req_one:20m rate=20r/s;\n    limit_conn   one  10;\n    limit_req   zone=req_one burst=120;\n}    \n```\n    \n上面两个需要用到map和geo模块，这是nginx自带的模块，有的运维喜欢把他们关闭，自己`./sbin/nginx -V` 留意一下。把配置的`--whithout-XXX-module `去掉重新编译一下就可以了。 上面这段配置的意思是：\n\ngeo指令定义了一个白名单$limited变量，默认值为1，如果客户端ip在上面的范围内，$limited的值为0\n使用map指令映射搜索引擎客户端的ip为空串，如果不是搜索引擎就显示本身真实的ip，这样搜索引擎ip就不能存到limit_req_zone内存session中，所以不会限制搜索引擎的ip访问\n    \n## 3. 获取客户端的真实IP\n\n顺带一提，为了获取客户端的真实IP。该模块需要安装read_ip模块，运维应该默认有安装。没有的话也可自行安装： 配置方式相当简单，重新编译 Nginx 加上 --with-http_realip_module 参数，如：\n    \n```powershell\n./configure --prefix=/opt/nginx --with-http_stub_status_module  --with-pcre=../pcre-6.6 --with-http_realip_module\nmake\nmake install\n```\n\n在server中增加:\n\n```nginx\nset_real_ip_from   192.168.1.0/24;\nset_real_ip_from   192.168.2.1;\nreal_ip_header     [X-Real-IP|X-Forwarded-For];\n```\n\n需要说明的地方就是设置IP源的时候可以设置单个IP，也可以设置IP段，另外是使用X-Real-IP还是X-Forwarded-For，取决于前面的服务器有哪个头。\n    \nset_real_ip_from 设置的IP端可以让运维查看日志，看下你的请求是来自哪些ip段。\n    \n重新加载一下服务，差不多就OK了。\n    \n再查看日志的话，应该可以看到客户端的真实IP了。\n    \n注意：如果未安装该模块的话你的获取到的IP端可能是来自前端代理（如squid）的IP，结果就是多个用户被当成单个用户对待，导致应用不能响应。 \n    \n再PS一下： 自测: 有条件的自己可以用ab或者webben自测一下。\n    \n未安装前压测的话，因为有大量请求，所以access.log会有大量日志，而error.log日志没有变化。\n    \n```powershell\n➜  ~ webbench  -c 30 -t 30 http://xxx.com\nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\nBenchmarking: GET http://xxx.com  \n30 clients, running 30 sec.\nSpeed=193468 pages/min, 1254317 bytes/sec.\nRequests: 96734 susceed, 0 failed.\n```\n\n安装后会发现很多超出的请求会返回503,所以access.log日志变化不快，error.log有大量记录,提示limit_reque缓住了多少请求。\n\n```powershell\n➜  ~ webbench  -c 30 -t 30 http://xxxx.com\nWebbench - Simple Web Benchmark 1.5\nCopyright (c) Radim Kolar 1997-2004, GPL Open Source Software.\nBenchmarking: GET http://xxx.com  \n30 clients, running 30 sec.\nSpeed=120 pages/min, 778 bytes/sec.\nRequests: 60 susceed, 0 failed.\n```\n   \n\n\n\n\n\n\n\n\n","slug":"2017-04-28-1","published":1,"updated":"2020-08-30T04:04:21.909Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot09000cip9kr54b3vao","content":"<p>电商平台营销时候，经常会碰到的大流量问题,<br>\n除了做流量分流处理，可能还要做用户黑白名单、信誉分析，进而根据用户ip信誉权重做相应的流量拦截、限制流量。Nginx自身有的请求限制模块ngx_http_limit_req_module、流量限制模块ngx_stream_limit_conn_module基于令牌桶算法，可以方便的控制令牌速率，自定义调节限流，实现基本的限流控制。</p>\n<p>对于提供下载的网站，肯定是要进行流量控制的，例如软件下载站、视频服务等。它也可以减少一些爬虫程序或者DDOS的攻击。</p>\n<p>对这两个模块的介绍的文章也不少，这里转载一篇hopestar的文章: nginx限制IP连接数的范例参考， 因为他介绍的很简洁。</p>\n<blockquote>\n<p>如何Nginx限制同一个ip的连接数，限制并发数目:</p>\n</blockquote>\n<h2 id=\"1-限流\"><a class=\"markdownIt-Anchor\" href=\"#1-限流\"></a> 1. 限流</h2>\n<ul>\n<li>添加limit_zone和limit_req_zone;<br>\n这个变量只能在http使用 :</li>\n</ul>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /export/servers/nginx/conf/nginx.conf </span><br><span class=\"line\">limit_zone one  <span class=\"variable\">$binary_remote_addr</span>  <span class=\"number\">20</span>m;</span><br><span class=\"line\">limit_req_zone  <span class=\"variable\">$binary_remote_addr</span>  zone=req_one:<span class=\"number\">20</span>m rate=<span class=\"number\">12</span>r/s;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>添加limit_conn 和limit_req</li>\n</ul>\n<p>这个变量可以在<code>http</code>, <code>server</code>, <code>location</code>使用 我是限制nginx上的所有服务，所以添加到http里面 （如果你需要限制部分服务，可在nginx/conf/domains里面选择相应的server或者location添加上便可）</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /export/servers/nginx/conf/nginx.conf </span><br><span class=\"line\">limit_zone one <span class=\"variable\">$binary_remote_addr</span> <span class=\"number\">20</span>m;</span><br><span class=\"line\">limit_req_zone <span class=\"variable\">$binary_remote_addr</span> zone=req_one:<span class=\"number\">20</span>m rate=<span class=\"number\">12</span>r/s;</span><br><span class=\"line\">limit_conn one <span class=\"number\">10</span>;</span><br><span class=\"line\">limit_req zone=req_one burst=<span class=\"number\">120</span>;</span><br></pre></td></tr></table></figure>\n<p>参数详解(数值按具体需要和服务器承载能力设置,):</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">limit_zone，是针对每个变量(这里指IP，即<span class=\"variable\">$binary_remote_addr</span>)定义一个存储session状态的容器。  </span><br><span class=\"line\">            这个示例中定义了一个<span class=\"number\">20</span>m的容器，按照<span class=\"number\">32</span>bytes/session，  </span><br><span class=\"line\">            可以处理<span class=\"number\">640000</span>个session。 </span><br><span class=\"line\">limit_req_zone 与limit_zone类似。rate是请求频率. 每秒允许<span class=\"number\">12</span>个请求。</span><br><span class=\"line\">limit_conn  one <span class=\"number\">10</span> : 表示一个IP能发起<span class=\"number\">10</span>个并发连接数</span><br><span class=\"line\">limit_req: 与limit_req_zone对应。burst表示缓存住的请求数。</span><br></pre></td></tr></table></figure>\n<p>示例：</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attribute\">limit_zone</span> one  <span class=\"variable\">$binary_remote_addr</span>  <span class=\"number\">20m</span>;</span><br><span class=\"line\">    <span class=\"attribute\">limit_req_zone</span>  <span class=\"variable\">$binary_remote_addr</span>  zone=req_one:<span class=\"number\">20m</span> rate=12r/s;</span><br><span class=\"line\">    <span class=\"attribute\">limit_conn</span>   one  <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"attribute\">limit_req</span>   zone=req_one burst=<span class=\"number\">120</span>;</span><br><span class=\"line\">    <span class=\"section\">server</span>  &#123;</span><br><span class=\"line\">        <span class=\"attribute\">listen</span>          <span class=\"number\">80</span>;</span><br><span class=\"line\">        <span class=\"attribute\">server_name</span>     status.xxx.com ;</span><br><span class=\"line\">        <span class=\"attribute\">location</span> / &#123;</span><br><span class=\"line\">                 <span class=\"attribute\">stub_status</span>            <span class=\"literal\">on</span>;</span><br><span class=\"line\">                 <span class=\"attribute\">access_log</span>             <span class=\"literal\">off</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>重启nginx</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/export/servers/nginx/sbin/nginx -s reload</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-nginx白名单设置\"><a class=\"markdownIt-Anchor\" href=\"#2-nginx白名单设置\"></a> 2. nginx白名单设置</h2>\n<p>以上配置会对所有的ip都进行限制，有些时候我们不希望对搜索引擎的蜘蛛或者某些自己的代理机过来的请求进行限制， 对于特定的白名单ip我们可以借助geo指令实现。</p>\n<p>先在nginx的请求日志进行统计，查看那个ip的访问量比较大， 运行:</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">cat</span> access.<span class=\"built_in\">log</span> | <span class=\"keyword\">grep</span> <span class=\"string\">\"03/Jun\"</span> |awk <span class=\"string\">'&#123;print $1&#125;'</span>|<span class=\"keyword\">sort</span> |uniq -<span class=\"keyword\">c</span>|<span class=\"keyword\">sort</span> -nrk <span class=\"number\">1</span>|head -n <span class=\"number\">10</span></span><br><span class=\"line\">#列出访问日志里面在<span class=\"number\">6</span>月<span class=\"number\">3</span>号这天前<span class=\"number\">10</span>个访问量最大的ip.</span><br></pre></td></tr></table></figure>\n<p>接下来就可以对这些IP进行分析了。看哪些需要进行白名单设置。</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attribute\">geo</span>  <span class=\"variable\">$limited</span>  &#123; <span class=\"comment\"># the variable created is $limited</span></span><br><span class=\"line\">        <span class=\"attribute\">default</span>          <span class=\"number\">1</span>;</span><br><span class=\"line\">        127.0.0.1/32     0;</span><br><span class=\"line\">        10.12.212.63     0;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"attribute\">map</span> <span class=\"variable\">$limited</span> <span class=\"variable\">$limit</span> &#123;</span><br><span class=\"line\">        1 $binary_remote_addr;</span><br><span class=\"line\">        0 \"\";</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"attribute\">limit_zone</span> one  <span class=\"variable\">$binary_remote_addr</span>  <span class=\"number\">20m</span>;</span><br><span class=\"line\">    <span class=\"attribute\">limit_req_zone</span>  <span class=\"variable\">$limit</span>  zone=req_one:<span class=\"number\">20m</span> rate=20r/s;</span><br><span class=\"line\">    <span class=\"attribute\">limit_conn</span>   one  <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"attribute\">limit_req</span>   zone=req_one burst=<span class=\"number\">120</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>上面两个需要用到map和geo模块，这是nginx自带的模块，有的运维喜欢把他们关闭，自己<code>./sbin/nginx -V</code> 留意一下。把配置的<code>--whithout-XXX-module</code>去掉重新编译一下就可以了。 上面这段配置的意思是：</p>\n<p>geo指令定义了一个白名单<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>l</mi><mi>i</mi><mi>m</mi><mi>i</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi mathvariant=\"normal\">变</mi><mi mathvariant=\"normal\">量</mi><mi mathvariant=\"normal\">，</mi><mi mathvariant=\"normal\">默</mi><mi mathvariant=\"normal\">认</mi><mi mathvariant=\"normal\">值</mi><mi mathvariant=\"normal\">为</mi><mn>1</mn><mi mathvariant=\"normal\">，</mi><mi mathvariant=\"normal\">如</mi><mi mathvariant=\"normal\">果</mi><mi mathvariant=\"normal\">客</mi><mi mathvariant=\"normal\">户</mi><mi mathvariant=\"normal\">端</mi><mi>i</mi><mi>p</mi><mi mathvariant=\"normal\">在</mi><mi mathvariant=\"normal\">上</mi><mi mathvariant=\"normal\">面</mi><mi mathvariant=\"normal\">的</mi><mi mathvariant=\"normal\">范</mi><mi mathvariant=\"normal\">围</mi><mi mathvariant=\"normal\">内</mi><mi mathvariant=\"normal\">，</mi></mrow><annotation encoding=\"application/x-tex\">limited变量，默认值为1，如果客户端ip在上面的范围内，</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">m</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\">d</span><span class=\"mord cjk_fallback\">变</span><span class=\"mord cjk_fallback\">量</span><span class=\"mord cjk_fallback\">，</span><span class=\"mord cjk_fallback\">默</span><span class=\"mord cjk_fallback\">认</span><span class=\"mord cjk_fallback\">值</span><span class=\"mord cjk_fallback\">为</span><span class=\"mord\">1</span><span class=\"mord cjk_fallback\">，</span><span class=\"mord cjk_fallback\">如</span><span class=\"mord cjk_fallback\">果</span><span class=\"mord cjk_fallback\">客</span><span class=\"mord cjk_fallback\">户</span><span class=\"mord cjk_fallback\">端</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">p</span><span class=\"mord cjk_fallback\">在</span><span class=\"mord cjk_fallback\">上</span><span class=\"mord cjk_fallback\">面</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">范</span><span class=\"mord cjk_fallback\">围</span><span class=\"mord cjk_fallback\">内</span><span class=\"mord cjk_fallback\">，</span></span></span></span>limited的值为0<br>\n使用map指令映射搜索引擎客户端的ip为空串，如果不是搜索引擎就显示本身真实的ip，这样搜索引擎ip就不能存到limit_req_zone内存session中，所以不会限制搜索引擎的ip访问</p>\n<h2 id=\"3-获取客户端的真实ip\"><a class=\"markdownIt-Anchor\" href=\"#3-获取客户端的真实ip\"></a> 3. 获取客户端的真实IP</h2>\n<p>顺带一提，为了获取客户端的真实IP。该模块需要安装read_ip模块，运维应该默认有安装。没有的话也可自行安装： 配置方式相当简单，重新编译 Nginx 加上 --with-http_realip_module 参数，如：</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./configure -<span class=\"literal\">-prefix</span>=/opt/nginx -<span class=\"literal\">-with</span><span class=\"literal\">-http_stub_status_module</span>  -<span class=\"literal\">-with</span><span class=\"literal\">-pcre</span>=../pcre<span class=\"literal\">-6</span>.<span class=\"number\">6</span> -<span class=\"literal\">-with</span><span class=\"literal\">-http_realip_module</span></span><br><span class=\"line\">make</span><br><span class=\"line\">make install</span><br></pre></td></tr></table></figure>\n<p>在server中增加:</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">set_real_ip_from</span>   <span class=\"number\">192.168.1.0</span>/<span class=\"number\">24</span>;</span><br><span class=\"line\"><span class=\"attribute\">set_real_ip_from</span>   <span class=\"number\">192.168.2.1</span>;</span><br><span class=\"line\"><span class=\"attribute\">real_ip_header</span>     [X-Real-IP|X-Forwarded-For];</span><br></pre></td></tr></table></figure>\n<p>需要说明的地方就是设置IP源的时候可以设置单个IP，也可以设置IP段，另外是使用X-Real-IP还是X-Forwarded-For，取决于前面的服务器有哪个头。</p>\n<p>set_real_ip_from 设置的IP端可以让运维查看日志，看下你的请求是来自哪些ip段。</p>\n<p>重新加载一下服务，差不多就OK了。</p>\n<p>再查看日志的话，应该可以看到客户端的真实IP了。</p>\n<p>注意：如果未安装该模块的话你的获取到的IP端可能是来自前端代理（如squid）的IP，结果就是多个用户被当成单个用户对待，导致应用不能响应。</p>\n<p>再PS一下： 自测: 有条件的自己可以用ab或者webben自测一下。</p>\n<p>未安装前压测的话，因为有大量请求，所以access.log会有大量日志，而error.log日志没有变化。</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  ~ webbench  <span class=\"literal\">-c</span> <span class=\"number\">30</span> <span class=\"literal\">-t</span> <span class=\"number\">30</span> http://xxx.com</span><br><span class=\"line\">Webbench - Simple Web Benchmark <span class=\"number\">1.5</span></span><br><span class=\"line\">Copyright (c) Radim Kolar <span class=\"number\">1997</span><span class=\"literal\">-2004</span>, GPL Open Source Software.</span><br><span class=\"line\">Benchmarking: GET http://xxx.com  </span><br><span class=\"line\"><span class=\"number\">30</span> clients, running <span class=\"number\">30</span> sec.</span><br><span class=\"line\">Speed=<span class=\"number\">193468</span> pages/min, <span class=\"number\">1254317</span> bytes/sec.</span><br><span class=\"line\">Requests: <span class=\"number\">96734</span> susceed, <span class=\"number\">0</span> failed.</span><br></pre></td></tr></table></figure>\n<p>安装后会发现很多超出的请求会返回503,所以access.log日志变化不快，error.log有大量记录,提示limit_reque缓住了多少请求。</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  ~ webbench  <span class=\"literal\">-c</span> <span class=\"number\">30</span> <span class=\"literal\">-t</span> <span class=\"number\">30</span> http://xxxx.com</span><br><span class=\"line\">Webbench - Simple Web Benchmark <span class=\"number\">1.5</span></span><br><span class=\"line\">Copyright (c) Radim Kolar <span class=\"number\">1997</span><span class=\"literal\">-2004</span>, GPL Open Source Software.</span><br><span class=\"line\">Benchmarking: GET http://xxx.com  </span><br><span class=\"line\"><span class=\"number\">30</span> clients, running <span class=\"number\">30</span> sec.</span><br><span class=\"line\">Speed=<span class=\"number\">120</span> pages/min, <span class=\"number\">778</span> bytes/sec.</span><br><span class=\"line\">Requests: <span class=\"number\">60</span> susceed, <span class=\"number\">0</span> failed.</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>电商平台营销时候，经常会碰到的大流量问题,<br>\n除了做流量分流处理，可能还要做用户黑白名单、信誉分析，进而根据用户ip信誉权重做相应的流量拦截、限制流量。Nginx自身有的请求限制模块ngx_http_limit_req_module、流量限制模块ngx_stream_limit_conn_module基于令牌桶算法，可以方便的控制令牌速率，自定义调节限流，实现基本的限流控制。</p>\n<p>对于提供下载的网站，肯定是要进行流量控制的，例如软件下载站、视频服务等。它也可以减少一些爬虫程序或者DDOS的攻击。</p>\n<p>对这两个模块的介绍的文章也不少，这里转载一篇hopestar的文章: nginx限制IP连接数的范例参考， 因为他介绍的很简洁。</p>\n<blockquote>\n<p>如何Nginx限制同一个ip的连接数，限制并发数目:</p>\n</blockquote>\n<h2 id=\"1-限流\"><a class=\"markdownIt-Anchor\" href=\"#1-限流\"></a> 1. 限流</h2>\n<ul>\n<li>添加limit_zone和limit_req_zone;<br>\n这个变量只能在http使用 :</li>\n</ul>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /export/servers/nginx/conf/nginx.conf </span><br><span class=\"line\">limit_zone one  <span class=\"variable\">$binary_remote_addr</span>  <span class=\"number\">20</span>m;</span><br><span class=\"line\">limit_req_zone  <span class=\"variable\">$binary_remote_addr</span>  zone=req_one:<span class=\"number\">20</span>m rate=<span class=\"number\">12</span>r/s;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>添加limit_conn 和limit_req</li>\n</ul>\n<p>这个变量可以在<code>http</code>, <code>server</code>, <code>location</code>使用 我是限制nginx上的所有服务，所以添加到http里面 （如果你需要限制部分服务，可在nginx/conf/domains里面选择相应的server或者location添加上便可）</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /export/servers/nginx/conf/nginx.conf </span><br><span class=\"line\">limit_zone one <span class=\"variable\">$binary_remote_addr</span> <span class=\"number\">20</span>m;</span><br><span class=\"line\">limit_req_zone <span class=\"variable\">$binary_remote_addr</span> zone=req_one:<span class=\"number\">20</span>m rate=<span class=\"number\">12</span>r/s;</span><br><span class=\"line\">limit_conn one <span class=\"number\">10</span>;</span><br><span class=\"line\">limit_req zone=req_one burst=<span class=\"number\">120</span>;</span><br></pre></td></tr></table></figure>\n<p>参数详解(数值按具体需要和服务器承载能力设置,):</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">limit_zone，是针对每个变量(这里指IP，即<span class=\"variable\">$binary_remote_addr</span>)定义一个存储session状态的容器。  </span><br><span class=\"line\">            这个示例中定义了一个<span class=\"number\">20</span>m的容器，按照<span class=\"number\">32</span>bytes/session，  </span><br><span class=\"line\">            可以处理<span class=\"number\">640000</span>个session。 </span><br><span class=\"line\">limit_req_zone 与limit_zone类似。rate是请求频率. 每秒允许<span class=\"number\">12</span>个请求。</span><br><span class=\"line\">limit_conn  one <span class=\"number\">10</span> : 表示一个IP能发起<span class=\"number\">10</span>个并发连接数</span><br><span class=\"line\">limit_req: 与limit_req_zone对应。burst表示缓存住的请求数。</span><br></pre></td></tr></table></figure>\n<p>示例：</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attribute\">limit_zone</span> one  <span class=\"variable\">$binary_remote_addr</span>  <span class=\"number\">20m</span>;</span><br><span class=\"line\">    <span class=\"attribute\">limit_req_zone</span>  <span class=\"variable\">$binary_remote_addr</span>  zone=req_one:<span class=\"number\">20m</span> rate=12r/s;</span><br><span class=\"line\">    <span class=\"attribute\">limit_conn</span>   one  <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"attribute\">limit_req</span>   zone=req_one burst=<span class=\"number\">120</span>;</span><br><span class=\"line\">    <span class=\"section\">server</span>  &#123;</span><br><span class=\"line\">        <span class=\"attribute\">listen</span>          <span class=\"number\">80</span>;</span><br><span class=\"line\">        <span class=\"attribute\">server_name</span>     status.xxx.com ;</span><br><span class=\"line\">        <span class=\"attribute\">location</span> / &#123;</span><br><span class=\"line\">                 <span class=\"attribute\">stub_status</span>            <span class=\"literal\">on</span>;</span><br><span class=\"line\">                 <span class=\"attribute\">access_log</span>             <span class=\"literal\">off</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>重启nginx</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/export/servers/nginx/sbin/nginx -s reload</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-nginx白名单设置\"><a class=\"markdownIt-Anchor\" href=\"#2-nginx白名单设置\"></a> 2. nginx白名单设置</h2>\n<p>以上配置会对所有的ip都进行限制，有些时候我们不希望对搜索引擎的蜘蛛或者某些自己的代理机过来的请求进行限制， 对于特定的白名单ip我们可以借助geo指令实现。</p>\n<p>先在nginx的请求日志进行统计，查看那个ip的访问量比较大， 运行:</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">cat</span> access.<span class=\"built_in\">log</span> | <span class=\"keyword\">grep</span> <span class=\"string\">\"03/Jun\"</span> |awk <span class=\"string\">'&#123;print $1&#125;'</span>|<span class=\"keyword\">sort</span> |uniq -<span class=\"keyword\">c</span>|<span class=\"keyword\">sort</span> -nrk <span class=\"number\">1</span>|head -n <span class=\"number\">10</span></span><br><span class=\"line\">#列出访问日志里面在<span class=\"number\">6</span>月<span class=\"number\">3</span>号这天前<span class=\"number\">10</span>个访问量最大的ip.</span><br></pre></td></tr></table></figure>\n<p>接下来就可以对这些IP进行分析了。看哪些需要进行白名单设置。</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attribute\">geo</span>  <span class=\"variable\">$limited</span>  &#123; <span class=\"comment\"># the variable created is $limited</span></span><br><span class=\"line\">        <span class=\"attribute\">default</span>          <span class=\"number\">1</span>;</span><br><span class=\"line\">        127.0.0.1/32     0;</span><br><span class=\"line\">        10.12.212.63     0;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"attribute\">map</span> <span class=\"variable\">$limited</span> <span class=\"variable\">$limit</span> &#123;</span><br><span class=\"line\">        1 $binary_remote_addr;</span><br><span class=\"line\">        0 \"\";</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"attribute\">limit_zone</span> one  <span class=\"variable\">$binary_remote_addr</span>  <span class=\"number\">20m</span>;</span><br><span class=\"line\">    <span class=\"attribute\">limit_req_zone</span>  <span class=\"variable\">$limit</span>  zone=req_one:<span class=\"number\">20m</span> rate=20r/s;</span><br><span class=\"line\">    <span class=\"attribute\">limit_conn</span>   one  <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"attribute\">limit_req</span>   zone=req_one burst=<span class=\"number\">120</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>上面两个需要用到map和geo模块，这是nginx自带的模块，有的运维喜欢把他们关闭，自己<code>./sbin/nginx -V</code> 留意一下。把配置的<code>--whithout-XXX-module</code>去掉重新编译一下就可以了。 上面这段配置的意思是：</p>\n<p>geo指令定义了一个白名单<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>l</mi><mi>i</mi><mi>m</mi><mi>i</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi mathvariant=\"normal\">变</mi><mi mathvariant=\"normal\">量</mi><mi mathvariant=\"normal\">，</mi><mi mathvariant=\"normal\">默</mi><mi mathvariant=\"normal\">认</mi><mi mathvariant=\"normal\">值</mi><mi mathvariant=\"normal\">为</mi><mn>1</mn><mi mathvariant=\"normal\">，</mi><mi mathvariant=\"normal\">如</mi><mi mathvariant=\"normal\">果</mi><mi mathvariant=\"normal\">客</mi><mi mathvariant=\"normal\">户</mi><mi mathvariant=\"normal\">端</mi><mi>i</mi><mi>p</mi><mi mathvariant=\"normal\">在</mi><mi mathvariant=\"normal\">上</mi><mi mathvariant=\"normal\">面</mi><mi mathvariant=\"normal\">的</mi><mi mathvariant=\"normal\">范</mi><mi mathvariant=\"normal\">围</mi><mi mathvariant=\"normal\">内</mi><mi mathvariant=\"normal\">，</mi></mrow><annotation encoding=\"application/x-tex\">limited变量，默认值为1，如果客户端ip在上面的范围内，</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">m</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\">d</span><span class=\"mord cjk_fallback\">变</span><span class=\"mord cjk_fallback\">量</span><span class=\"mord cjk_fallback\">，</span><span class=\"mord cjk_fallback\">默</span><span class=\"mord cjk_fallback\">认</span><span class=\"mord cjk_fallback\">值</span><span class=\"mord cjk_fallback\">为</span><span class=\"mord\">1</span><span class=\"mord cjk_fallback\">，</span><span class=\"mord cjk_fallback\">如</span><span class=\"mord cjk_fallback\">果</span><span class=\"mord cjk_fallback\">客</span><span class=\"mord cjk_fallback\">户</span><span class=\"mord cjk_fallback\">端</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">p</span><span class=\"mord cjk_fallback\">在</span><span class=\"mord cjk_fallback\">上</span><span class=\"mord cjk_fallback\">面</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">范</span><span class=\"mord cjk_fallback\">围</span><span class=\"mord cjk_fallback\">内</span><span class=\"mord cjk_fallback\">，</span></span></span></span>limited的值为0<br>\n使用map指令映射搜索引擎客户端的ip为空串，如果不是搜索引擎就显示本身真实的ip，这样搜索引擎ip就不能存到limit_req_zone内存session中，所以不会限制搜索引擎的ip访问</p>\n<h2 id=\"3-获取客户端的真实ip\"><a class=\"markdownIt-Anchor\" href=\"#3-获取客户端的真实ip\"></a> 3. 获取客户端的真实IP</h2>\n<p>顺带一提，为了获取客户端的真实IP。该模块需要安装read_ip模块，运维应该默认有安装。没有的话也可自行安装： 配置方式相当简单，重新编译 Nginx 加上 --with-http_realip_module 参数，如：</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./configure -<span class=\"literal\">-prefix</span>=/opt/nginx -<span class=\"literal\">-with</span><span class=\"literal\">-http_stub_status_module</span>  -<span class=\"literal\">-with</span><span class=\"literal\">-pcre</span>=../pcre<span class=\"literal\">-6</span>.<span class=\"number\">6</span> -<span class=\"literal\">-with</span><span class=\"literal\">-http_realip_module</span></span><br><span class=\"line\">make</span><br><span class=\"line\">make install</span><br></pre></td></tr></table></figure>\n<p>在server中增加:</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">set_real_ip_from</span>   <span class=\"number\">192.168.1.0</span>/<span class=\"number\">24</span>;</span><br><span class=\"line\"><span class=\"attribute\">set_real_ip_from</span>   <span class=\"number\">192.168.2.1</span>;</span><br><span class=\"line\"><span class=\"attribute\">real_ip_header</span>     [X-Real-IP|X-Forwarded-For];</span><br></pre></td></tr></table></figure>\n<p>需要说明的地方就是设置IP源的时候可以设置单个IP，也可以设置IP段，另外是使用X-Real-IP还是X-Forwarded-For，取决于前面的服务器有哪个头。</p>\n<p>set_real_ip_from 设置的IP端可以让运维查看日志，看下你的请求是来自哪些ip段。</p>\n<p>重新加载一下服务，差不多就OK了。</p>\n<p>再查看日志的话，应该可以看到客户端的真实IP了。</p>\n<p>注意：如果未安装该模块的话你的获取到的IP端可能是来自前端代理（如squid）的IP，结果就是多个用户被当成单个用户对待，导致应用不能响应。</p>\n<p>再PS一下： 自测: 有条件的自己可以用ab或者webben自测一下。</p>\n<p>未安装前压测的话，因为有大量请求，所以access.log会有大量日志，而error.log日志没有变化。</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  ~ webbench  <span class=\"literal\">-c</span> <span class=\"number\">30</span> <span class=\"literal\">-t</span> <span class=\"number\">30</span> http://xxx.com</span><br><span class=\"line\">Webbench - Simple Web Benchmark <span class=\"number\">1.5</span></span><br><span class=\"line\">Copyright (c) Radim Kolar <span class=\"number\">1997</span><span class=\"literal\">-2004</span>, GPL Open Source Software.</span><br><span class=\"line\">Benchmarking: GET http://xxx.com  </span><br><span class=\"line\"><span class=\"number\">30</span> clients, running <span class=\"number\">30</span> sec.</span><br><span class=\"line\">Speed=<span class=\"number\">193468</span> pages/min, <span class=\"number\">1254317</span> bytes/sec.</span><br><span class=\"line\">Requests: <span class=\"number\">96734</span> susceed, <span class=\"number\">0</span> failed.</span><br></pre></td></tr></table></figure>\n<p>安装后会发现很多超出的请求会返回503,所以access.log日志变化不快，error.log有大量记录,提示limit_reque缓住了多少请求。</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">➜  ~ webbench  <span class=\"literal\">-c</span> <span class=\"number\">30</span> <span class=\"literal\">-t</span> <span class=\"number\">30</span> http://xxxx.com</span><br><span class=\"line\">Webbench - Simple Web Benchmark <span class=\"number\">1.5</span></span><br><span class=\"line\">Copyright (c) Radim Kolar <span class=\"number\">1997</span><span class=\"literal\">-2004</span>, GPL Open Source Software.</span><br><span class=\"line\">Benchmarking: GET http://xxx.com  </span><br><span class=\"line\"><span class=\"number\">30</span> clients, running <span class=\"number\">30</span> sec.</span><br><span class=\"line\">Speed=<span class=\"number\">120</span> pages/min, <span class=\"number\">778</span> bytes/sec.</span><br><span class=\"line\">Requests: <span class=\"number\">60</span> susceed, <span class=\"number\">0</span> failed.</span><br></pre></td></tr></table></figure>\n"},{"title":"Nginx 负载均衡策略","date":"2017-04-27T16:00:00.000Z","_content":"\n\n1. 轮询（默认）每个web请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器down掉，能自动剔除。\n   \n    ```\n    Upstream nginxDemo{\n        server 127.0.0.1:8001;\n        server 127.0.0.1:8002;\n    }\n    ```\n\n2. 最少链接web请求会被转发到连接数最少的服务器上。\n\n    ```\n    Upstream nginxDemo{\n        least_conn;\n        server 127.0.0.1:8001;\n        server 127.0.0.1:8002;\n    }\n    ```\n\n\n3. weight 权重指定轮询几率，weight和访问比率成正比，用 于后端服务器性能不均的情况，weight默认是1。\n    \n    ```\n    #服务器A和服务器B的访问比例：2-1；比如有3个请求，前两个会访问A，第三个会访问B，其他的归着和轮询一样。\n    \n    Upstream nginxDemo{\n        least_conn;\n        server 127.0.0.1:8001;\n        server 127.0.0.1:8002;\n    }\n    ```\n\n4. ip_hash每个请求按访问ip的hash值分配，这样同一客户端连续的Web请求都会被分发到同一服务器进行处理，可以解决session的问题。当后台服务器宕机时，会自动跳转到其它服务器。基于weight的负载均衡和基于ip_hash的负载均衡可以组合在一起使用。\n\n    ```\n    ip_hash;\n    Upstream nginxDemo{\n        server 127.0.0.1:8001 weight=2; #服务器A\n        server 127.0.0.1:8002; #服务器B\n    }\n    ```\n5. url_hash（第三方）url_hash是nginx的第三方模块，nginx本身不支持，需要打补丁。nginx按访问url的hash结果来分配请求，使每个url定向到同一个后端服务器，后端服务器为缓存服务器、文件服务器、静态服务器时比较有效。缺点是当后端服务器宕机的时候，url_hash不会自动跳转的其他缓存服务器，而是返回给用户一个503错误。\n\n    ```\n    Upstream nginxDemo{\n        server 127.0.0.1:8001 weight=2; #服务器A\n        server 127.0.0.1:8002; #服务器B\n        hash  $request_url;\n    }\n    ```\n\n6. fair（第三方）按后端服务器的响应时间来分配请求，响应时间短的优先分配。\n   \n    ```\n    Upstream nginxDemo{\n        server 127.0.0.1:8001 weight=2; #服务器A\n        server 127.0.0.1:8002; #服务器B\n        hair;\n    }\n    ```\n\n\n","source":"_posts/2017-04-28.md","raw":"---\ntitle: Nginx 负载均衡策略\ndate: 2017-04-28\ntags: [nginx]\n---\n\n\n1. 轮询（默认）每个web请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器down掉，能自动剔除。\n   \n    ```\n    Upstream nginxDemo{\n        server 127.0.0.1:8001;\n        server 127.0.0.1:8002;\n    }\n    ```\n\n2. 最少链接web请求会被转发到连接数最少的服务器上。\n\n    ```\n    Upstream nginxDemo{\n        least_conn;\n        server 127.0.0.1:8001;\n        server 127.0.0.1:8002;\n    }\n    ```\n\n\n3. weight 权重指定轮询几率，weight和访问比率成正比，用 于后端服务器性能不均的情况，weight默认是1。\n    \n    ```\n    #服务器A和服务器B的访问比例：2-1；比如有3个请求，前两个会访问A，第三个会访问B，其他的归着和轮询一样。\n    \n    Upstream nginxDemo{\n        least_conn;\n        server 127.0.0.1:8001;\n        server 127.0.0.1:8002;\n    }\n    ```\n\n4. ip_hash每个请求按访问ip的hash值分配，这样同一客户端连续的Web请求都会被分发到同一服务器进行处理，可以解决session的问题。当后台服务器宕机时，会自动跳转到其它服务器。基于weight的负载均衡和基于ip_hash的负载均衡可以组合在一起使用。\n\n    ```\n    ip_hash;\n    Upstream nginxDemo{\n        server 127.0.0.1:8001 weight=2; #服务器A\n        server 127.0.0.1:8002; #服务器B\n    }\n    ```\n5. url_hash（第三方）url_hash是nginx的第三方模块，nginx本身不支持，需要打补丁。nginx按访问url的hash结果来分配请求，使每个url定向到同一个后端服务器，后端服务器为缓存服务器、文件服务器、静态服务器时比较有效。缺点是当后端服务器宕机的时候，url_hash不会自动跳转的其他缓存服务器，而是返回给用户一个503错误。\n\n    ```\n    Upstream nginxDemo{\n        server 127.0.0.1:8001 weight=2; #服务器A\n        server 127.0.0.1:8002; #服务器B\n        hash  $request_url;\n    }\n    ```\n\n6. fair（第三方）按后端服务器的响应时间来分配请求，响应时间短的优先分配。\n   \n    ```\n    Upstream nginxDemo{\n        server 127.0.0.1:8001 weight=2; #服务器A\n        server 127.0.0.1:8002; #服务器B\n        hair;\n    }\n    ```\n\n\n","slug":"2017-04-28","published":1,"updated":"2020-08-30T04:04:21.904Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot0a000dip9k2n9orqyg","content":"<ol>\n<li>\n<p>轮询（默认）每个web请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器down掉，能自动剔除。</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Upstream nginxDemo&#123;</span><br><span class=\"line\">    server 127.0.0.1:8001;</span><br><span class=\"line\">    server 127.0.0.1:8002;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>最少链接web请求会被转发到连接数最少的服务器上。</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Upstream nginxDemo&#123;</span><br><span class=\"line\">    least_conn;</span><br><span class=\"line\">    server 127.0.0.1:8001;</span><br><span class=\"line\">    server 127.0.0.1:8002;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>weight 权重指定轮询几率，weight和访问比率成正比，用 于后端服务器性能不均的情况，weight默认是1。</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#服务器A和服务器B的访问比例：2-1；比如有3个请求，前两个会访问A，第三个会访问B，其他的归着和轮询一样。</span><br><span class=\"line\"></span><br><span class=\"line\">Upstream nginxDemo&#123;</span><br><span class=\"line\">    least_conn;</span><br><span class=\"line\">    server 127.0.0.1:8001;</span><br><span class=\"line\">    server 127.0.0.1:8002;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>ip_hash每个请求按访问ip的hash值分配，这样同一客户端连续的Web请求都会被分发到同一服务器进行处理，可以解决session的问题。当后台服务器宕机时，会自动跳转到其它服务器。基于weight的负载均衡和基于ip_hash的负载均衡可以组合在一起使用。</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip_hash;</span><br><span class=\"line\">Upstream nginxDemo&#123;</span><br><span class=\"line\">    server 127.0.0.1:8001 weight=2; #服务器A</span><br><span class=\"line\">    server 127.0.0.1:8002; #服务器B</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>url_hash（第三方）url_hash是nginx的第三方模块，nginx本身不支持，需要打补丁。nginx按访问url的hash结果来分配请求，使每个url定向到同一个后端服务器，后端服务器为缓存服务器、文件服务器、静态服务器时比较有效。缺点是当后端服务器宕机的时候，url_hash不会自动跳转的其他缓存服务器，而是返回给用户一个503错误。</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Upstream nginxDemo&#123;</span><br><span class=\"line\">    server 127.0.0.1:8001 weight=2; #服务器A</span><br><span class=\"line\">    server 127.0.0.1:8002; #服务器B</span><br><span class=\"line\">    hash  $request_url;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>fair（第三方）按后端服务器的响应时间来分配请求，响应时间短的优先分配。</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Upstream nginxDemo&#123;</span><br><span class=\"line\">    server 127.0.0.1:8001 weight=2; #服务器A</span><br><span class=\"line\">    server 127.0.0.1:8002; #服务器B</span><br><span class=\"line\">    hair;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<ol>\n<li>\n<p>轮询（默认）每个web请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器down掉，能自动剔除。</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Upstream nginxDemo&#123;</span><br><span class=\"line\">    server 127.0.0.1:8001;</span><br><span class=\"line\">    server 127.0.0.1:8002;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>最少链接web请求会被转发到连接数最少的服务器上。</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Upstream nginxDemo&#123;</span><br><span class=\"line\">    least_conn;</span><br><span class=\"line\">    server 127.0.0.1:8001;</span><br><span class=\"line\">    server 127.0.0.1:8002;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>weight 权重指定轮询几率，weight和访问比率成正比，用 于后端服务器性能不均的情况，weight默认是1。</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#服务器A和服务器B的访问比例：2-1；比如有3个请求，前两个会访问A，第三个会访问B，其他的归着和轮询一样。</span><br><span class=\"line\"></span><br><span class=\"line\">Upstream nginxDemo&#123;</span><br><span class=\"line\">    least_conn;</span><br><span class=\"line\">    server 127.0.0.1:8001;</span><br><span class=\"line\">    server 127.0.0.1:8002;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>ip_hash每个请求按访问ip的hash值分配，这样同一客户端连续的Web请求都会被分发到同一服务器进行处理，可以解决session的问题。当后台服务器宕机时，会自动跳转到其它服务器。基于weight的负载均衡和基于ip_hash的负载均衡可以组合在一起使用。</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip_hash;</span><br><span class=\"line\">Upstream nginxDemo&#123;</span><br><span class=\"line\">    server 127.0.0.1:8001 weight=2; #服务器A</span><br><span class=\"line\">    server 127.0.0.1:8002; #服务器B</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>url_hash（第三方）url_hash是nginx的第三方模块，nginx本身不支持，需要打补丁。nginx按访问url的hash结果来分配请求，使每个url定向到同一个后端服务器，后端服务器为缓存服务器、文件服务器、静态服务器时比较有效。缺点是当后端服务器宕机的时候，url_hash不会自动跳转的其他缓存服务器，而是返回给用户一个503错误。</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Upstream nginxDemo&#123;</span><br><span class=\"line\">    server 127.0.0.1:8001 weight=2; #服务器A</span><br><span class=\"line\">    server 127.0.0.1:8002; #服务器B</span><br><span class=\"line\">    hash  $request_url;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>fair（第三方）按后端服务器的响应时间来分配请求，响应时间短的优先分配。</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Upstream nginxDemo&#123;</span><br><span class=\"line\">    server 127.0.0.1:8001 weight=2; #服务器A</span><br><span class=\"line\">    server 127.0.0.1:8002; #服务器B</span><br><span class=\"line\">    hair;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n"},{"title":"operator mono vs fira code","date":"2017-05-26T16:00:00.000Z","_content":"\n\noperator mono 和 fira code 两个字体是目前世界上最好的字体。\n\n\n1：看看别人的介绍\n\n[Operator Mono & Fira Code — The Best of Both Worlds\n](https://medium.com/@peterpme/operator-mono-fira-code-the-best-of-both-worlds-191be512fd5e)\n\n2：Laravel作者  Eric L. Barnes用的也是这个字体。作者在推特上面发布出了他的配置\n\n![laravel](laravel.png)\n\n\n\n\n3：`operator mono` 是收费字体。fira code是免费字体。\n如果在mac 安装 `fira code`  可以使用命令\n\n`brew cask install font-fira-code\n`\n最后提供一个 operator mono下载地址\n链接: https://pan.baidu.com/s/1nvynUXF 密码: kezv\n\n4:完成之后效果\n\n![my](my.png)\n\n\n","source":"_posts/2017-05-27.md","raw":"---\ntitle: operator mono vs fira code\ndate: 2017-05-27\ntags: [operator mono,fira code] \n---\n\n\noperator mono 和 fira code 两个字体是目前世界上最好的字体。\n\n\n1：看看别人的介绍\n\n[Operator Mono & Fira Code — The Best of Both Worlds\n](https://medium.com/@peterpme/operator-mono-fira-code-the-best-of-both-worlds-191be512fd5e)\n\n2：Laravel作者  Eric L. Barnes用的也是这个字体。作者在推特上面发布出了他的配置\n\n![laravel](laravel.png)\n\n\n\n\n3：`operator mono` 是收费字体。fira code是免费字体。\n如果在mac 安装 `fira code`  可以使用命令\n\n`brew cask install font-fira-code\n`\n最后提供一个 operator mono下载地址\n链接: https://pan.baidu.com/s/1nvynUXF 密码: kezv\n\n4:完成之后效果\n\n![my](my.png)\n\n\n","slug":"2017-05-27","published":1,"updated":"2020-08-30T04:04:21.899Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot0c000fip9k3tko1qjw","content":"<p>operator mono 和 fira code 两个字体是目前世界上最好的字体。</p>\n<p>1：看看别人的介绍</p>\n<p><a href=\"https://medium.com/@peterpme/operator-mono-fira-code-the-best-of-both-worlds-191be512fd5e\" target=\"_blank\" rel=\"noopener\">Operator Mono &amp; Fira Code — The Best of Both Worlds<br>\n</a></p>\n<p>2：Laravel作者  Eric L. Barnes用的也是这个字体。作者在推特上面发布出了他的配置</p>\n<p><img src=\"laravel.png\" alt=\"laravel\"></p>\n<p>3：<code>operator mono</code> 是收费字体。fira code是免费字体。<br>\n如果在mac 安装 <code>fira code</code>  可以使用命令</p>\n<p><code>brew cask install font-fira-code</code><br>\n最后提供一个 operator mono下载地址<br>\n链接: <a href=\"https://pan.baidu.com/s/1nvynUXF\" target=\"_blank\" rel=\"noopener\">https://pan.baidu.com/s/1nvynUXF</a> 密码: kezv</p>\n<p>4:完成之后效果</p>\n<p><img src=\"my.png\" alt=\"my\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>operator mono 和 fira code 两个字体是目前世界上最好的字体。</p>\n<p>1：看看别人的介绍</p>\n<p><a href=\"https://medium.com/@peterpme/operator-mono-fira-code-the-best-of-both-worlds-191be512fd5e\" target=\"_blank\" rel=\"noopener\">Operator Mono &amp; Fira Code — The Best of Both Worlds<br>\n</a></p>\n<p>2：Laravel作者  Eric L. Barnes用的也是这个字体。作者在推特上面发布出了他的配置</p>\n<p><img src=\"laravel.png\" alt=\"laravel\"></p>\n<p>3：<code>operator mono</code> 是收费字体。fira code是免费字体。<br>\n如果在mac 安装 <code>fira code</code>  可以使用命令</p>\n<p><code>brew cask install font-fira-code</code><br>\n最后提供一个 operator mono下载地址<br>\n链接: <a href=\"https://pan.baidu.com/s/1nvynUXF\" target=\"_blank\" rel=\"noopener\">https://pan.baidu.com/s/1nvynUXF</a> 密码: kezv</p>\n<p>4:完成之后效果</p>\n<p><img src=\"my.png\" alt=\"my\"></p>\n"},{"title":"php 基准测试对比。","date":"2017-05-31T16:00:00.000Z","_content":"\nphp7 相比 Php5.6 提升 2-3 倍。\nPHP7-JIT 相比 PHP5.6 提升 8 倍。\n\n\n如果作为 php 开发者连鸟哥都不认识，起码不是很合格吧。下面是鸟哥做的测试对比。\n\n![php](php.png)\n\n\n下面是鸟哥做的分享。\n\n[为什么选择 php7？](https://www.slideshare.net/slideshow/embed_code/key/KMbqLBfzYnMN29)","source":"_posts/2017-06-01.md","raw":"---\ntitle: php 基准测试对比。\ndate: 2017-06-01\ntags: [php,php-jit] \n---\n\nphp7 相比 Php5.6 提升 2-3 倍。\nPHP7-JIT 相比 PHP5.6 提升 8 倍。\n\n\n如果作为 php 开发者连鸟哥都不认识，起码不是很合格吧。下面是鸟哥做的测试对比。\n\n![php](php.png)\n\n\n下面是鸟哥做的分享。\n\n[为什么选择 php7？](https://www.slideshare.net/slideshow/embed_code/key/KMbqLBfzYnMN29)","slug":"2017-06-01","published":1,"updated":"2020-08-30T04:21:33.268Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot0d000hip9k8pkhmizo","content":"<p>php7 相比 Php5.6 提升 2-3 倍。<br>\nPHP7-JIT 相比 PHP5.6 提升 8 倍。</p>\n<p>如果作为 php 开发者连鸟哥都不认识，起码不是很合格吧。下面是鸟哥做的测试对比。</p>\n<p><img src=\"php.png\" alt=\"php\"></p>\n<p>下面是鸟哥做的分享。</p>\n<p><a href=\"https://www.slideshare.net/slideshow/embed_code/key/KMbqLBfzYnMN29\" target=\"_blank\" rel=\"noopener\">为什么选择 php7？</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>php7 相比 Php5.6 提升 2-3 倍。<br>\nPHP7-JIT 相比 PHP5.6 提升 8 倍。</p>\n<p>如果作为 php 开发者连鸟哥都不认识，起码不是很合格吧。下面是鸟哥做的测试对比。</p>\n<p><img src=\"php.png\" alt=\"php\"></p>\n<p>下面是鸟哥做的分享。</p>\n<p><a href=\"https://www.slideshare.net/slideshow/embed_code/key/KMbqLBfzYnMN29\" target=\"_blank\" rel=\"noopener\">为什么选择 php7？</a></p>\n"},{"title":"go基本语法","date":"2016-04-28T07:25:02.000Z","_content":"\n### 变量和赋值\n\n在go 语言中声明和赋值是分开的需要两步，也可以写成一步\n\n```go\nvar a int\nvar b bool\na = 5\nb = false\n```\n\n或者写成一步\n\n```go\na :=5\nb :=false\n```\n多个var声明可以成组\n\n```go\nvar(\n\tx int\n\tb bool\n)\n```\n\n具备相同的类型多个变量可以在一行内完成声明：var x,y int 让x 和 y 都是\nint 类型变量。同样也可以平行赋值\n\n```go\na,b := 20,16\n```\n这样让a和b的值分别是20和16\n\n一些特殊的变量名是_(下划线)。标示任何赋值给他的都会抛弃掉。\n例如：\n\n```go\n_,b :=1,2\n```\n这样抛弃掉1 把b赋值为2.\n\n### 数字类型(Number)\n\n数值类型有三种，一种是`整数类型`，另外一种是`浮点型`,\n还有一种是`虚数类型`。正整数和零统称为: `无符号整型`,\n而负整数称为: `有符号整型`。\n\n无符号类型能够表示正整数和零。而有符号类型除了能够表示正整数和零外，还可以表示负整数。\n\n另外还有一些别名类型，比如byte类型，这个类型和uint8是一样的，表示字节类型。另外一个是rune类型，这个类型和int32是一样的，用来表示unicode的代码点，就是unicode字符所对应的整数。\n\nGo还定义了三个依赖系统的类型，uint，int和uintptr。因为在32位系统和64位系统上用来表示这些类型的位数是不一样的。\n\n```go\n对于32位系统\nuint=uint32\nint=int32\nuintptr为32位的指针\n对于64位系统\nuint=uint64\nint=int64\nuintptr为64位的指针\n```\n至于类型后面跟的数字8，16，32或是64则表示用来表示这个类型的位不同，位越多，能表示的整数范围越大。\n\n比如对于用N位来表示的整数，如果是有符号的整数，能够表示的整数范围为-2^(N-1) ~ 2^(N-1)－1；如果是无符号的整数，则能表示的整数范围为0 ～ 2^(N-1)。\n\nGo的浮点数类型有两种，`float32`和`float64`。float32又叫单精度浮点型，float64又叫做双精度浮点型。其最主要的区别就是小数点后面能跟的小数位数不同.\n\n另外Go还有两个其他语言所没有的类型，虚数类型。complex64和complex128。\n\n对于数值类型，其所共有的操作为加法(＋)，减法(－)，乘法(＊)和除法(/)。另外对于整数类型，还定义了求余运算(%)\n\n```go\npackage main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var a float64 = 12\n    var b float64 = 3\n\n    fmt.Println(a % b)\n}\n```\n\n\n\n\n\n\n\n\n\n","source":"_posts/go-sty01.md","raw":"---\ntitle: go基本语法\ndate: 2016-04-28 15:25:02\ntags: [go,golang]\n---\n\n### 变量和赋值\n\n在go 语言中声明和赋值是分开的需要两步，也可以写成一步\n\n```go\nvar a int\nvar b bool\na = 5\nb = false\n```\n\n或者写成一步\n\n```go\na :=5\nb :=false\n```\n多个var声明可以成组\n\n```go\nvar(\n\tx int\n\tb bool\n)\n```\n\n具备相同的类型多个变量可以在一行内完成声明：var x,y int 让x 和 y 都是\nint 类型变量。同样也可以平行赋值\n\n```go\na,b := 20,16\n```\n这样让a和b的值分别是20和16\n\n一些特殊的变量名是_(下划线)。标示任何赋值给他的都会抛弃掉。\n例如：\n\n```go\n_,b :=1,2\n```\n这样抛弃掉1 把b赋值为2.\n\n### 数字类型(Number)\n\n数值类型有三种，一种是`整数类型`，另外一种是`浮点型`,\n还有一种是`虚数类型`。正整数和零统称为: `无符号整型`,\n而负整数称为: `有符号整型`。\n\n无符号类型能够表示正整数和零。而有符号类型除了能够表示正整数和零外，还可以表示负整数。\n\n另外还有一些别名类型，比如byte类型，这个类型和uint8是一样的，表示字节类型。另外一个是rune类型，这个类型和int32是一样的，用来表示unicode的代码点，就是unicode字符所对应的整数。\n\nGo还定义了三个依赖系统的类型，uint，int和uintptr。因为在32位系统和64位系统上用来表示这些类型的位数是不一样的。\n\n```go\n对于32位系统\nuint=uint32\nint=int32\nuintptr为32位的指针\n对于64位系统\nuint=uint64\nint=int64\nuintptr为64位的指针\n```\n至于类型后面跟的数字8，16，32或是64则表示用来表示这个类型的位不同，位越多，能表示的整数范围越大。\n\n比如对于用N位来表示的整数，如果是有符号的整数，能够表示的整数范围为-2^(N-1) ~ 2^(N-1)－1；如果是无符号的整数，则能表示的整数范围为0 ～ 2^(N-1)。\n\nGo的浮点数类型有两种，`float32`和`float64`。float32又叫单精度浮点型，float64又叫做双精度浮点型。其最主要的区别就是小数点后面能跟的小数位数不同.\n\n另外Go还有两个其他语言所没有的类型，虚数类型。complex64和complex128。\n\n对于数值类型，其所共有的操作为加法(＋)，减法(－)，乘法(＊)和除法(/)。另外对于整数类型，还定义了求余运算(%)\n\n```go\npackage main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var a float64 = 12\n    var b float64 = 3\n\n    fmt.Println(a % b)\n}\n```\n\n\n\n\n\n\n\n\n\n","slug":"go-sty01","published":1,"updated":"2016-04-29T04:15:52.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot0f000kip9k0h4t005m","content":"<h3 id=\"变量和赋值\"><a class=\"markdownIt-Anchor\" href=\"#变量和赋值\"></a> 变量和赋值</h3>\n<p>在go 语言中声明和赋值是分开的需要两步，也可以写成一步</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> a <span class=\"keyword\">int</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> b <span class=\"keyword\">bool</span></span><br><span class=\"line\">a = <span class=\"number\">5</span></span><br><span class=\"line\">b = <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n<p>或者写成一步</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a :=<span class=\"number\">5</span></span><br><span class=\"line\">b :=<span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n<p>多个var声明可以成组</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span>(</span><br><span class=\"line\">\tx <span class=\"keyword\">int</span></span><br><span class=\"line\">\tb <span class=\"keyword\">bool</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<p>具备相同的类型多个变量可以在一行内完成声明：var x,y int 让x 和 y 都是<br>\nint 类型变量。同样也可以平行赋值</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a,b := <span class=\"number\">20</span>,<span class=\"number\">16</span></span><br></pre></td></tr></table></figure>\n<p>这样让a和b的值分别是20和16</p>\n<p>一些特殊的变量名是_(下划线)。标示任何赋值给他的都会抛弃掉。<br>\n例如：</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">_,b :=<span class=\"number\">1</span>,<span class=\"number\">2</span></span><br></pre></td></tr></table></figure>\n<p>这样抛弃掉1 把b赋值为2.</p>\n<h3 id=\"数字类型number\"><a class=\"markdownIt-Anchor\" href=\"#数字类型number\"></a> 数字类型(Number)</h3>\n<p>数值类型有三种，一种是<code>整数类型</code>，另外一种是<code>浮点型</code>,<br>\n还有一种是<code>虚数类型</code>。正整数和零统称为: <code>无符号整型</code>,<br>\n而负整数称为: <code>有符号整型</code>。</p>\n<p>无符号类型能够表示正整数和零。而有符号类型除了能够表示正整数和零外，还可以表示负整数。</p>\n<p>另外还有一些别名类型，比如byte类型，这个类型和uint8是一样的，表示字节类型。另外一个是rune类型，这个类型和int32是一样的，用来表示unicode的代码点，就是unicode字符所对应的整数。</p>\n<p>Go还定义了三个依赖系统的类型，uint，int和uintptr。因为在32位系统和64位系统上用来表示这些类型的位数是不一样的。</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">对于<span class=\"number\">32</span>位系统</span><br><span class=\"line\"><span class=\"keyword\">uint</span>=<span class=\"keyword\">uint32</span></span><br><span class=\"line\"><span class=\"keyword\">int</span>=<span class=\"keyword\">int32</span></span><br><span class=\"line\"><span class=\"keyword\">uintptr</span>为<span class=\"number\">32</span>位的指针</span><br><span class=\"line\">对于<span class=\"number\">64</span>位系统</span><br><span class=\"line\"><span class=\"keyword\">uint</span>=<span class=\"keyword\">uint64</span></span><br><span class=\"line\"><span class=\"keyword\">int</span>=<span class=\"keyword\">int64</span></span><br><span class=\"line\"><span class=\"keyword\">uintptr</span>为<span class=\"number\">64</span>位的指针</span><br></pre></td></tr></table></figure>\n<p>至于类型后面跟的数字8，16，32或是64则表示用来表示这个类型的位不同，位越多，能表示的整数范围越大。</p>\n<p>比如对于用N位来表示的整数，如果是有符号的整数，能够表示的整数范围为-2^(N-1) ~ 2^(N-1)－1；如果是无符号的整数，则能表示的整数范围为0 ～ 2^(N-1)。</p>\n<p>Go的浮点数类型有两种，<code>float32</code>和<code>float64</code>。float32又叫单精度浮点型，float64又叫做双精度浮点型。其最主要的区别就是小数点后面能跟的小数位数不同.</p>\n<p>另外Go还有两个其他语言所没有的类型，虚数类型。complex64和complex128。</p>\n<p>对于数值类型，其所共有的操作为加法(＋)，减法(－)，乘法(＊)和除法(/)。另外对于整数类型，还定义了求余运算(%)</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> a <span class=\"keyword\">float64</span> = <span class=\"number\">12</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> b <span class=\"keyword\">float64</span> = <span class=\"number\">3</span></span><br><span class=\"line\"></span><br><span class=\"line\">    fmt.Println(a % b)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"变量和赋值\"><a class=\"markdownIt-Anchor\" href=\"#变量和赋值\"></a> 变量和赋值</h3>\n<p>在go 语言中声明和赋值是分开的需要两步，也可以写成一步</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> a <span class=\"keyword\">int</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> b <span class=\"keyword\">bool</span></span><br><span class=\"line\">a = <span class=\"number\">5</span></span><br><span class=\"line\">b = <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n<p>或者写成一步</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a :=<span class=\"number\">5</span></span><br><span class=\"line\">b :=<span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n<p>多个var声明可以成组</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span>(</span><br><span class=\"line\">\tx <span class=\"keyword\">int</span></span><br><span class=\"line\">\tb <span class=\"keyword\">bool</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<p>具备相同的类型多个变量可以在一行内完成声明：var x,y int 让x 和 y 都是<br>\nint 类型变量。同样也可以平行赋值</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a,b := <span class=\"number\">20</span>,<span class=\"number\">16</span></span><br></pre></td></tr></table></figure>\n<p>这样让a和b的值分别是20和16</p>\n<p>一些特殊的变量名是_(下划线)。标示任何赋值给他的都会抛弃掉。<br>\n例如：</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">_,b :=<span class=\"number\">1</span>,<span class=\"number\">2</span></span><br></pre></td></tr></table></figure>\n<p>这样抛弃掉1 把b赋值为2.</p>\n<h3 id=\"数字类型number\"><a class=\"markdownIt-Anchor\" href=\"#数字类型number\"></a> 数字类型(Number)</h3>\n<p>数值类型有三种，一种是<code>整数类型</code>，另外一种是<code>浮点型</code>,<br>\n还有一种是<code>虚数类型</code>。正整数和零统称为: <code>无符号整型</code>,<br>\n而负整数称为: <code>有符号整型</code>。</p>\n<p>无符号类型能够表示正整数和零。而有符号类型除了能够表示正整数和零外，还可以表示负整数。</p>\n<p>另外还有一些别名类型，比如byte类型，这个类型和uint8是一样的，表示字节类型。另外一个是rune类型，这个类型和int32是一样的，用来表示unicode的代码点，就是unicode字符所对应的整数。</p>\n<p>Go还定义了三个依赖系统的类型，uint，int和uintptr。因为在32位系统和64位系统上用来表示这些类型的位数是不一样的。</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">对于<span class=\"number\">32</span>位系统</span><br><span class=\"line\"><span class=\"keyword\">uint</span>=<span class=\"keyword\">uint32</span></span><br><span class=\"line\"><span class=\"keyword\">int</span>=<span class=\"keyword\">int32</span></span><br><span class=\"line\"><span class=\"keyword\">uintptr</span>为<span class=\"number\">32</span>位的指针</span><br><span class=\"line\">对于<span class=\"number\">64</span>位系统</span><br><span class=\"line\"><span class=\"keyword\">uint</span>=<span class=\"keyword\">uint64</span></span><br><span class=\"line\"><span class=\"keyword\">int</span>=<span class=\"keyword\">int64</span></span><br><span class=\"line\"><span class=\"keyword\">uintptr</span>为<span class=\"number\">64</span>位的指针</span><br></pre></td></tr></table></figure>\n<p>至于类型后面跟的数字8，16，32或是64则表示用来表示这个类型的位不同，位越多，能表示的整数范围越大。</p>\n<p>比如对于用N位来表示的整数，如果是有符号的整数，能够表示的整数范围为-2^(N-1) ~ 2^(N-1)－1；如果是无符号的整数，则能表示的整数范围为0 ～ 2^(N-1)。</p>\n<p>Go的浮点数类型有两种，<code>float32</code>和<code>float64</code>。float32又叫单精度浮点型，float64又叫做双精度浮点型。其最主要的区别就是小数点后面能跟的小数位数不同.</p>\n<p>另外Go还有两个其他语言所没有的类型，虚数类型。complex64和complex128。</p>\n<p>对于数值类型，其所共有的操作为加法(＋)，减法(－)，乘法(＊)和除法(/)。另外对于整数类型，还定义了求余运算(%)</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> a <span class=\"keyword\">float64</span> = <span class=\"number\">12</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> b <span class=\"keyword\">float64</span> = <span class=\"number\">3</span></span><br><span class=\"line\"></span><br><span class=\"line\">    fmt.Println(a % b)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"架构设计图","date":"2016-04-21T09:51:31.000Z","_content":"\n今天抽点时间把产品架构图给画出来了。\n![产品架构图](hw_jg.png)\n\n","source":"_posts/hw-jg.md","raw":"---\ntitle: 架构设计图\ndate: 2016-04-21 17:51:31\ntags: 架构\n---\n\n今天抽点时间把产品架构图给画出来了。\n![产品架构图](hw_jg.png)\n\n","slug":"hw-jg","published":1,"updated":"2016-04-21T09:56:24.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot0g000lip9k58s6z47p","content":"<p>今天抽点时间把产品架构图给画出来了。<br>\n<img src=\"hw_jg.png\" alt=\"产品架构图\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>今天抽点时间把产品架构图给画出来了。<br>\n<img src=\"hw_jg.png\" alt=\"产品架构图\"></p>\n"},{"title":"创业公司入职3年小结","date":"2016-04-20T14:07:23.000Z","_content":"\n在创业公司3年多，学到了很多东西，也历练了很多，也见识了很多，后面会专门写几篇关于我在创业公司经历，大致从产品迭代开发，创业公司喜欢什么类型的人才，怎么在创业公司工作几个方面来介绍。本篇主要是入职3年小结\n#### 我们的产品在使用和用过那些技术\n- 服务器端：PHP语言\n- 数据库：MYSQL\n- 缓存  redis memcache\n- Android: Android原生\n- IOS: Object-c, Swift\n- PC: c# WPF MVVM\n- 流媒体： C,C++ SRS和自建RTMP-server,webRTC\n- 服务器：阿里云云服务 （20+台）\n- 云存储： 七牛\n- 第三方厂家：云信IM和短信，SendCloud（邮件）极光推送（消息）Openfire, bugtags,友盟，支付支付和微信支付\n- 后面想到在补充\n\n\n#### 入职的第一年\n2013年2-3月份开始着手做教育产品，往往产品模型和软件架构是密切相关的，第一年我们只做了Android Pad，是一个大而全的产品封闭性的产品。起初软硬件都打算做的，先从软件做起，那个时候开模没有100W都很难做。所以当时公司经理和技术总监决定从软件开始做起，做了仿launcher,里面可以嵌入自己的App,其他的厂家的App,类似一个Android Rom的一个东西。当时做了及时问和考试苑。那个时候我主要负责服务器端开发，负责服务器基础架构，技术选型，服务器端人员招聘等工作。说白了，就是一个主程序员。\n\n是否使用云服务器还是仔细斟酌考虑，采用自购服务器托管（当时主流），还是用云服务器。通过测试几家云服务器商（Ucloud,AWS,阿里云）,最终选择了阿里云，即使当时有很多对云服务器有很多谩骂声，但是针对我们小企业来说，云服务器是个不二的选择，至今我们都认为是正确的选择。这里还有个小插曲，我们在通宵测试对比Ucloud，那天晚上他们服务器正好升级，白忙活了。\n云存储MFS的年代，当时也测试对比又拍云和七牛还有阿里云的OSS存储。\n\n#### 入职第二年\n公司经理和技术总监离职，大股东进入，因为表现比较好，转升为技术总监。产品方向转向做移动App。还是以Android  Pad为主，实现双向互动。我们也从小的办公场地搬到一个大的办公场地，开始了招兵买马。陆陆续续 流媒体组，测试组，设计组也细化开来分成UI和UE。流媒体部分还从做监控行业找到一个从业10来年经验的一个同事（却为后面埋下祸根）。由8-9个研发团队翻了了一倍，15-16个\n这一年我们做了很多基础架构方面的事情，jenkins集成发布和测试，使用jenkins打包android。由原生git管理，迁移到gitlab，使用git flow 去管理。我也由ubuntu转成MAC平台开发。把云存储由阿里云OSS转向到七牛。（这个上周阿里云过来拜访来提到这个事情，起初对OSS不是很重视，出了很多问题）.那一年我们还完善了考试苑web端的开发，以及移动的考试苑api，和当时梯子网类似，同时还上了微课集模块，也已经在着手做教育云盘。\n这一年我们公司也做了几次大的活动，包括和一些其他公司合作共赢开发，资源互换等尝试。这一年我们又有一次深刻的通宵经历，全司通宵修改版本，为第二天发布会做准备。虽然很辛苦，但是还是很快乐。\n这一年我们还开始认识到手机应该是主流，同时要启动ios的开发。这一年结束之后不是很理想，陆续有人提出离职。也是这一年开始了解Docker方面的。\n\n#### 入职第三年\n\n这一年最苦的时候服务器端只剩下我一人，同年5月我们获得了中信证券，银河证券 A轮 3000W的融资，后期慢慢有把这个团队重新组建起来，在后来我就从服务器端退出来，交给一个PHP资深的同事负责（英语比国语说的好 在互联网10来年经验的人），这一年服务器端进行了一次架构升级，同年我们开始从内部选拔人员转做IOS开发，组建IOS组，从Android和流媒体组自愿转岗到IOS，有一个经验非常丰富的同时带领，也是我招聘进来最得意的一位同事，技术非常全面。也是天天动听比较早期的员工。经历过创业和在大公司是完全不同的人。\n流媒体也从原来的只支持Android，向全端支持，进行一次架构升级。Android端也进行了一次软件架构的升级。\n为了优化书写感知，同年8月我们启动PC版本的开发。B/S和C/S架构上面抉择，最终我们选择了C/S架构的PC端。主要是考虑到和第三方手写板兼容性更好，B/S架构还的需求写插件支持才可以。\n起初没有人会开发C/S或者我们在这个方面都没有经验，现在做WPF或者WCF的人少之又少，采用外包的方式。后面发现作为公司的产品外包是根本行不通，在产品不断的要进行修改，外包根本满足不了我们的需求。最后还的重新组建PC团队。补充流媒体团队的实力，流媒体中间件人员，主要做流媒体和M的对接工作。版本比较的多，测试人员我们也的扩充。研发团队扩展到目前团队23人。\n后面公司也收购了一个市场团队。专做市场推广。\n\n先写到这里吧\n\n\n","source":"_posts/ranyao-chuangye.md","raw":"---\ntitle: 创业公司入职3年小结\ndate: 2016-04-20 22:07:23\ntags:\n---\n\n在创业公司3年多，学到了很多东西，也历练了很多，也见识了很多，后面会专门写几篇关于我在创业公司经历，大致从产品迭代开发，创业公司喜欢什么类型的人才，怎么在创业公司工作几个方面来介绍。本篇主要是入职3年小结\n#### 我们的产品在使用和用过那些技术\n- 服务器端：PHP语言\n- 数据库：MYSQL\n- 缓存  redis memcache\n- Android: Android原生\n- IOS: Object-c, Swift\n- PC: c# WPF MVVM\n- 流媒体： C,C++ SRS和自建RTMP-server,webRTC\n- 服务器：阿里云云服务 （20+台）\n- 云存储： 七牛\n- 第三方厂家：云信IM和短信，SendCloud（邮件）极光推送（消息）Openfire, bugtags,友盟，支付支付和微信支付\n- 后面想到在补充\n\n\n#### 入职的第一年\n2013年2-3月份开始着手做教育产品，往往产品模型和软件架构是密切相关的，第一年我们只做了Android Pad，是一个大而全的产品封闭性的产品。起初软硬件都打算做的，先从软件做起，那个时候开模没有100W都很难做。所以当时公司经理和技术总监决定从软件开始做起，做了仿launcher,里面可以嵌入自己的App,其他的厂家的App,类似一个Android Rom的一个东西。当时做了及时问和考试苑。那个时候我主要负责服务器端开发，负责服务器基础架构，技术选型，服务器端人员招聘等工作。说白了，就是一个主程序员。\n\n是否使用云服务器还是仔细斟酌考虑，采用自购服务器托管（当时主流），还是用云服务器。通过测试几家云服务器商（Ucloud,AWS,阿里云）,最终选择了阿里云，即使当时有很多对云服务器有很多谩骂声，但是针对我们小企业来说，云服务器是个不二的选择，至今我们都认为是正确的选择。这里还有个小插曲，我们在通宵测试对比Ucloud，那天晚上他们服务器正好升级，白忙活了。\n云存储MFS的年代，当时也测试对比又拍云和七牛还有阿里云的OSS存储。\n\n#### 入职第二年\n公司经理和技术总监离职，大股东进入，因为表现比较好，转升为技术总监。产品方向转向做移动App。还是以Android  Pad为主，实现双向互动。我们也从小的办公场地搬到一个大的办公场地，开始了招兵买马。陆陆续续 流媒体组，测试组，设计组也细化开来分成UI和UE。流媒体部分还从做监控行业找到一个从业10来年经验的一个同事（却为后面埋下祸根）。由8-9个研发团队翻了了一倍，15-16个\n这一年我们做了很多基础架构方面的事情，jenkins集成发布和测试，使用jenkins打包android。由原生git管理，迁移到gitlab，使用git flow 去管理。我也由ubuntu转成MAC平台开发。把云存储由阿里云OSS转向到七牛。（这个上周阿里云过来拜访来提到这个事情，起初对OSS不是很重视，出了很多问题）.那一年我们还完善了考试苑web端的开发，以及移动的考试苑api，和当时梯子网类似，同时还上了微课集模块，也已经在着手做教育云盘。\n这一年我们公司也做了几次大的活动，包括和一些其他公司合作共赢开发，资源互换等尝试。这一年我们又有一次深刻的通宵经历，全司通宵修改版本，为第二天发布会做准备。虽然很辛苦，但是还是很快乐。\n这一年我们还开始认识到手机应该是主流，同时要启动ios的开发。这一年结束之后不是很理想，陆续有人提出离职。也是这一年开始了解Docker方面的。\n\n#### 入职第三年\n\n这一年最苦的时候服务器端只剩下我一人，同年5月我们获得了中信证券，银河证券 A轮 3000W的融资，后期慢慢有把这个团队重新组建起来，在后来我就从服务器端退出来，交给一个PHP资深的同事负责（英语比国语说的好 在互联网10来年经验的人），这一年服务器端进行了一次架构升级，同年我们开始从内部选拔人员转做IOS开发，组建IOS组，从Android和流媒体组自愿转岗到IOS，有一个经验非常丰富的同时带领，也是我招聘进来最得意的一位同事，技术非常全面。也是天天动听比较早期的员工。经历过创业和在大公司是完全不同的人。\n流媒体也从原来的只支持Android，向全端支持，进行一次架构升级。Android端也进行了一次软件架构的升级。\n为了优化书写感知，同年8月我们启动PC版本的开发。B/S和C/S架构上面抉择，最终我们选择了C/S架构的PC端。主要是考虑到和第三方手写板兼容性更好，B/S架构还的需求写插件支持才可以。\n起初没有人会开发C/S或者我们在这个方面都没有经验，现在做WPF或者WCF的人少之又少，采用外包的方式。后面发现作为公司的产品外包是根本行不通，在产品不断的要进行修改，外包根本满足不了我们的需求。最后还的重新组建PC团队。补充流媒体团队的实力，流媒体中间件人员，主要做流媒体和M的对接工作。版本比较的多，测试人员我们也的扩充。研发团队扩展到目前团队23人。\n后面公司也收购了一个市场团队。专做市场推广。\n\n先写到这里吧\n\n\n","slug":"ranyao-chuangye","published":1,"updated":"2016-04-20T16:35:29.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot0h000nip9klrzz16ya","content":"<p>在创业公司3年多，学到了很多东西，也历练了很多，也见识了很多，后面会专门写几篇关于我在创业公司经历，大致从产品迭代开发，创业公司喜欢什么类型的人才，怎么在创业公司工作几个方面来介绍。本篇主要是入职3年小结</p>\n<h4 id=\"我们的产品在使用和用过那些技术\"><a class=\"markdownIt-Anchor\" href=\"#我们的产品在使用和用过那些技术\"></a> 我们的产品在使用和用过那些技术</h4>\n<ul>\n<li>服务器端：PHP语言</li>\n<li>数据库：MYSQL</li>\n<li>缓存  redis memcache</li>\n<li>Android: Android原生</li>\n<li>IOS: Object-c, Swift</li>\n<li>PC: c# WPF MVVM</li>\n<li>流媒体： C,C++ SRS和自建RTMP-server,webRTC</li>\n<li>服务器：阿里云云服务 （20+台）</li>\n<li>云存储： 七牛</li>\n<li>第三方厂家：云信IM和短信，SendCloud（邮件）极光推送（消息）Openfire, bugtags,友盟，支付支付和微信支付</li>\n<li>后面想到在补充</li>\n</ul>\n<h4 id=\"入职的第一年\"><a class=\"markdownIt-Anchor\" href=\"#入职的第一年\"></a> 入职的第一年</h4>\n<p>2013年2-3月份开始着手做教育产品，往往产品模型和软件架构是密切相关的，第一年我们只做了Android Pad，是一个大而全的产品封闭性的产品。起初软硬件都打算做的，先从软件做起，那个时候开模没有100W都很难做。所以当时公司经理和技术总监决定从软件开始做起，做了仿launcher,里面可以嵌入自己的App,其他的厂家的App,类似一个Android Rom的一个东西。当时做了及时问和考试苑。那个时候我主要负责服务器端开发，负责服务器基础架构，技术选型，服务器端人员招聘等工作。说白了，就是一个主程序员。</p>\n<p>是否使用云服务器还是仔细斟酌考虑，采用自购服务器托管（当时主流），还是用云服务器。通过测试几家云服务器商（Ucloud,AWS,阿里云）,最终选择了阿里云，即使当时有很多对云服务器有很多谩骂声，但是针对我们小企业来说，云服务器是个不二的选择，至今我们都认为是正确的选择。这里还有个小插曲，我们在通宵测试对比Ucloud，那天晚上他们服务器正好升级，白忙活了。<br>\n云存储MFS的年代，当时也测试对比又拍云和七牛还有阿里云的OSS存储。</p>\n<h4 id=\"入职第二年\"><a class=\"markdownIt-Anchor\" href=\"#入职第二年\"></a> 入职第二年</h4>\n<p>公司经理和技术总监离职，大股东进入，因为表现比较好，转升为技术总监。产品方向转向做移动App。还是以Android  Pad为主，实现双向互动。我们也从小的办公场地搬到一个大的办公场地，开始了招兵买马。陆陆续续 流媒体组，测试组，设计组也细化开来分成UI和UE。流媒体部分还从做监控行业找到一个从业10来年经验的一个同事（却为后面埋下祸根）。由8-9个研发团队翻了了一倍，15-16个<br>\n这一年我们做了很多基础架构方面的事情，jenkins集成发布和测试，使用jenkins打包android。由原生git管理，迁移到gitlab，使用git flow 去管理。我也由ubuntu转成MAC平台开发。把云存储由阿里云OSS转向到七牛。（这个上周阿里云过来拜访来提到这个事情，起初对OSS不是很重视，出了很多问题）.那一年我们还完善了考试苑web端的开发，以及移动的考试苑api，和当时梯子网类似，同时还上了微课集模块，也已经在着手做教育云盘。<br>\n这一年我们公司也做了几次大的活动，包括和一些其他公司合作共赢开发，资源互换等尝试。这一年我们又有一次深刻的通宵经历，全司通宵修改版本，为第二天发布会做准备。虽然很辛苦，但是还是很快乐。<br>\n这一年我们还开始认识到手机应该是主流，同时要启动ios的开发。这一年结束之后不是很理想，陆续有人提出离职。也是这一年开始了解Docker方面的。</p>\n<h4 id=\"入职第三年\"><a class=\"markdownIt-Anchor\" href=\"#入职第三年\"></a> 入职第三年</h4>\n<p>这一年最苦的时候服务器端只剩下我一人，同年5月我们获得了中信证券，银河证券 A轮 3000W的融资，后期慢慢有把这个团队重新组建起来，在后来我就从服务器端退出来，交给一个PHP资深的同事负责（英语比国语说的好 在互联网10来年经验的人），这一年服务器端进行了一次架构升级，同年我们开始从内部选拔人员转做IOS开发，组建IOS组，从Android和流媒体组自愿转岗到IOS，有一个经验非常丰富的同时带领，也是我招聘进来最得意的一位同事，技术非常全面。也是天天动听比较早期的员工。经历过创业和在大公司是完全不同的人。<br>\n流媒体也从原来的只支持Android，向全端支持，进行一次架构升级。Android端也进行了一次软件架构的升级。<br>\n为了优化书写感知，同年8月我们启动PC版本的开发。B/S和C/S架构上面抉择，最终我们选择了C/S架构的PC端。主要是考虑到和第三方手写板兼容性更好，B/S架构还的需求写插件支持才可以。<br>\n起初没有人会开发C/S或者我们在这个方面都没有经验，现在做WPF或者WCF的人少之又少，采用外包的方式。后面发现作为公司的产品外包是根本行不通，在产品不断的要进行修改，外包根本满足不了我们的需求。最后还的重新组建PC团队。补充流媒体团队的实力，流媒体中间件人员，主要做流媒体和M的对接工作。版本比较的多，测试人员我们也的扩充。研发团队扩展到目前团队23人。<br>\n后面公司也收购了一个市场团队。专做市场推广。</p>\n<p>先写到这里吧</p>\n","site":{"data":{}},"excerpt":"","more":"<p>在创业公司3年多，学到了很多东西，也历练了很多，也见识了很多，后面会专门写几篇关于我在创业公司经历，大致从产品迭代开发，创业公司喜欢什么类型的人才，怎么在创业公司工作几个方面来介绍。本篇主要是入职3年小结</p>\n<h4 id=\"我们的产品在使用和用过那些技术\"><a class=\"markdownIt-Anchor\" href=\"#我们的产品在使用和用过那些技术\"></a> 我们的产品在使用和用过那些技术</h4>\n<ul>\n<li>服务器端：PHP语言</li>\n<li>数据库：MYSQL</li>\n<li>缓存  redis memcache</li>\n<li>Android: Android原生</li>\n<li>IOS: Object-c, Swift</li>\n<li>PC: c# WPF MVVM</li>\n<li>流媒体： C,C++ SRS和自建RTMP-server,webRTC</li>\n<li>服务器：阿里云云服务 （20+台）</li>\n<li>云存储： 七牛</li>\n<li>第三方厂家：云信IM和短信，SendCloud（邮件）极光推送（消息）Openfire, bugtags,友盟，支付支付和微信支付</li>\n<li>后面想到在补充</li>\n</ul>\n<h4 id=\"入职的第一年\"><a class=\"markdownIt-Anchor\" href=\"#入职的第一年\"></a> 入职的第一年</h4>\n<p>2013年2-3月份开始着手做教育产品，往往产品模型和软件架构是密切相关的，第一年我们只做了Android Pad，是一个大而全的产品封闭性的产品。起初软硬件都打算做的，先从软件做起，那个时候开模没有100W都很难做。所以当时公司经理和技术总监决定从软件开始做起，做了仿launcher,里面可以嵌入自己的App,其他的厂家的App,类似一个Android Rom的一个东西。当时做了及时问和考试苑。那个时候我主要负责服务器端开发，负责服务器基础架构，技术选型，服务器端人员招聘等工作。说白了，就是一个主程序员。</p>\n<p>是否使用云服务器还是仔细斟酌考虑，采用自购服务器托管（当时主流），还是用云服务器。通过测试几家云服务器商（Ucloud,AWS,阿里云）,最终选择了阿里云，即使当时有很多对云服务器有很多谩骂声，但是针对我们小企业来说，云服务器是个不二的选择，至今我们都认为是正确的选择。这里还有个小插曲，我们在通宵测试对比Ucloud，那天晚上他们服务器正好升级，白忙活了。<br>\n云存储MFS的年代，当时也测试对比又拍云和七牛还有阿里云的OSS存储。</p>\n<h4 id=\"入职第二年\"><a class=\"markdownIt-Anchor\" href=\"#入职第二年\"></a> 入职第二年</h4>\n<p>公司经理和技术总监离职，大股东进入，因为表现比较好，转升为技术总监。产品方向转向做移动App。还是以Android  Pad为主，实现双向互动。我们也从小的办公场地搬到一个大的办公场地，开始了招兵买马。陆陆续续 流媒体组，测试组，设计组也细化开来分成UI和UE。流媒体部分还从做监控行业找到一个从业10来年经验的一个同事（却为后面埋下祸根）。由8-9个研发团队翻了了一倍，15-16个<br>\n这一年我们做了很多基础架构方面的事情，jenkins集成发布和测试，使用jenkins打包android。由原生git管理，迁移到gitlab，使用git flow 去管理。我也由ubuntu转成MAC平台开发。把云存储由阿里云OSS转向到七牛。（这个上周阿里云过来拜访来提到这个事情，起初对OSS不是很重视，出了很多问题）.那一年我们还完善了考试苑web端的开发，以及移动的考试苑api，和当时梯子网类似，同时还上了微课集模块，也已经在着手做教育云盘。<br>\n这一年我们公司也做了几次大的活动，包括和一些其他公司合作共赢开发，资源互换等尝试。这一年我们又有一次深刻的通宵经历，全司通宵修改版本，为第二天发布会做准备。虽然很辛苦，但是还是很快乐。<br>\n这一年我们还开始认识到手机应该是主流，同时要启动ios的开发。这一年结束之后不是很理想，陆续有人提出离职。也是这一年开始了解Docker方面的。</p>\n<h4 id=\"入职第三年\"><a class=\"markdownIt-Anchor\" href=\"#入职第三年\"></a> 入职第三年</h4>\n<p>这一年最苦的时候服务器端只剩下我一人，同年5月我们获得了中信证券，银河证券 A轮 3000W的融资，后期慢慢有把这个团队重新组建起来，在后来我就从服务器端退出来，交给一个PHP资深的同事负责（英语比国语说的好 在互联网10来年经验的人），这一年服务器端进行了一次架构升级，同年我们开始从内部选拔人员转做IOS开发，组建IOS组，从Android和流媒体组自愿转岗到IOS，有一个经验非常丰富的同时带领，也是我招聘进来最得意的一位同事，技术非常全面。也是天天动听比较早期的员工。经历过创业和在大公司是完全不同的人。<br>\n流媒体也从原来的只支持Android，向全端支持，进行一次架构升级。Android端也进行了一次软件架构的升级。<br>\n为了优化书写感知，同年8月我们启动PC版本的开发。B/S和C/S架构上面抉择，最终我们选择了C/S架构的PC端。主要是考虑到和第三方手写板兼容性更好，B/S架构还的需求写插件支持才可以。<br>\n起初没有人会开发C/S或者我们在这个方面都没有经验，现在做WPF或者WCF的人少之又少，采用外包的方式。后面发现作为公司的产品外包是根本行不通，在产品不断的要进行修改，外包根本满足不了我们的需求。最后还的重新组建PC团队。补充流媒体团队的实力，流媒体中间件人员，主要做流媒体和M的对接工作。版本比较的多，测试人员我们也的扩充。研发团队扩展到目前团队23人。<br>\n后面公司也收购了一个市场团队。专做市场推广。</p>\n<p>先写到这里吧</p>\n"},{"title":"用swoole TCP Server 和mongodb做数据备份和恢复","date":"2016-05-18T10:52:40.000Z","_content":"\n应用场景是，单个用户写的数据是8-10条/S JSON数据包\n\n采用架构如下图所示：\n![架构图](Swoole-Mongo.png)\n\n采用的是\n\n- php7.0.6\n- swoole-1.8.5版本\n- php扩展mongodb1.1.6  而目前mongo-1.6.14不支持php7 这样导致连接Mongo函数不一样，后面会讲到。\n- 服务器 Ubuntu 14.04 64位 2核 4G\n- 阿里云的Mongodb服务器\n\n到目前阿里云Mongodb还不支持sharding,后续会进行支持。目前是使用双节点。摘录[MongoDB杭州用户交流会](https://yq.aliyun.com/articles/7557)的一段话:\n\n>阿里云目前已提供对MongoDB复制集（Replica Set）的支持，默认会为用户创建包含3个数据节点的复制集，其中一个Primary、一个Secondary，以及一个Hidden节点。Primary、Secondary对用户可见，用户可以自定义ReadPreference，Hidden节点对用户不可见，目前主要用于实例数据备份以及自动的failover，当有Primary或Secondary节点挂掉时，Hidden会被自动切换为Secondary，保证用户的服务不受影响。\n\n### mongodb服务器\n阿里云服务器目前只支持ECS访问不支持外网方面\n\n- [公网连接mongodb windows篇](https://help.aliyun.com/knowledge_detail/13052608.html#通过公网连接云数据库MongoDB--ECS Windows篇)\n\n- [公网连接mongodb linux篇](https://help.aliyun.com/knowledge_detail/13052572.html#通过公网连接云数据库MongoDB--ECS Linux篇)\n\n用如下命令检测是否连上mongodb\n\n- ping  dds-xxxxxxxx.mongodb.rds.aliyuncs.com\n- telnet  dds-xxxxxxxxxxxx.mongodb.rds.aliyuncs.com 3717\n- mongo --host dds-xxxxxxxxxxxxx1.mongodb.rds.aliyuncs.com:3717 --authenticationDatabase admin -u root -p\n- mongo --host dds-xxxxxxxxxxxxxx2.mongodb.rds.aliyuncs.com:3717 --authenticationDatabase admin -u root -p\n\n如果本身server服务器用的ECS，还是要设置一下，\n\n### 搭建TCP-SEVER服务器\n\n1. 买好服务器之后习惯性的把服务器服务升级到最新。（这个是强迫症）\n\n```\n$ apt-get update \n\n$ apt-get upgrade\n```\n\n2. 安装最新的php7.0.6环境\n\n```powershell\napt-get install python-software-properties\n\napt-get install software-properties-common\n\nLC_ALL=C.UTF-8 add-apt-repository ppa:ondrej/php\n\napt-get update\n\napt-cache show php7.0-dev  \n\n\n\nPackage: php7.0-dev\nSource: php7.0\nPriority: optional\nSection: php\nInstalled-Size: 4658\nMaintainer: Debian PHP Maintainers <pkg-php-maint@lists.alioth.debian.org>\nArchitecture: amd64\nVersion: 7.0.6-12+donate.sury.org~trusty+1\nRecommends: dh-php, pkg-php-tools\nDepends: autoconf (>= 2.63), automake (>= 1.11), libpcre3-dev, libssl-dev, php7.0-cli (>= 7.0.6-12+donate.sury.org~trusty+1), php7.0-common (= 7.0.6-12+donate.sury.org~trusty+1), shtool, libtool\nFilename: pool/main/p/php7.0/php7.0-dev_7.0.6-12+donate.sury.org~trusty+1_amd64.deb\nSize: 505784\nMD5sum: bb75fadf2fc0bae22d7a26999b9ac0e2\nSHA1: a85e13a259faae1377813d7b1e5c344c8ede8d09\nSHA256: 79617d3b79e054129a2e980534885ab794ec18c5052894e71d1da37ec07b2aff\nDescription-en: Files for PHP7.0 module development\n This package provides the files from the PHP7.0 source needed for compiling\n additional modules.\n\nPHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used\n open source general-purpose scripting language that is especially suited\n for web development and can be embedded into HTML.\nDescription-md5: cab4eaaf141b1f52bc2814eea2492ab2\n\napt-get install php7.0-dev\n```\n\n3. 安装mongo扩展 和swoole扩展\n\n```\n使用pecl进行安装mongo和swoole扩展。\n这里记住是mongodb扩展不是mongo扩展。这两个扩展在使用上面不一样，后面会讲到。这里我们安装\nmongodb\n\n搜索mongodb\n$ pecl search mongo\n\n\npecl库更新到最新\n$ pecl channel-update pecl.php.net\n\n安装mongodb\n$ pecl install mongodb\n\n问题：\n1. 这里如果安装mongo会提示不支持Php7.0以上版本：\n\tpecl/mongo requires PHP (version >= 5.3.0, version <= 5.99.99),\n\tinstalled version is 7.0.6-12+donate.sury.org~trusty+1\n2. configure: error: Cannot find OpenSSL's libraries\n\t 解决方法：  ln -s /usr/lib/x86_64-linux-gnu/libssl.so  /usr/lib\n\n\n安装swoole\n$ pecl install swoole\n\n查找php.ini 把swoole.so和mongodb加入进去\n$ php --ini  \n\n$ php -ri|grep swoole\n\n```\n\n4. PHP swoole代码\n\n```php\n$serv = new swoole_server(\"0.0.0.0\", 9501);\n\n$serv->set(array(\n\t'worker_num' => 8, //工作进程数量\n\t'daemonize' => false, //是否作为守护进程\n));\n\n$serv->on('connect', function ($serv, $fd) {\n\techo \"Client:Connect.\\n\";\n});\n\n$serv->on('receive', function ($serv,$fd, $from_id, $data) {\n\t\n\t$arr = json_decode($data);\n\t\n\t//$array=array('column_name'=>'col'.rand(100,999),'column_exp'=>'xiaocai');\n\t$connection = new MongoClient(\"mongodb://root:密码@主机ID1.mongodb.rds.aliyuncs.com:3717,主机2.mongodb.rds.aliyuncs.com:3717/admin?replicaSet=副本集名称\");\n\t//\t$connection = new MongoClient(\"mongodb://localhost:27017\");\n\tvar_dump($connection);\n\t$roomid = \"roomid\".'_123';\n\t$collection = $connection->test->$roomid;\n\t$collection->insert($arr);\n\t\n\t$document = $collection->findOne();\n\tvar_dump($document);\n\t\n\t$serv->send($fd, 'Swoole: ' . $data);\n\t$serv->close($fd);\n});\n\n$serv->on('close', function ($serv, $fd) {\n\techo \"Client: Close.\\n\";\n});\n\n$serv->start();\n\n```\n如果执行上面的代码的话，会报`PHP Fatal error:  Uncaught Error: Class 'MongoClient' not found`\n这里要说明一下MongoClient是扩展Mongo的内置函数。\n可以通过\n\n```php\nprint_r(get_declared_classes());\n```\n查看函数列表\nMongo的函数列表\n\n```\n    [156] => MongoClient\n    [157] => Mongo\n    [158] => MongoDB\n    [159] => MongoCollection\n    [160] => MongoCursor\n    [161] => MongoCommandCursor\n    [162] => MongoGridFS\n    [163] => MongoGridFSFile\n    [164] => MongoGridFSCursor\n    [165] => MongoWriteBatch\n    [166] => MongoInsertBatch\n    [167] => MongoUpdateBatch\n    [168] => MongoDeleteBatch\n    [169] => MongoId\n    [170] => MongoCode\n    [171] => MongoRegex\n    [172] => MongoDate\n    [173] => MongoBinData\n    [174] => MongoDBRef\n    [175] => MongoException\n    [176] => MongoConnectionException\n    [177] => MongoCursorException\n    [178] => MongoCursorTimeoutException\n    [179] => MongoGridFSException\n    [180] => MongoResultException\n    [181] => MongoWriteConcernException\n    [182] => MongoDuplicateKeyException\n    [183] => MongoExecutionTimeoutException\n    [184] => MongoProtocolException\n    [185] => MongoTimestamp\n    [186] => MongoInt32\n    [187] => MongoInt64\n    [188] => MongoLog\n    [189] => MongoPool\n    [190] => MongoMaxKey\n    [191] => MongoMinKey\n```\n\nMongodb的函数列表\n\n```\n\t[100] => MongoDB\\Driver\\Command\n    [101] => MongoDB\\Driver\\Cursor\n    [102] => MongoDB\\Driver\\CursorId\n    [103] => MongoDB\\Driver\\Manager\n    [104] => MongoDB\\Driver\\Query\n    [105] => MongoDB\\Driver\\ReadConcern\n    [106] => MongoDB\\Driver\\ReadPreference\n    [107] => MongoDB\\Driver\\Server\n    [108] => MongoDB\\Driver\\BulkWrite\n    [109] => MongoDB\\Driver\\WriteConcern\n    [110] => MongoDB\\Driver\\WriteConcernError\n    [111] => MongoDB\\Driver\\WriteError\n    [112] => MongoDB\\Driver\\WriteResult\n    [113] => MongoDB\\Driver\\Exception\\LogicException\n    [114] => MongoDB\\Driver\\Exception\\RuntimeException\n    [115] => MongoDB\\Driver\\Exception\\UnexpectedValueException\n    [116] => MongoDB\\Driver\\Exception\\InvalidArgumentException\n    [117] => MongoDB\\Driver\\Exception\\ConnectionException\n    [118] => MongoDB\\Driver\\Exception\\AuthenticationException\n    [119] => MongoDB\\Driver\\Exception\\SSLConnectionException\n    [120] => MongoDB\\Driver\\Exception\\WriteException\n    [121] => MongoDB\\Driver\\Exception\\BulkWriteException\n    [122] => MongoDB\\Driver\\Exception\\ExecutionTimeoutException\n    [123] => MongoDB\\Driver\\Exception\\ConnectionTimeoutException\n    [124] => MongoDB\\BSON\\Binary\n    [125] => MongoDB\\BSON\\Javascript\n    [126] => MongoDB\\BSON\\MaxKey\n    [127] => MongoDB\\BSON\\MinKey\n    [128] => MongoDB\\BSON\\ObjectID\n    [129] => MongoDB\\BSON\\Regex\n    [130] => MongoDB\\BSON\\Timestamp\n    [131] => MongoDB\\BSON\\UTCDateTime\n```\n所以要使用Php7.0以上版本需要重新写连接mongdo的数据库\n查找php文档[Mongodb driver](http://php.net/manual/zh/set.mongodb.php)\n\n修改成为mongodb的一个demo\t连接修改代码如下：\n\n```php\n$serv = new swoole_server(\"0.0.0.0\", 9501);\n\n$serv->set(array(\n\t'worker_num' => 8, //工作进程数量\n\t'daemonize' => false, //是否作为守护进程\n));\n\n$serv->on('connect', function ($serv, $fd) {\n\techo \"Client:Connect.\\n\";\n});\n\n$serv->on('receive', function ($serv, $fd, $from_id, $data) {\n\t\n\t$arr = json_decode($data);\n\t\n\t$bulk = new MongoDB\\Driver\\BulkWrite(['ordered' => true]);\n\t\n\t$bulk->insert($arr);\n\t\n\t$connection = new MongoDB\\Driver\\Manager(\"mongodb://localhost:27017\");\n\t\n\ttry {\n\t\n\t\t$result = $connection->executeBulkWrite('test.roomid', $bulk);\n\t\n\t} catch (MongoDB\\Driver\\Exception\\BulkWriteException $e) {\n\t\t\n\t\t\t$result = $e->getWriteResult();\n\t\n\t\t\tif ($writeConcernError = $result->getWriteConcernError()) {\n\t\t\t\tprintf(\"%s (%d): %s\\n\",\t$writeConcernError->getMessage(),\n\t\t\t\t$writeConcernError->getCode(),\n\t\t\t\tvar_export($writeConcernError->getInfo(), true));\n\t\t\t}\n\t\t\t// Check if any write operations did not complete at all\n\t\t\tforeach ($result->getWriteErrors() as $writeError) {\n\t\t\t\tprintf(\"Operation#%d: %s (%d)\\n\",\n\t\t\t\t$writeError->getIndex(),\n\t\t\t\t$writeError->getMessage(),\n\t\t\t\t$writeError->getCode()\n\t\t\t);\n\t\t}\n\t} catch (MongoDB\\Driver\\Exception\\Exception $e) {\n\tprintf(\"Other error: %s\\n\", $e->getMessage());\n\texit;\n}\n\t\n\tprintf(\"Inserted %d document(s)\\n\",$result->getInsertedCount());\n\tprintf(\"Updated  %d document(s)\\n\",$result->getModifiedCount());\n\t\n\t$serv->send($fd, 'Swoole: ' . $data);\n\t\n\t$serv->close($fd);\n});\n\n$serv->on('close', function ($serv, $fd) {\n\n\techo \"Client: Close.\\n\";\n\t\n});\n\n$serv->start(); \n```\n模拟请求数据\n\n```\nnetcat 127.0.0.1 9501\n```\n\nEND\n\n","source":"_posts/mongo-php-error.md","raw":"---\ntitle: 用swoole TCP Server 和mongodb做数据备份和恢复\ndate: 2016-05-18 18:52:40\ntags: [mongo,php-mongo,swoole,tcp]\n---\n\n应用场景是，单个用户写的数据是8-10条/S JSON数据包\n\n采用架构如下图所示：\n![架构图](Swoole-Mongo.png)\n\n采用的是\n\n- php7.0.6\n- swoole-1.8.5版本\n- php扩展mongodb1.1.6  而目前mongo-1.6.14不支持php7 这样导致连接Mongo函数不一样，后面会讲到。\n- 服务器 Ubuntu 14.04 64位 2核 4G\n- 阿里云的Mongodb服务器\n\n到目前阿里云Mongodb还不支持sharding,后续会进行支持。目前是使用双节点。摘录[MongoDB杭州用户交流会](https://yq.aliyun.com/articles/7557)的一段话:\n\n>阿里云目前已提供对MongoDB复制集（Replica Set）的支持，默认会为用户创建包含3个数据节点的复制集，其中一个Primary、一个Secondary，以及一个Hidden节点。Primary、Secondary对用户可见，用户可以自定义ReadPreference，Hidden节点对用户不可见，目前主要用于实例数据备份以及自动的failover，当有Primary或Secondary节点挂掉时，Hidden会被自动切换为Secondary，保证用户的服务不受影响。\n\n### mongodb服务器\n阿里云服务器目前只支持ECS访问不支持外网方面\n\n- [公网连接mongodb windows篇](https://help.aliyun.com/knowledge_detail/13052608.html#通过公网连接云数据库MongoDB--ECS Windows篇)\n\n- [公网连接mongodb linux篇](https://help.aliyun.com/knowledge_detail/13052572.html#通过公网连接云数据库MongoDB--ECS Linux篇)\n\n用如下命令检测是否连上mongodb\n\n- ping  dds-xxxxxxxx.mongodb.rds.aliyuncs.com\n- telnet  dds-xxxxxxxxxxxx.mongodb.rds.aliyuncs.com 3717\n- mongo --host dds-xxxxxxxxxxxxx1.mongodb.rds.aliyuncs.com:3717 --authenticationDatabase admin -u root -p\n- mongo --host dds-xxxxxxxxxxxxxx2.mongodb.rds.aliyuncs.com:3717 --authenticationDatabase admin -u root -p\n\n如果本身server服务器用的ECS，还是要设置一下，\n\n### 搭建TCP-SEVER服务器\n\n1. 买好服务器之后习惯性的把服务器服务升级到最新。（这个是强迫症）\n\n```\n$ apt-get update \n\n$ apt-get upgrade\n```\n\n2. 安装最新的php7.0.6环境\n\n```powershell\napt-get install python-software-properties\n\napt-get install software-properties-common\n\nLC_ALL=C.UTF-8 add-apt-repository ppa:ondrej/php\n\napt-get update\n\napt-cache show php7.0-dev  \n\n\n\nPackage: php7.0-dev\nSource: php7.0\nPriority: optional\nSection: php\nInstalled-Size: 4658\nMaintainer: Debian PHP Maintainers <pkg-php-maint@lists.alioth.debian.org>\nArchitecture: amd64\nVersion: 7.0.6-12+donate.sury.org~trusty+1\nRecommends: dh-php, pkg-php-tools\nDepends: autoconf (>= 2.63), automake (>= 1.11), libpcre3-dev, libssl-dev, php7.0-cli (>= 7.0.6-12+donate.sury.org~trusty+1), php7.0-common (= 7.0.6-12+donate.sury.org~trusty+1), shtool, libtool\nFilename: pool/main/p/php7.0/php7.0-dev_7.0.6-12+donate.sury.org~trusty+1_amd64.deb\nSize: 505784\nMD5sum: bb75fadf2fc0bae22d7a26999b9ac0e2\nSHA1: a85e13a259faae1377813d7b1e5c344c8ede8d09\nSHA256: 79617d3b79e054129a2e980534885ab794ec18c5052894e71d1da37ec07b2aff\nDescription-en: Files for PHP7.0 module development\n This package provides the files from the PHP7.0 source needed for compiling\n additional modules.\n\nPHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used\n open source general-purpose scripting language that is especially suited\n for web development and can be embedded into HTML.\nDescription-md5: cab4eaaf141b1f52bc2814eea2492ab2\n\napt-get install php7.0-dev\n```\n\n3. 安装mongo扩展 和swoole扩展\n\n```\n使用pecl进行安装mongo和swoole扩展。\n这里记住是mongodb扩展不是mongo扩展。这两个扩展在使用上面不一样，后面会讲到。这里我们安装\nmongodb\n\n搜索mongodb\n$ pecl search mongo\n\n\npecl库更新到最新\n$ pecl channel-update pecl.php.net\n\n安装mongodb\n$ pecl install mongodb\n\n问题：\n1. 这里如果安装mongo会提示不支持Php7.0以上版本：\n\tpecl/mongo requires PHP (version >= 5.3.0, version <= 5.99.99),\n\tinstalled version is 7.0.6-12+donate.sury.org~trusty+1\n2. configure: error: Cannot find OpenSSL's libraries\n\t 解决方法：  ln -s /usr/lib/x86_64-linux-gnu/libssl.so  /usr/lib\n\n\n安装swoole\n$ pecl install swoole\n\n查找php.ini 把swoole.so和mongodb加入进去\n$ php --ini  \n\n$ php -ri|grep swoole\n\n```\n\n4. PHP swoole代码\n\n```php\n$serv = new swoole_server(\"0.0.0.0\", 9501);\n\n$serv->set(array(\n\t'worker_num' => 8, //工作进程数量\n\t'daemonize' => false, //是否作为守护进程\n));\n\n$serv->on('connect', function ($serv, $fd) {\n\techo \"Client:Connect.\\n\";\n});\n\n$serv->on('receive', function ($serv,$fd, $from_id, $data) {\n\t\n\t$arr = json_decode($data);\n\t\n\t//$array=array('column_name'=>'col'.rand(100,999),'column_exp'=>'xiaocai');\n\t$connection = new MongoClient(\"mongodb://root:密码@主机ID1.mongodb.rds.aliyuncs.com:3717,主机2.mongodb.rds.aliyuncs.com:3717/admin?replicaSet=副本集名称\");\n\t//\t$connection = new MongoClient(\"mongodb://localhost:27017\");\n\tvar_dump($connection);\n\t$roomid = \"roomid\".'_123';\n\t$collection = $connection->test->$roomid;\n\t$collection->insert($arr);\n\t\n\t$document = $collection->findOne();\n\tvar_dump($document);\n\t\n\t$serv->send($fd, 'Swoole: ' . $data);\n\t$serv->close($fd);\n});\n\n$serv->on('close', function ($serv, $fd) {\n\techo \"Client: Close.\\n\";\n});\n\n$serv->start();\n\n```\n如果执行上面的代码的话，会报`PHP Fatal error:  Uncaught Error: Class 'MongoClient' not found`\n这里要说明一下MongoClient是扩展Mongo的内置函数。\n可以通过\n\n```php\nprint_r(get_declared_classes());\n```\n查看函数列表\nMongo的函数列表\n\n```\n    [156] => MongoClient\n    [157] => Mongo\n    [158] => MongoDB\n    [159] => MongoCollection\n    [160] => MongoCursor\n    [161] => MongoCommandCursor\n    [162] => MongoGridFS\n    [163] => MongoGridFSFile\n    [164] => MongoGridFSCursor\n    [165] => MongoWriteBatch\n    [166] => MongoInsertBatch\n    [167] => MongoUpdateBatch\n    [168] => MongoDeleteBatch\n    [169] => MongoId\n    [170] => MongoCode\n    [171] => MongoRegex\n    [172] => MongoDate\n    [173] => MongoBinData\n    [174] => MongoDBRef\n    [175] => MongoException\n    [176] => MongoConnectionException\n    [177] => MongoCursorException\n    [178] => MongoCursorTimeoutException\n    [179] => MongoGridFSException\n    [180] => MongoResultException\n    [181] => MongoWriteConcernException\n    [182] => MongoDuplicateKeyException\n    [183] => MongoExecutionTimeoutException\n    [184] => MongoProtocolException\n    [185] => MongoTimestamp\n    [186] => MongoInt32\n    [187] => MongoInt64\n    [188] => MongoLog\n    [189] => MongoPool\n    [190] => MongoMaxKey\n    [191] => MongoMinKey\n```\n\nMongodb的函数列表\n\n```\n\t[100] => MongoDB\\Driver\\Command\n    [101] => MongoDB\\Driver\\Cursor\n    [102] => MongoDB\\Driver\\CursorId\n    [103] => MongoDB\\Driver\\Manager\n    [104] => MongoDB\\Driver\\Query\n    [105] => MongoDB\\Driver\\ReadConcern\n    [106] => MongoDB\\Driver\\ReadPreference\n    [107] => MongoDB\\Driver\\Server\n    [108] => MongoDB\\Driver\\BulkWrite\n    [109] => MongoDB\\Driver\\WriteConcern\n    [110] => MongoDB\\Driver\\WriteConcernError\n    [111] => MongoDB\\Driver\\WriteError\n    [112] => MongoDB\\Driver\\WriteResult\n    [113] => MongoDB\\Driver\\Exception\\LogicException\n    [114] => MongoDB\\Driver\\Exception\\RuntimeException\n    [115] => MongoDB\\Driver\\Exception\\UnexpectedValueException\n    [116] => MongoDB\\Driver\\Exception\\InvalidArgumentException\n    [117] => MongoDB\\Driver\\Exception\\ConnectionException\n    [118] => MongoDB\\Driver\\Exception\\AuthenticationException\n    [119] => MongoDB\\Driver\\Exception\\SSLConnectionException\n    [120] => MongoDB\\Driver\\Exception\\WriteException\n    [121] => MongoDB\\Driver\\Exception\\BulkWriteException\n    [122] => MongoDB\\Driver\\Exception\\ExecutionTimeoutException\n    [123] => MongoDB\\Driver\\Exception\\ConnectionTimeoutException\n    [124] => MongoDB\\BSON\\Binary\n    [125] => MongoDB\\BSON\\Javascript\n    [126] => MongoDB\\BSON\\MaxKey\n    [127] => MongoDB\\BSON\\MinKey\n    [128] => MongoDB\\BSON\\ObjectID\n    [129] => MongoDB\\BSON\\Regex\n    [130] => MongoDB\\BSON\\Timestamp\n    [131] => MongoDB\\BSON\\UTCDateTime\n```\n所以要使用Php7.0以上版本需要重新写连接mongdo的数据库\n查找php文档[Mongodb driver](http://php.net/manual/zh/set.mongodb.php)\n\n修改成为mongodb的一个demo\t连接修改代码如下：\n\n```php\n$serv = new swoole_server(\"0.0.0.0\", 9501);\n\n$serv->set(array(\n\t'worker_num' => 8, //工作进程数量\n\t'daemonize' => false, //是否作为守护进程\n));\n\n$serv->on('connect', function ($serv, $fd) {\n\techo \"Client:Connect.\\n\";\n});\n\n$serv->on('receive', function ($serv, $fd, $from_id, $data) {\n\t\n\t$arr = json_decode($data);\n\t\n\t$bulk = new MongoDB\\Driver\\BulkWrite(['ordered' => true]);\n\t\n\t$bulk->insert($arr);\n\t\n\t$connection = new MongoDB\\Driver\\Manager(\"mongodb://localhost:27017\");\n\t\n\ttry {\n\t\n\t\t$result = $connection->executeBulkWrite('test.roomid', $bulk);\n\t\n\t} catch (MongoDB\\Driver\\Exception\\BulkWriteException $e) {\n\t\t\n\t\t\t$result = $e->getWriteResult();\n\t\n\t\t\tif ($writeConcernError = $result->getWriteConcernError()) {\n\t\t\t\tprintf(\"%s (%d): %s\\n\",\t$writeConcernError->getMessage(),\n\t\t\t\t$writeConcernError->getCode(),\n\t\t\t\tvar_export($writeConcernError->getInfo(), true));\n\t\t\t}\n\t\t\t// Check if any write operations did not complete at all\n\t\t\tforeach ($result->getWriteErrors() as $writeError) {\n\t\t\t\tprintf(\"Operation#%d: %s (%d)\\n\",\n\t\t\t\t$writeError->getIndex(),\n\t\t\t\t$writeError->getMessage(),\n\t\t\t\t$writeError->getCode()\n\t\t\t);\n\t\t}\n\t} catch (MongoDB\\Driver\\Exception\\Exception $e) {\n\tprintf(\"Other error: %s\\n\", $e->getMessage());\n\texit;\n}\n\t\n\tprintf(\"Inserted %d document(s)\\n\",$result->getInsertedCount());\n\tprintf(\"Updated  %d document(s)\\n\",$result->getModifiedCount());\n\t\n\t$serv->send($fd, 'Swoole: ' . $data);\n\t\n\t$serv->close($fd);\n});\n\n$serv->on('close', function ($serv, $fd) {\n\n\techo \"Client: Close.\\n\";\n\t\n});\n\n$serv->start(); \n```\n模拟请求数据\n\n```\nnetcat 127.0.0.1 9501\n```\n\nEND\n\n","slug":"mongo-php-error","published":1,"updated":"2017-04-28T07:52:56.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot0i000pip9kt96e336p","content":"<p>应用场景是，单个用户写的数据是8-10条/S JSON数据包</p>\n<p>采用架构如下图所示：<br>\n<img src=\"Swoole-Mongo.png\" alt=\"架构图\"></p>\n<p>采用的是</p>\n<ul>\n<li>php7.0.6</li>\n<li>swoole-1.8.5版本</li>\n<li>php扩展mongodb1.1.6  而目前mongo-1.6.14不支持php7 这样导致连接Mongo函数不一样，后面会讲到。</li>\n<li>服务器 Ubuntu 14.04 64位 2核 4G</li>\n<li>阿里云的Mongodb服务器</li>\n</ul>\n<p>到目前阿里云Mongodb还不支持sharding,后续会进行支持。目前是使用双节点。摘录<a href=\"https://yq.aliyun.com/articles/7557\" target=\"_blank\" rel=\"noopener\">MongoDB杭州用户交流会</a>的一段话:</p>\n<blockquote>\n<p>阿里云目前已提供对MongoDB复制集（Replica Set）的支持，默认会为用户创建包含3个数据节点的复制集，其中一个Primary、一个Secondary，以及一个Hidden节点。Primary、Secondary对用户可见，用户可以自定义ReadPreference，Hidden节点对用户不可见，目前主要用于实例数据备份以及自动的failover，当有Primary或Secondary节点挂掉时，Hidden会被自动切换为Secondary，保证用户的服务不受影响。</p>\n</blockquote>\n<h3 id=\"mongodb服务器\"><a class=\"markdownIt-Anchor\" href=\"#mongodb服务器\"></a> mongodb服务器</h3>\n<p>阿里云服务器目前只支持ECS访问不支持外网方面</p>\n<ul>\n<li>\n<p>[公网连接mongodb windows篇](<a href=\"https://help.aliyun.com/knowledge_detail/13052608.html#%E9%80%9A%E8%BF%87%E5%85%AC%E7%BD%91%E8%BF%9E%E6%8E%A5%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93MongoDB--ECS\" target=\"_blank\" rel=\"noopener\">https://help.aliyun.com/knowledge_detail/13052608.html#通过公网连接云数据库MongoDB--ECS</a> Windows篇)</p>\n</li>\n<li>\n<p>[公网连接mongodb linux篇](<a href=\"https://help.aliyun.com/knowledge_detail/13052572.html#%E9%80%9A%E8%BF%87%E5%85%AC%E7%BD%91%E8%BF%9E%E6%8E%A5%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93MongoDB--ECS\" target=\"_blank\" rel=\"noopener\">https://help.aliyun.com/knowledge_detail/13052572.html#通过公网连接云数据库MongoDB--ECS</a> Linux篇)</p>\n</li>\n</ul>\n<p>用如下命令检测是否连上mongodb</p>\n<ul>\n<li>ping  <a href=\"http://dds-xxxxxxxx.mongodb.rds.aliyuncs.com\" target=\"_blank\" rel=\"noopener\">dds-xxxxxxxx.mongodb.rds.aliyuncs.com</a></li>\n<li>telnet  <a href=\"http://dds-xxxxxxxxxxxx.mongodb.rds.aliyuncs.com\" target=\"_blank\" rel=\"noopener\">dds-xxxxxxxxxxxx.mongodb.rds.aliyuncs.com</a> 3717</li>\n<li>mongo --host <a href=\"http://dds-xxxxxxxxxxxxx1.mongodb.rds.aliyuncs.com:3717\" target=\"_blank\" rel=\"noopener\">dds-xxxxxxxxxxxxx1.mongodb.rds.aliyuncs.com:3717</a> --authenticationDatabase admin -u root -p</li>\n<li>mongo --host <a href=\"http://dds-xxxxxxxxxxxxxx2.mongodb.rds.aliyuncs.com:3717\" target=\"_blank\" rel=\"noopener\">dds-xxxxxxxxxxxxxx2.mongodb.rds.aliyuncs.com:3717</a> --authenticationDatabase admin -u root -p</li>\n</ul>\n<p>如果本身server服务器用的ECS，还是要设置一下，</p>\n<h3 id=\"搭建tcp-sever服务器\"><a class=\"markdownIt-Anchor\" href=\"#搭建tcp-sever服务器\"></a> 搭建TCP-SEVER服务器</h3>\n<ol>\n<li>买好服务器之后习惯性的把服务器服务升级到最新。（这个是强迫症）</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ apt-get update </span><br><span class=\"line\"></span><br><span class=\"line\">$ apt-get upgrade</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>安装最新的php7.0.6环境</li>\n</ol>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt<span class=\"literal\">-get</span> install python<span class=\"literal\">-software</span><span class=\"literal\">-properties</span></span><br><span class=\"line\"></span><br><span class=\"line\">apt<span class=\"literal\">-get</span> install software<span class=\"literal\">-properties</span><span class=\"literal\">-common</span></span><br><span class=\"line\"></span><br><span class=\"line\">LC_ALL=C.UTF<span class=\"literal\">-8</span> <span class=\"built_in\">add-apt</span><span class=\"literal\">-repository</span> ppa:ondrej/php</span><br><span class=\"line\"></span><br><span class=\"line\">apt<span class=\"literal\">-get</span> update</span><br><span class=\"line\"></span><br><span class=\"line\">apt<span class=\"literal\">-cache</span> show php7.<span class=\"number\">0</span><span class=\"literal\">-dev</span>  </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">Package: php7.<span class=\"number\">0</span><span class=\"literal\">-dev</span></span><br><span class=\"line\">Source: php7.<span class=\"number\">0</span></span><br><span class=\"line\">Priority: optional</span><br><span class=\"line\">Section: php</span><br><span class=\"line\">Installed<span class=\"literal\">-Size</span>: <span class=\"number\">4658</span></span><br><span class=\"line\">Maintainer: Debian PHP Maintainers &lt;pkg<span class=\"literal\">-php</span><span class=\"literal\">-maint</span>@lists.alioth.debian.org&gt;</span><br><span class=\"line\">Architecture: amd64</span><br><span class=\"line\">Version: <span class=\"number\">7.0</span>.<span class=\"number\">6</span><span class=\"literal\">-12</span>+donate.sury.org~trusty+<span class=\"number\">1</span></span><br><span class=\"line\">Recommends: dh<span class=\"literal\">-php</span>, pkg<span class=\"literal\">-php</span><span class=\"literal\">-tools</span></span><br><span class=\"line\">Depends: autoconf (&gt;= <span class=\"number\">2.63</span>), automake (&gt;= <span class=\"number\">1.11</span>), libpcre3<span class=\"literal\">-dev</span>, libssl<span class=\"literal\">-dev</span>, php7.<span class=\"number\">0</span><span class=\"literal\">-cli</span> (&gt;= <span class=\"number\">7.0</span>.<span class=\"number\">6</span><span class=\"literal\">-12</span>+donate.sury.org~trusty+<span class=\"number\">1</span>), php7.<span class=\"number\">0</span><span class=\"literal\">-common</span> (= <span class=\"number\">7.0</span>.<span class=\"number\">6</span><span class=\"literal\">-12</span>+donate.sury.org~trusty+<span class=\"number\">1</span>), shtool, libtool</span><br><span class=\"line\">Filename: pool/main/p/php7.<span class=\"number\">0</span>/php7.<span class=\"number\">0</span><span class=\"literal\">-dev_7</span>.<span class=\"number\">0.6</span><span class=\"literal\">-12</span>+donate.sury.org~trusty+<span class=\"number\">1</span>_amd64.deb</span><br><span class=\"line\">Size: <span class=\"number\">505784</span></span><br><span class=\"line\">MD5sum: bb75fadf2fc0bae22d7a26999b9ac0e2</span><br><span class=\"line\">SHA1: a85e13a259faae1377813d7b1e5c344c8ede8d09</span><br><span class=\"line\">SHA256: <span class=\"number\">79617</span>d3b79e054129a2e980534885ab794ec18c5052894e71d1da37ec07b2aff</span><br><span class=\"line\">Description<span class=\"literal\">-en</span>: Files <span class=\"keyword\">for</span> PHP7.<span class=\"number\">0</span> module development</span><br><span class=\"line\"> This package provides the files from the PHP7.<span class=\"number\">0</span> source needed <span class=\"keyword\">for</span> compiling</span><br><span class=\"line\"> additional modules.</span><br><span class=\"line\"></span><br><span class=\"line\">PHP (recursive acronym <span class=\"keyword\">for</span> PHP: Hypertext Preprocessor) is a widely<span class=\"literal\">-used</span></span><br><span class=\"line\"> open source general<span class=\"literal\">-purpose</span> scripting language that is especially suited</span><br><span class=\"line\"> <span class=\"keyword\">for</span> web development and can be embedded into HTML.</span><br><span class=\"line\">Description<span class=\"literal\">-md5</span>: cab4eaaf141b1f52bc2814eea2492ab2</span><br><span class=\"line\"></span><br><span class=\"line\">apt<span class=\"literal\">-get</span> install php7.<span class=\"number\">0</span><span class=\"literal\">-dev</span></span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>安装mongo扩展 和swoole扩展</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">使用pecl进行安装mongo和swoole扩展。</span><br><span class=\"line\">这里记住是mongodb扩展不是mongo扩展。这两个扩展在使用上面不一样，后面会讲到。这里我们安装</span><br><span class=\"line\">mongodb</span><br><span class=\"line\"></span><br><span class=\"line\">搜索mongodb</span><br><span class=\"line\">$ pecl search mongo</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">pecl库更新到最新</span><br><span class=\"line\">$ pecl channel-update pecl.php.net</span><br><span class=\"line\"></span><br><span class=\"line\">安装mongodb</span><br><span class=\"line\">$ pecl install mongodb</span><br><span class=\"line\"></span><br><span class=\"line\">问题：</span><br><span class=\"line\">1. 这里如果安装mongo会提示不支持Php7.0以上版本：</span><br><span class=\"line\">\tpecl/mongo requires PHP (version &gt;= 5.3.0, version &lt;= 5.99.99),</span><br><span class=\"line\">\tinstalled version is 7.0.6-12+donate.sury.org~trusty+1</span><br><span class=\"line\">2. configure: error: Cannot find OpenSSL&apos;s libraries</span><br><span class=\"line\">\t 解决方法：  ln -s /usr/lib/x86_64-linux-gnu/libssl.so  /usr/lib</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">安装swoole</span><br><span class=\"line\">$ pecl install swoole</span><br><span class=\"line\"></span><br><span class=\"line\">查找php.ini 把swoole.so和mongodb加入进去</span><br><span class=\"line\">$ php --ini  </span><br><span class=\"line\"></span><br><span class=\"line\">$ php -ri|grep swoole</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li>PHP swoole代码</li>\n</ol>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$serv = <span class=\"keyword\">new</span> swoole_server(<span class=\"string\">\"0.0.0.0\"</span>, <span class=\"number\">9501</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;set(<span class=\"keyword\">array</span>(</span><br><span class=\"line\">\t<span class=\"string\">'worker_num'</span> =&gt; <span class=\"number\">8</span>, <span class=\"comment\">//工作进程数量</span></span><br><span class=\"line\">\t<span class=\"string\">'daemonize'</span> =&gt; <span class=\"keyword\">false</span>, <span class=\"comment\">//是否作为守护进程</span></span><br><span class=\"line\">));</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;on(<span class=\"string\">'connect'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($serv, $fd)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">echo</span> <span class=\"string\">\"Client:Connect.\\n\"</span>;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;on(<span class=\"string\">'receive'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($serv,$fd, $from_id, $data)</span> </span>&#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$arr = json_decode($data);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//$array=array('column_name'=&gt;'col'.rand(100,999),'column_exp'=&gt;'xiaocai');</span></span><br><span class=\"line\">\t$connection = <span class=\"keyword\">new</span> MongoClient(<span class=\"string\">\"mongodb://root:密码@主机ID1.mongodb.rds.aliyuncs.com:3717,主机2.mongodb.rds.aliyuncs.com:3717/admin?replicaSet=副本集名称\"</span>);</span><br><span class=\"line\">\t<span class=\"comment\">//\t$connection = new MongoClient(\"mongodb://localhost:27017\");</span></span><br><span class=\"line\">\tvar_dump($connection);</span><br><span class=\"line\">\t$roomid = <span class=\"string\">\"roomid\"</span>.<span class=\"string\">'_123'</span>;</span><br><span class=\"line\">\t$collection = $connection-&gt;test-&gt;$roomid;</span><br><span class=\"line\">\t$collection-&gt;insert($arr);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$document = $collection-&gt;findOne();</span><br><span class=\"line\">\tvar_dump($document);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$serv-&gt;send($fd, <span class=\"string\">'Swoole: '</span> . $data);</span><br><span class=\"line\">\t$serv-&gt;close($fd);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;on(<span class=\"string\">'close'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($serv, $fd)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">echo</span> <span class=\"string\">\"Client: Close.\\n\"</span>;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;start();</span><br></pre></td></tr></table></figure>\n<p>如果执行上面的代码的话，会报<code>PHP Fatal error: Uncaught Error: Class 'MongoClient' not found</code><br>\n这里要说明一下MongoClient是扩展Mongo的内置函数。<br>\n可以通过</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print_r(get_declared_classes());</span><br></pre></td></tr></table></figure>\n<p>查看函数列表<br>\nMongo的函数列表</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[156] =&gt; MongoClient</span><br><span class=\"line\">[157] =&gt; Mongo</span><br><span class=\"line\">[158] =&gt; MongoDB</span><br><span class=\"line\">[159] =&gt; MongoCollection</span><br><span class=\"line\">[160] =&gt; MongoCursor</span><br><span class=\"line\">[161] =&gt; MongoCommandCursor</span><br><span class=\"line\">[162] =&gt; MongoGridFS</span><br><span class=\"line\">[163] =&gt; MongoGridFSFile</span><br><span class=\"line\">[164] =&gt; MongoGridFSCursor</span><br><span class=\"line\">[165] =&gt; MongoWriteBatch</span><br><span class=\"line\">[166] =&gt; MongoInsertBatch</span><br><span class=\"line\">[167] =&gt; MongoUpdateBatch</span><br><span class=\"line\">[168] =&gt; MongoDeleteBatch</span><br><span class=\"line\">[169] =&gt; MongoId</span><br><span class=\"line\">[170] =&gt; MongoCode</span><br><span class=\"line\">[171] =&gt; MongoRegex</span><br><span class=\"line\">[172] =&gt; MongoDate</span><br><span class=\"line\">[173] =&gt; MongoBinData</span><br><span class=\"line\">[174] =&gt; MongoDBRef</span><br><span class=\"line\">[175] =&gt; MongoException</span><br><span class=\"line\">[176] =&gt; MongoConnectionException</span><br><span class=\"line\">[177] =&gt; MongoCursorException</span><br><span class=\"line\">[178] =&gt; MongoCursorTimeoutException</span><br><span class=\"line\">[179] =&gt; MongoGridFSException</span><br><span class=\"line\">[180] =&gt; MongoResultException</span><br><span class=\"line\">[181] =&gt; MongoWriteConcernException</span><br><span class=\"line\">[182] =&gt; MongoDuplicateKeyException</span><br><span class=\"line\">[183] =&gt; MongoExecutionTimeoutException</span><br><span class=\"line\">[184] =&gt; MongoProtocolException</span><br><span class=\"line\">[185] =&gt; MongoTimestamp</span><br><span class=\"line\">[186] =&gt; MongoInt32</span><br><span class=\"line\">[187] =&gt; MongoInt64</span><br><span class=\"line\">[188] =&gt; MongoLog</span><br><span class=\"line\">[189] =&gt; MongoPool</span><br><span class=\"line\">[190] =&gt; MongoMaxKey</span><br><span class=\"line\">[191] =&gt; MongoMinKey</span><br></pre></td></tr></table></figure>\n<p>Mongodb的函数列表</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[100] =&gt; MongoDB\\Driver\\Command</span><br><span class=\"line\">   [101] =&gt; MongoDB\\Driver\\Cursor</span><br><span class=\"line\">   [102] =&gt; MongoDB\\Driver\\CursorId</span><br><span class=\"line\">   [103] =&gt; MongoDB\\Driver\\Manager</span><br><span class=\"line\">   [104] =&gt; MongoDB\\Driver\\Query</span><br><span class=\"line\">   [105] =&gt; MongoDB\\Driver\\ReadConcern</span><br><span class=\"line\">   [106] =&gt; MongoDB\\Driver\\ReadPreference</span><br><span class=\"line\">   [107] =&gt; MongoDB\\Driver\\Server</span><br><span class=\"line\">   [108] =&gt; MongoDB\\Driver\\BulkWrite</span><br><span class=\"line\">   [109] =&gt; MongoDB\\Driver\\WriteConcern</span><br><span class=\"line\">   [110] =&gt; MongoDB\\Driver\\WriteConcernError</span><br><span class=\"line\">   [111] =&gt; MongoDB\\Driver\\WriteError</span><br><span class=\"line\">   [112] =&gt; MongoDB\\Driver\\WriteResult</span><br><span class=\"line\">   [113] =&gt; MongoDB\\Driver\\Exception\\LogicException</span><br><span class=\"line\">   [114] =&gt; MongoDB\\Driver\\Exception\\RuntimeException</span><br><span class=\"line\">   [115] =&gt; MongoDB\\Driver\\Exception\\UnexpectedValueException</span><br><span class=\"line\">   [116] =&gt; MongoDB\\Driver\\Exception\\InvalidArgumentException</span><br><span class=\"line\">   [117] =&gt; MongoDB\\Driver\\Exception\\ConnectionException</span><br><span class=\"line\">   [118] =&gt; MongoDB\\Driver\\Exception\\AuthenticationException</span><br><span class=\"line\">   [119] =&gt; MongoDB\\Driver\\Exception\\SSLConnectionException</span><br><span class=\"line\">   [120] =&gt; MongoDB\\Driver\\Exception\\WriteException</span><br><span class=\"line\">   [121] =&gt; MongoDB\\Driver\\Exception\\BulkWriteException</span><br><span class=\"line\">   [122] =&gt; MongoDB\\Driver\\Exception\\ExecutionTimeoutException</span><br><span class=\"line\">   [123] =&gt; MongoDB\\Driver\\Exception\\ConnectionTimeoutException</span><br><span class=\"line\">   [124] =&gt; MongoDB\\BSON\\Binary</span><br><span class=\"line\">   [125] =&gt; MongoDB\\BSON\\Javascript</span><br><span class=\"line\">   [126] =&gt; MongoDB\\BSON\\MaxKey</span><br><span class=\"line\">   [127] =&gt; MongoDB\\BSON\\MinKey</span><br><span class=\"line\">   [128] =&gt; MongoDB\\BSON\\ObjectID</span><br><span class=\"line\">   [129] =&gt; MongoDB\\BSON\\Regex</span><br><span class=\"line\">   [130] =&gt; MongoDB\\BSON\\Timestamp</span><br><span class=\"line\">   [131] =&gt; MongoDB\\BSON\\UTCDateTime</span><br></pre></td></tr></table></figure>\n<p>所以要使用Php7.0以上版本需要重新写连接mongdo的数据库<br>\n查找php文档<a href=\"http://php.net/manual/zh/set.mongodb.php\" target=\"_blank\" rel=\"noopener\">Mongodb driver</a></p>\n<p>修改成为mongodb的一个demo\t连接修改代码如下：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$serv = <span class=\"keyword\">new</span> swoole_server(<span class=\"string\">\"0.0.0.0\"</span>, <span class=\"number\">9501</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;set(<span class=\"keyword\">array</span>(</span><br><span class=\"line\">\t<span class=\"string\">'worker_num'</span> =&gt; <span class=\"number\">8</span>, <span class=\"comment\">//工作进程数量</span></span><br><span class=\"line\">\t<span class=\"string\">'daemonize'</span> =&gt; <span class=\"keyword\">false</span>, <span class=\"comment\">//是否作为守护进程</span></span><br><span class=\"line\">));</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;on(<span class=\"string\">'connect'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($serv, $fd)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">echo</span> <span class=\"string\">\"Client:Connect.\\n\"</span>;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;on(<span class=\"string\">'receive'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($serv, $fd, $from_id, $data)</span> </span>&#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$arr = json_decode($data);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$bulk = <span class=\"keyword\">new</span> MongoDB\\Driver\\BulkWrite([<span class=\"string\">'ordered'</span> =&gt; <span class=\"keyword\">true</span>]);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$bulk-&gt;insert($arr);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$connection = <span class=\"keyword\">new</span> MongoDB\\Driver\\Manager(<span class=\"string\">\"mongodb://localhost:27017\"</span>);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t\t$result = $connection-&gt;executeBulkWrite(<span class=\"string\">'test.roomid'</span>, $bulk);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (MongoDB\\Driver\\<span class=\"keyword\">Exception</span>\\BulkWriteException $e) &#123;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t\t$result = $e-&gt;getWriteResult();</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> ($writeConcernError = $result-&gt;getWriteConcernError()) &#123;</span><br><span class=\"line\">\t\t\t\tprintf(<span class=\"string\">\"%s (%d): %s\\n\"</span>,\t$writeConcernError-&gt;getMessage(),</span><br><span class=\"line\">\t\t\t\t$writeConcernError-&gt;getCode(),</span><br><span class=\"line\">\t\t\t\tvar_export($writeConcernError-&gt;getInfo(), <span class=\"keyword\">true</span>));</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// Check if any write operations did not complete at all</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">foreach</span> ($result-&gt;getWriteErrors() <span class=\"keyword\">as</span> $writeError) &#123;</span><br><span class=\"line\">\t\t\t\tprintf(<span class=\"string\">\"Operation#%d: %s (%d)\\n\"</span>,</span><br><span class=\"line\">\t\t\t\t$writeError-&gt;getIndex(),</span><br><span class=\"line\">\t\t\t\t$writeError-&gt;getMessage(),</span><br><span class=\"line\">\t\t\t\t$writeError-&gt;getCode()</span><br><span class=\"line\">\t\t\t);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (MongoDB\\Driver\\<span class=\"keyword\">Exception</span>\\<span class=\"keyword\">Exception</span> $e) &#123;</span><br><span class=\"line\">\tprintf(<span class=\"string\">\"Other error: %s\\n\"</span>, $e-&gt;getMessage());</span><br><span class=\"line\">\t<span class=\"keyword\">exit</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tprintf(<span class=\"string\">\"Inserted %d document(s)\\n\"</span>,$result-&gt;getInsertedCount());</span><br><span class=\"line\">\tprintf(<span class=\"string\">\"Updated  %d document(s)\\n\"</span>,$result-&gt;getModifiedCount());</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$serv-&gt;send($fd, <span class=\"string\">'Swoole: '</span> . $data);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$serv-&gt;close($fd);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;on(<span class=\"string\">'close'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($serv, $fd)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">echo</span> <span class=\"string\">\"Client: Close.\\n\"</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;start();</span><br></pre></td></tr></table></figure>\n<p>模拟请求数据</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">netcat 127.0.0.1 9501</span><br></pre></td></tr></table></figure>\n<p>END</p>\n","site":{"data":{}},"excerpt":"","more":"<p>应用场景是，单个用户写的数据是8-10条/S JSON数据包</p>\n<p>采用架构如下图所示：<br>\n<img src=\"Swoole-Mongo.png\" alt=\"架构图\"></p>\n<p>采用的是</p>\n<ul>\n<li>php7.0.6</li>\n<li>swoole-1.8.5版本</li>\n<li>php扩展mongodb1.1.6  而目前mongo-1.6.14不支持php7 这样导致连接Mongo函数不一样，后面会讲到。</li>\n<li>服务器 Ubuntu 14.04 64位 2核 4G</li>\n<li>阿里云的Mongodb服务器</li>\n</ul>\n<p>到目前阿里云Mongodb还不支持sharding,后续会进行支持。目前是使用双节点。摘录<a href=\"https://yq.aliyun.com/articles/7557\" target=\"_blank\" rel=\"noopener\">MongoDB杭州用户交流会</a>的一段话:</p>\n<blockquote>\n<p>阿里云目前已提供对MongoDB复制集（Replica Set）的支持，默认会为用户创建包含3个数据节点的复制集，其中一个Primary、一个Secondary，以及一个Hidden节点。Primary、Secondary对用户可见，用户可以自定义ReadPreference，Hidden节点对用户不可见，目前主要用于实例数据备份以及自动的failover，当有Primary或Secondary节点挂掉时，Hidden会被自动切换为Secondary，保证用户的服务不受影响。</p>\n</blockquote>\n<h3 id=\"mongodb服务器\"><a class=\"markdownIt-Anchor\" href=\"#mongodb服务器\"></a> mongodb服务器</h3>\n<p>阿里云服务器目前只支持ECS访问不支持外网方面</p>\n<ul>\n<li>\n<p>[公网连接mongodb windows篇](<a href=\"https://help.aliyun.com/knowledge_detail/13052608.html#%E9%80%9A%E8%BF%87%E5%85%AC%E7%BD%91%E8%BF%9E%E6%8E%A5%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93MongoDB--ECS\" target=\"_blank\" rel=\"noopener\">https://help.aliyun.com/knowledge_detail/13052608.html#通过公网连接云数据库MongoDB--ECS</a> Windows篇)</p>\n</li>\n<li>\n<p>[公网连接mongodb linux篇](<a href=\"https://help.aliyun.com/knowledge_detail/13052572.html#%E9%80%9A%E8%BF%87%E5%85%AC%E7%BD%91%E8%BF%9E%E6%8E%A5%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93MongoDB--ECS\" target=\"_blank\" rel=\"noopener\">https://help.aliyun.com/knowledge_detail/13052572.html#通过公网连接云数据库MongoDB--ECS</a> Linux篇)</p>\n</li>\n</ul>\n<p>用如下命令检测是否连上mongodb</p>\n<ul>\n<li>ping  <a href=\"http://dds-xxxxxxxx.mongodb.rds.aliyuncs.com\" target=\"_blank\" rel=\"noopener\">dds-xxxxxxxx.mongodb.rds.aliyuncs.com</a></li>\n<li>telnet  <a href=\"http://dds-xxxxxxxxxxxx.mongodb.rds.aliyuncs.com\" target=\"_blank\" rel=\"noopener\">dds-xxxxxxxxxxxx.mongodb.rds.aliyuncs.com</a> 3717</li>\n<li>mongo --host <a href=\"http://dds-xxxxxxxxxxxxx1.mongodb.rds.aliyuncs.com:3717\" target=\"_blank\" rel=\"noopener\">dds-xxxxxxxxxxxxx1.mongodb.rds.aliyuncs.com:3717</a> --authenticationDatabase admin -u root -p</li>\n<li>mongo --host <a href=\"http://dds-xxxxxxxxxxxxxx2.mongodb.rds.aliyuncs.com:3717\" target=\"_blank\" rel=\"noopener\">dds-xxxxxxxxxxxxxx2.mongodb.rds.aliyuncs.com:3717</a> --authenticationDatabase admin -u root -p</li>\n</ul>\n<p>如果本身server服务器用的ECS，还是要设置一下，</p>\n<h3 id=\"搭建tcp-sever服务器\"><a class=\"markdownIt-Anchor\" href=\"#搭建tcp-sever服务器\"></a> 搭建TCP-SEVER服务器</h3>\n<ol>\n<li>买好服务器之后习惯性的把服务器服务升级到最新。（这个是强迫症）</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ apt-get update </span><br><span class=\"line\"></span><br><span class=\"line\">$ apt-get upgrade</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>安装最新的php7.0.6环境</li>\n</ol>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt<span class=\"literal\">-get</span> install python<span class=\"literal\">-software</span><span class=\"literal\">-properties</span></span><br><span class=\"line\"></span><br><span class=\"line\">apt<span class=\"literal\">-get</span> install software<span class=\"literal\">-properties</span><span class=\"literal\">-common</span></span><br><span class=\"line\"></span><br><span class=\"line\">LC_ALL=C.UTF<span class=\"literal\">-8</span> <span class=\"built_in\">add-apt</span><span class=\"literal\">-repository</span> ppa:ondrej/php</span><br><span class=\"line\"></span><br><span class=\"line\">apt<span class=\"literal\">-get</span> update</span><br><span class=\"line\"></span><br><span class=\"line\">apt<span class=\"literal\">-cache</span> show php7.<span class=\"number\">0</span><span class=\"literal\">-dev</span>  </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">Package: php7.<span class=\"number\">0</span><span class=\"literal\">-dev</span></span><br><span class=\"line\">Source: php7.<span class=\"number\">0</span></span><br><span class=\"line\">Priority: optional</span><br><span class=\"line\">Section: php</span><br><span class=\"line\">Installed<span class=\"literal\">-Size</span>: <span class=\"number\">4658</span></span><br><span class=\"line\">Maintainer: Debian PHP Maintainers &lt;pkg<span class=\"literal\">-php</span><span class=\"literal\">-maint</span>@lists.alioth.debian.org&gt;</span><br><span class=\"line\">Architecture: amd64</span><br><span class=\"line\">Version: <span class=\"number\">7.0</span>.<span class=\"number\">6</span><span class=\"literal\">-12</span>+donate.sury.org~trusty+<span class=\"number\">1</span></span><br><span class=\"line\">Recommends: dh<span class=\"literal\">-php</span>, pkg<span class=\"literal\">-php</span><span class=\"literal\">-tools</span></span><br><span class=\"line\">Depends: autoconf (&gt;= <span class=\"number\">2.63</span>), automake (&gt;= <span class=\"number\">1.11</span>), libpcre3<span class=\"literal\">-dev</span>, libssl<span class=\"literal\">-dev</span>, php7.<span class=\"number\">0</span><span class=\"literal\">-cli</span> (&gt;= <span class=\"number\">7.0</span>.<span class=\"number\">6</span><span class=\"literal\">-12</span>+donate.sury.org~trusty+<span class=\"number\">1</span>), php7.<span class=\"number\">0</span><span class=\"literal\">-common</span> (= <span class=\"number\">7.0</span>.<span class=\"number\">6</span><span class=\"literal\">-12</span>+donate.sury.org~trusty+<span class=\"number\">1</span>), shtool, libtool</span><br><span class=\"line\">Filename: pool/main/p/php7.<span class=\"number\">0</span>/php7.<span class=\"number\">0</span><span class=\"literal\">-dev_7</span>.<span class=\"number\">0.6</span><span class=\"literal\">-12</span>+donate.sury.org~trusty+<span class=\"number\">1</span>_amd64.deb</span><br><span class=\"line\">Size: <span class=\"number\">505784</span></span><br><span class=\"line\">MD5sum: bb75fadf2fc0bae22d7a26999b9ac0e2</span><br><span class=\"line\">SHA1: a85e13a259faae1377813d7b1e5c344c8ede8d09</span><br><span class=\"line\">SHA256: <span class=\"number\">79617</span>d3b79e054129a2e980534885ab794ec18c5052894e71d1da37ec07b2aff</span><br><span class=\"line\">Description<span class=\"literal\">-en</span>: Files <span class=\"keyword\">for</span> PHP7.<span class=\"number\">0</span> module development</span><br><span class=\"line\"> This package provides the files from the PHP7.<span class=\"number\">0</span> source needed <span class=\"keyword\">for</span> compiling</span><br><span class=\"line\"> additional modules.</span><br><span class=\"line\"></span><br><span class=\"line\">PHP (recursive acronym <span class=\"keyword\">for</span> PHP: Hypertext Preprocessor) is a widely<span class=\"literal\">-used</span></span><br><span class=\"line\"> open source general<span class=\"literal\">-purpose</span> scripting language that is especially suited</span><br><span class=\"line\"> <span class=\"keyword\">for</span> web development and can be embedded into HTML.</span><br><span class=\"line\">Description<span class=\"literal\">-md5</span>: cab4eaaf141b1f52bc2814eea2492ab2</span><br><span class=\"line\"></span><br><span class=\"line\">apt<span class=\"literal\">-get</span> install php7.<span class=\"number\">0</span><span class=\"literal\">-dev</span></span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>安装mongo扩展 和swoole扩展</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">使用pecl进行安装mongo和swoole扩展。</span><br><span class=\"line\">这里记住是mongodb扩展不是mongo扩展。这两个扩展在使用上面不一样，后面会讲到。这里我们安装</span><br><span class=\"line\">mongodb</span><br><span class=\"line\"></span><br><span class=\"line\">搜索mongodb</span><br><span class=\"line\">$ pecl search mongo</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">pecl库更新到最新</span><br><span class=\"line\">$ pecl channel-update pecl.php.net</span><br><span class=\"line\"></span><br><span class=\"line\">安装mongodb</span><br><span class=\"line\">$ pecl install mongodb</span><br><span class=\"line\"></span><br><span class=\"line\">问题：</span><br><span class=\"line\">1. 这里如果安装mongo会提示不支持Php7.0以上版本：</span><br><span class=\"line\">\tpecl/mongo requires PHP (version &gt;= 5.3.0, version &lt;= 5.99.99),</span><br><span class=\"line\">\tinstalled version is 7.0.6-12+donate.sury.org~trusty+1</span><br><span class=\"line\">2. configure: error: Cannot find OpenSSL&apos;s libraries</span><br><span class=\"line\">\t 解决方法：  ln -s /usr/lib/x86_64-linux-gnu/libssl.so  /usr/lib</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">安装swoole</span><br><span class=\"line\">$ pecl install swoole</span><br><span class=\"line\"></span><br><span class=\"line\">查找php.ini 把swoole.so和mongodb加入进去</span><br><span class=\"line\">$ php --ini  </span><br><span class=\"line\"></span><br><span class=\"line\">$ php -ri|grep swoole</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li>PHP swoole代码</li>\n</ol>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$serv = <span class=\"keyword\">new</span> swoole_server(<span class=\"string\">\"0.0.0.0\"</span>, <span class=\"number\">9501</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;set(<span class=\"keyword\">array</span>(</span><br><span class=\"line\">\t<span class=\"string\">'worker_num'</span> =&gt; <span class=\"number\">8</span>, <span class=\"comment\">//工作进程数量</span></span><br><span class=\"line\">\t<span class=\"string\">'daemonize'</span> =&gt; <span class=\"keyword\">false</span>, <span class=\"comment\">//是否作为守护进程</span></span><br><span class=\"line\">));</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;on(<span class=\"string\">'connect'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($serv, $fd)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">echo</span> <span class=\"string\">\"Client:Connect.\\n\"</span>;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;on(<span class=\"string\">'receive'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($serv,$fd, $from_id, $data)</span> </span>&#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$arr = json_decode($data);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//$array=array('column_name'=&gt;'col'.rand(100,999),'column_exp'=&gt;'xiaocai');</span></span><br><span class=\"line\">\t$connection = <span class=\"keyword\">new</span> MongoClient(<span class=\"string\">\"mongodb://root:密码@主机ID1.mongodb.rds.aliyuncs.com:3717,主机2.mongodb.rds.aliyuncs.com:3717/admin?replicaSet=副本集名称\"</span>);</span><br><span class=\"line\">\t<span class=\"comment\">//\t$connection = new MongoClient(\"mongodb://localhost:27017\");</span></span><br><span class=\"line\">\tvar_dump($connection);</span><br><span class=\"line\">\t$roomid = <span class=\"string\">\"roomid\"</span>.<span class=\"string\">'_123'</span>;</span><br><span class=\"line\">\t$collection = $connection-&gt;test-&gt;$roomid;</span><br><span class=\"line\">\t$collection-&gt;insert($arr);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$document = $collection-&gt;findOne();</span><br><span class=\"line\">\tvar_dump($document);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$serv-&gt;send($fd, <span class=\"string\">'Swoole: '</span> . $data);</span><br><span class=\"line\">\t$serv-&gt;close($fd);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;on(<span class=\"string\">'close'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($serv, $fd)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">echo</span> <span class=\"string\">\"Client: Close.\\n\"</span>;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;start();</span><br></pre></td></tr></table></figure>\n<p>如果执行上面的代码的话，会报<code>PHP Fatal error: Uncaught Error: Class 'MongoClient' not found</code><br>\n这里要说明一下MongoClient是扩展Mongo的内置函数。<br>\n可以通过</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print_r(get_declared_classes());</span><br></pre></td></tr></table></figure>\n<p>查看函数列表<br>\nMongo的函数列表</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[156] =&gt; MongoClient</span><br><span class=\"line\">[157] =&gt; Mongo</span><br><span class=\"line\">[158] =&gt; MongoDB</span><br><span class=\"line\">[159] =&gt; MongoCollection</span><br><span class=\"line\">[160] =&gt; MongoCursor</span><br><span class=\"line\">[161] =&gt; MongoCommandCursor</span><br><span class=\"line\">[162] =&gt; MongoGridFS</span><br><span class=\"line\">[163] =&gt; MongoGridFSFile</span><br><span class=\"line\">[164] =&gt; MongoGridFSCursor</span><br><span class=\"line\">[165] =&gt; MongoWriteBatch</span><br><span class=\"line\">[166] =&gt; MongoInsertBatch</span><br><span class=\"line\">[167] =&gt; MongoUpdateBatch</span><br><span class=\"line\">[168] =&gt; MongoDeleteBatch</span><br><span class=\"line\">[169] =&gt; MongoId</span><br><span class=\"line\">[170] =&gt; MongoCode</span><br><span class=\"line\">[171] =&gt; MongoRegex</span><br><span class=\"line\">[172] =&gt; MongoDate</span><br><span class=\"line\">[173] =&gt; MongoBinData</span><br><span class=\"line\">[174] =&gt; MongoDBRef</span><br><span class=\"line\">[175] =&gt; MongoException</span><br><span class=\"line\">[176] =&gt; MongoConnectionException</span><br><span class=\"line\">[177] =&gt; MongoCursorException</span><br><span class=\"line\">[178] =&gt; MongoCursorTimeoutException</span><br><span class=\"line\">[179] =&gt; MongoGridFSException</span><br><span class=\"line\">[180] =&gt; MongoResultException</span><br><span class=\"line\">[181] =&gt; MongoWriteConcernException</span><br><span class=\"line\">[182] =&gt; MongoDuplicateKeyException</span><br><span class=\"line\">[183] =&gt; MongoExecutionTimeoutException</span><br><span class=\"line\">[184] =&gt; MongoProtocolException</span><br><span class=\"line\">[185] =&gt; MongoTimestamp</span><br><span class=\"line\">[186] =&gt; MongoInt32</span><br><span class=\"line\">[187] =&gt; MongoInt64</span><br><span class=\"line\">[188] =&gt; MongoLog</span><br><span class=\"line\">[189] =&gt; MongoPool</span><br><span class=\"line\">[190] =&gt; MongoMaxKey</span><br><span class=\"line\">[191] =&gt; MongoMinKey</span><br></pre></td></tr></table></figure>\n<p>Mongodb的函数列表</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[100] =&gt; MongoDB\\Driver\\Command</span><br><span class=\"line\">   [101] =&gt; MongoDB\\Driver\\Cursor</span><br><span class=\"line\">   [102] =&gt; MongoDB\\Driver\\CursorId</span><br><span class=\"line\">   [103] =&gt; MongoDB\\Driver\\Manager</span><br><span class=\"line\">   [104] =&gt; MongoDB\\Driver\\Query</span><br><span class=\"line\">   [105] =&gt; MongoDB\\Driver\\ReadConcern</span><br><span class=\"line\">   [106] =&gt; MongoDB\\Driver\\ReadPreference</span><br><span class=\"line\">   [107] =&gt; MongoDB\\Driver\\Server</span><br><span class=\"line\">   [108] =&gt; MongoDB\\Driver\\BulkWrite</span><br><span class=\"line\">   [109] =&gt; MongoDB\\Driver\\WriteConcern</span><br><span class=\"line\">   [110] =&gt; MongoDB\\Driver\\WriteConcernError</span><br><span class=\"line\">   [111] =&gt; MongoDB\\Driver\\WriteError</span><br><span class=\"line\">   [112] =&gt; MongoDB\\Driver\\WriteResult</span><br><span class=\"line\">   [113] =&gt; MongoDB\\Driver\\Exception\\LogicException</span><br><span class=\"line\">   [114] =&gt; MongoDB\\Driver\\Exception\\RuntimeException</span><br><span class=\"line\">   [115] =&gt; MongoDB\\Driver\\Exception\\UnexpectedValueException</span><br><span class=\"line\">   [116] =&gt; MongoDB\\Driver\\Exception\\InvalidArgumentException</span><br><span class=\"line\">   [117] =&gt; MongoDB\\Driver\\Exception\\ConnectionException</span><br><span class=\"line\">   [118] =&gt; MongoDB\\Driver\\Exception\\AuthenticationException</span><br><span class=\"line\">   [119] =&gt; MongoDB\\Driver\\Exception\\SSLConnectionException</span><br><span class=\"line\">   [120] =&gt; MongoDB\\Driver\\Exception\\WriteException</span><br><span class=\"line\">   [121] =&gt; MongoDB\\Driver\\Exception\\BulkWriteException</span><br><span class=\"line\">   [122] =&gt; MongoDB\\Driver\\Exception\\ExecutionTimeoutException</span><br><span class=\"line\">   [123] =&gt; MongoDB\\Driver\\Exception\\ConnectionTimeoutException</span><br><span class=\"line\">   [124] =&gt; MongoDB\\BSON\\Binary</span><br><span class=\"line\">   [125] =&gt; MongoDB\\BSON\\Javascript</span><br><span class=\"line\">   [126] =&gt; MongoDB\\BSON\\MaxKey</span><br><span class=\"line\">   [127] =&gt; MongoDB\\BSON\\MinKey</span><br><span class=\"line\">   [128] =&gt; MongoDB\\BSON\\ObjectID</span><br><span class=\"line\">   [129] =&gt; MongoDB\\BSON\\Regex</span><br><span class=\"line\">   [130] =&gt; MongoDB\\BSON\\Timestamp</span><br><span class=\"line\">   [131] =&gt; MongoDB\\BSON\\UTCDateTime</span><br></pre></td></tr></table></figure>\n<p>所以要使用Php7.0以上版本需要重新写连接mongdo的数据库<br>\n查找php文档<a href=\"http://php.net/manual/zh/set.mongodb.php\" target=\"_blank\" rel=\"noopener\">Mongodb driver</a></p>\n<p>修改成为mongodb的一个demo\t连接修改代码如下：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$serv = <span class=\"keyword\">new</span> swoole_server(<span class=\"string\">\"0.0.0.0\"</span>, <span class=\"number\">9501</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;set(<span class=\"keyword\">array</span>(</span><br><span class=\"line\">\t<span class=\"string\">'worker_num'</span> =&gt; <span class=\"number\">8</span>, <span class=\"comment\">//工作进程数量</span></span><br><span class=\"line\">\t<span class=\"string\">'daemonize'</span> =&gt; <span class=\"keyword\">false</span>, <span class=\"comment\">//是否作为守护进程</span></span><br><span class=\"line\">));</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;on(<span class=\"string\">'connect'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($serv, $fd)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">echo</span> <span class=\"string\">\"Client:Connect.\\n\"</span>;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;on(<span class=\"string\">'receive'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($serv, $fd, $from_id, $data)</span> </span>&#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$arr = json_decode($data);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$bulk = <span class=\"keyword\">new</span> MongoDB\\Driver\\BulkWrite([<span class=\"string\">'ordered'</span> =&gt; <span class=\"keyword\">true</span>]);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$bulk-&gt;insert($arr);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$connection = <span class=\"keyword\">new</span> MongoDB\\Driver\\Manager(<span class=\"string\">\"mongodb://localhost:27017\"</span>);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t\t$result = $connection-&gt;executeBulkWrite(<span class=\"string\">'test.roomid'</span>, $bulk);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (MongoDB\\Driver\\<span class=\"keyword\">Exception</span>\\BulkWriteException $e) &#123;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t\t$result = $e-&gt;getWriteResult();</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> ($writeConcernError = $result-&gt;getWriteConcernError()) &#123;</span><br><span class=\"line\">\t\t\t\tprintf(<span class=\"string\">\"%s (%d): %s\\n\"</span>,\t$writeConcernError-&gt;getMessage(),</span><br><span class=\"line\">\t\t\t\t$writeConcernError-&gt;getCode(),</span><br><span class=\"line\">\t\t\t\tvar_export($writeConcernError-&gt;getInfo(), <span class=\"keyword\">true</span>));</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// Check if any write operations did not complete at all</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">foreach</span> ($result-&gt;getWriteErrors() <span class=\"keyword\">as</span> $writeError) &#123;</span><br><span class=\"line\">\t\t\t\tprintf(<span class=\"string\">\"Operation#%d: %s (%d)\\n\"</span>,</span><br><span class=\"line\">\t\t\t\t$writeError-&gt;getIndex(),</span><br><span class=\"line\">\t\t\t\t$writeError-&gt;getMessage(),</span><br><span class=\"line\">\t\t\t\t$writeError-&gt;getCode()</span><br><span class=\"line\">\t\t\t);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (MongoDB\\Driver\\<span class=\"keyword\">Exception</span>\\<span class=\"keyword\">Exception</span> $e) &#123;</span><br><span class=\"line\">\tprintf(<span class=\"string\">\"Other error: %s\\n\"</span>, $e-&gt;getMessage());</span><br><span class=\"line\">\t<span class=\"keyword\">exit</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tprintf(<span class=\"string\">\"Inserted %d document(s)\\n\"</span>,$result-&gt;getInsertedCount());</span><br><span class=\"line\">\tprintf(<span class=\"string\">\"Updated  %d document(s)\\n\"</span>,$result-&gt;getModifiedCount());</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$serv-&gt;send($fd, <span class=\"string\">'Swoole: '</span> . $data);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$serv-&gt;close($fd);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;on(<span class=\"string\">'close'</span>, <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($serv, $fd)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">echo</span> <span class=\"string\">\"Client: Close.\\n\"</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">$serv-&gt;start();</span><br></pre></td></tr></table></figure>\n<p>模拟请求数据</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">netcat 127.0.0.1 9501</span><br></pre></td></tr></table></figure>\n<p>END</p>\n"},{"title":"开篇","date":"2016-04-20T06:33:43.000Z","_content":"# blog开篇 \n\n 从2006年一直写到2013年1月6号最后一篇，总共500多篇。虽然Blog建了很长时间了，一直想继续去写，出于没有太时间去整理，原因baidu blog关闭了之后在也没有更新一遍Blog。作为一个老码农，总有个情怀，把自己项目中遇到的问题给记录记下来，看到好的文章转载收藏。\n\n\n","source":"_posts/开篇.md","raw":"---\ntitle: 开篇\ndate: 2016-04-20 14:33:43\ntags:\n---\n# blog开篇 \n\n 从2006年一直写到2013年1月6号最后一篇，总共500多篇。虽然Blog建了很长时间了，一直想继续去写，出于没有太时间去整理，原因baidu blog关闭了之后在也没有更新一遍Blog。作为一个老码农，总有个情怀，把自己项目中遇到的问题给记录记下来，看到好的文章转载收藏。\n\n\n","slug":"开篇","published":1,"updated":"2016-04-20T06:34:37.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot0j000rip9kqoo769ae","content":"<h1 id=\"blog开篇\"><a class=\"markdownIt-Anchor\" href=\"#blog开篇\"></a> blog开篇</h1>\n<p>从2006年一直写到2013年1月6号最后一篇，总共500多篇。虽然Blog建了很长时间了，一直想继续去写，出于没有太时间去整理，原因baidu blog关闭了之后在也没有更新一遍Blog。作为一个老码农，总有个情怀，把自己项目中遇到的问题给记录记下来，看到好的文章转载收藏。</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"blog开篇\"><a class=\"markdownIt-Anchor\" href=\"#blog开篇\"></a> blog开篇</h1>\n<p>从2006年一直写到2013年1月6号最后一篇，总共500多篇。虽然Blog建了很长时间了，一直想继续去写，出于没有太时间去整理，原因baidu blog关闭了之后在也没有更新一遍Blog。作为一个老码农，总有个情怀，把自己项目中遇到的问题给记录记下来，看到好的文章转载收藏。</p>\n"},{"title":"基于微服务器 docker下的gitlab安装","date":"2020-08-28T16:00:00.000Z","_content":"\n#  docker gitlab安装\n\n![OIP](https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/08/29/oip3.jpeg)\n\n\n\n\n\n我是在开发机器上面安装\n\n## 第一步 在宿主机器上面安装创建gitlab配置目录\n```\nmkdir -p /data/gitlab/{config,logs,data}\n```\n## 第二步 创建环境变量，指向本地宿主机存储gitlab配置的目录：\n\n```\nexport GITLAB_HOME=/data/gitlab\n```\n## 第三步 运行镜像，创建容器：\n```\ndocker run --detach \\\n--hostname 127.0.0.1 \\\n-p 8443:443 -p 8880:80 -p 8822:22 \\\n--name gitlab --restart always \\\n-v $GITLAB_HOME/config:/etc/gitlab \\\n-v $GITLAB_HOME/logs:/var/log/gitlab \\\n-v $GITLAB_HOME/data:/vat/opt/gitlab \\\ngitlab/gitlab-ce:latest\n```\n使用命令lsof -i 端口号 查看端口是否被使用\n其中由于宿主机的22端口被sshd服务使用，所以改为映射8822端口。80端口被暂用了，改成8880\nhttps 已经被占用了。\n\n> 注意： mac 1024一下的端口号需要 root权限\n\n-------\n\n## 第四步 配置gitlab\n*  配置gitlab\n容器生成后，根据需要修改gitlab的配置，直接进入宿主机本地映射的config目录，编辑gitlab.rb文件;\n* gitlab.rb文件内，主要需要配置的选项如下：\n\n```\n## GitLab NGINX\nnginx['listen_port'] = 80  # gitlab nginx 端口。默认端口为：80 \n \n## GitLab Unicorn\nunicorn['listen'] = 'localhost'\nunicorn['port'] = 8080 #默认是8080端口\n \n## GitLab URL 配置http协议所使用的访问地址\nexternal_url GENERATED_EXTERNAL_URL' # clone时显示的地址，gitlab 的域名\n \n# 配置ssh协议所使用的访问地址和端口\ngitlab_rails['gitlab_ssh_host'] = 'song.local'\ngitlab_rails['gitlab_shell_ssh_port'] = 8822\n```\n* gitlab性能相关的选项如下：\n\n```\n# 超时时间\nunicorn['worker_timeout'] = 60        \n \n#不能低于2，否则卡死 worker=CPU核数+1 \nunicorn['worker_processes'] = 2\n \n# 减少数据库缓存大小 默认256，可适当改小  \npostgresql['shared_buffers'] = \"256MB\"\n \n# 减少数据库并发数\npostgresql['max_worker_processes'] = 8\n \n# 减少sidekiq并发数\nsidekiq['concurrency'] = 10\n \n# 减少内存 \nunicorn['worker_memory_limit_min'] = \"200 * 1 << 20\"\nunicorn['worker_memory_limit_max'] = \"300 * 1 << 20\"\n```\n* 配置gitlab的邮箱服务：\n\n\n```\ngitlab_rails['smtp_enable'] = true\ngitlab_rails['smtp_address'] = \"smtp.server\"\ngitlab_rails['smtp_port'] = 465\ngitlab_rails['smtp_user_name'] = \"smtp user\"\ngitlab_rails['smtp_password'] = \"smtp password\"\ngitlab_rails['smtp_domain'] = \"example.com\"\ngitlab_rails['smtp_authentication'] = \"login\"\ngitlab_rails['smtp_enable_starttls_auto'] = true\ngitlab_rails['smtp_openssl_verify_mode'] = 'peer'\n \n# If your SMTP server does not like the default 'From: gitlab@localhost' you\n# can change the 'From' with this setting.\ngitlab_rails['gitlab_email_from'] = 'gitlab@example.com'\ngitlab_rails['gitlab_email_reply_to'] = 'noreply@example.com'\n```\n\n* 配置完成后，重启gitlab容器即可。\n\n```\ndocker restart ####\n```","source":"_posts/2020/2020-08/2020-08-29.md","raw":"---\ntitle: 基于微服务器 docker下的gitlab安装\ndate: 2020-08-29\ntags: [docker,gitlab]\n---\n\n#  docker gitlab安装\n\n![OIP](https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/08/29/oip3.jpeg)\n\n\n\n\n\n我是在开发机器上面安装\n\n## 第一步 在宿主机器上面安装创建gitlab配置目录\n```\nmkdir -p /data/gitlab/{config,logs,data}\n```\n## 第二步 创建环境变量，指向本地宿主机存储gitlab配置的目录：\n\n```\nexport GITLAB_HOME=/data/gitlab\n```\n## 第三步 运行镜像，创建容器：\n```\ndocker run --detach \\\n--hostname 127.0.0.1 \\\n-p 8443:443 -p 8880:80 -p 8822:22 \\\n--name gitlab --restart always \\\n-v $GITLAB_HOME/config:/etc/gitlab \\\n-v $GITLAB_HOME/logs:/var/log/gitlab \\\n-v $GITLAB_HOME/data:/vat/opt/gitlab \\\ngitlab/gitlab-ce:latest\n```\n使用命令lsof -i 端口号 查看端口是否被使用\n其中由于宿主机的22端口被sshd服务使用，所以改为映射8822端口。80端口被暂用了，改成8880\nhttps 已经被占用了。\n\n> 注意： mac 1024一下的端口号需要 root权限\n\n-------\n\n## 第四步 配置gitlab\n*  配置gitlab\n容器生成后，根据需要修改gitlab的配置，直接进入宿主机本地映射的config目录，编辑gitlab.rb文件;\n* gitlab.rb文件内，主要需要配置的选项如下：\n\n```\n## GitLab NGINX\nnginx['listen_port'] = 80  # gitlab nginx 端口。默认端口为：80 \n \n## GitLab Unicorn\nunicorn['listen'] = 'localhost'\nunicorn['port'] = 8080 #默认是8080端口\n \n## GitLab URL 配置http协议所使用的访问地址\nexternal_url GENERATED_EXTERNAL_URL' # clone时显示的地址，gitlab 的域名\n \n# 配置ssh协议所使用的访问地址和端口\ngitlab_rails['gitlab_ssh_host'] = 'song.local'\ngitlab_rails['gitlab_shell_ssh_port'] = 8822\n```\n* gitlab性能相关的选项如下：\n\n```\n# 超时时间\nunicorn['worker_timeout'] = 60        \n \n#不能低于2，否则卡死 worker=CPU核数+1 \nunicorn['worker_processes'] = 2\n \n# 减少数据库缓存大小 默认256，可适当改小  \npostgresql['shared_buffers'] = \"256MB\"\n \n# 减少数据库并发数\npostgresql['max_worker_processes'] = 8\n \n# 减少sidekiq并发数\nsidekiq['concurrency'] = 10\n \n# 减少内存 \nunicorn['worker_memory_limit_min'] = \"200 * 1 << 20\"\nunicorn['worker_memory_limit_max'] = \"300 * 1 << 20\"\n```\n* 配置gitlab的邮箱服务：\n\n\n```\ngitlab_rails['smtp_enable'] = true\ngitlab_rails['smtp_address'] = \"smtp.server\"\ngitlab_rails['smtp_port'] = 465\ngitlab_rails['smtp_user_name'] = \"smtp user\"\ngitlab_rails['smtp_password'] = \"smtp password\"\ngitlab_rails['smtp_domain'] = \"example.com\"\ngitlab_rails['smtp_authentication'] = \"login\"\ngitlab_rails['smtp_enable_starttls_auto'] = true\ngitlab_rails['smtp_openssl_verify_mode'] = 'peer'\n \n# If your SMTP server does not like the default 'From: gitlab@localhost' you\n# can change the 'From' with this setting.\ngitlab_rails['gitlab_email_from'] = 'gitlab@example.com'\ngitlab_rails['gitlab_email_reply_to'] = 'noreply@example.com'\n```\n\n* 配置完成后，重启gitlab容器即可。\n\n```\ndocker restart ####\n```","slug":"2020/2020-08/2020-08-29","published":1,"updated":"2020-08-29T07:40:22.445Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot21001uip9kdd7vznco","content":"<h1 id=\"docker-gitlab安装\"><a class=\"markdownIt-Anchor\" href=\"#docker-gitlab安装\"></a> docker gitlab安装</h1>\n<p><img src=\"https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/08/29/oip3.jpeg\" alt=\"OIP\"></p>\n<p>我是在开发机器上面安装</p>\n<h2 id=\"第一步-在宿主机器上面安装创建gitlab配置目录\"><a class=\"markdownIt-Anchor\" href=\"#第一步-在宿主机器上面安装创建gitlab配置目录\"></a> 第一步 在宿主机器上面安装创建gitlab配置目录</h2>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /data/gitlab/&#123;config,logs,data&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"第二步-创建环境变量指向本地宿主机存储gitlab配置的目录\"><a class=\"markdownIt-Anchor\" href=\"#第二步-创建环境变量指向本地宿主机存储gitlab配置的目录\"></a> 第二步 创建环境变量，指向本地宿主机存储gitlab配置的目录：</h2>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export GITLAB_HOME=/data/gitlab</span><br></pre></td></tr></table></figure>\n<h2 id=\"第三步-运行镜像创建容器\"><a class=\"markdownIt-Anchor\" href=\"#第三步-运行镜像创建容器\"></a> 第三步 运行镜像，创建容器：</h2>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --detach \\</span><br><span class=\"line\">--hostname 127.0.0.1 \\</span><br><span class=\"line\">-p 8443:443 -p 8880:80 -p 8822:22 \\</span><br><span class=\"line\">--name gitlab --restart always \\</span><br><span class=\"line\">-v $GITLAB_HOME/config:/etc/gitlab \\</span><br><span class=\"line\">-v $GITLAB_HOME/logs:/var/log/gitlab \\</span><br><span class=\"line\">-v $GITLAB_HOME/data:/vat/opt/gitlab \\</span><br><span class=\"line\">gitlab/gitlab-ce:latest</span><br></pre></td></tr></table></figure>\n<p>使用命令lsof -i 端口号 查看端口是否被使用<br>\n其中由于宿主机的22端口被sshd服务使用，所以改为映射8822端口。80端口被暂用了，改成8880<br>\nhttps 已经被占用了。</p>\n<blockquote>\n<p>注意： mac 1024一下的端口号需要 root权限</p>\n</blockquote>\n<hr>\n<h2 id=\"第四步-配置gitlab\"><a class=\"markdownIt-Anchor\" href=\"#第四步-配置gitlab\"></a> 第四步 配置gitlab</h2>\n<ul>\n<li>配置gitlab<br>\n容器生成后，根据需要修改gitlab的配置，直接进入宿主机本地映射的config目录，编辑gitlab.rb文件;</li>\n<li>gitlab.rb文件内，主要需要配置的选项如下：</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">## GitLab NGINX</span><br><span class=\"line\">nginx[&apos;listen_port&apos;] = 80  # gitlab nginx 端口。默认端口为：80 </span><br><span class=\"line\"> </span><br><span class=\"line\">## GitLab Unicorn</span><br><span class=\"line\">unicorn[&apos;listen&apos;] = &apos;localhost&apos;</span><br><span class=\"line\">unicorn[&apos;port&apos;] = 8080 #默认是8080端口</span><br><span class=\"line\"> </span><br><span class=\"line\">## GitLab URL 配置http协议所使用的访问地址</span><br><span class=\"line\">external_url GENERATED_EXTERNAL_URL&apos; # clone时显示的地址，gitlab 的域名</span><br><span class=\"line\"> </span><br><span class=\"line\"># 配置ssh协议所使用的访问地址和端口</span><br><span class=\"line\">gitlab_rails[&apos;gitlab_ssh_host&apos;] = &apos;song.local&apos;</span><br><span class=\"line\">gitlab_rails[&apos;gitlab_shell_ssh_port&apos;] = 8822</span><br></pre></td></tr></table></figure>\n<ul>\n<li>gitlab性能相关的选项如下：</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 超时时间</span><br><span class=\"line\">unicorn[&apos;worker_timeout&apos;] = 60        </span><br><span class=\"line\"> </span><br><span class=\"line\">#不能低于2，否则卡死 worker=CPU核数+1 </span><br><span class=\"line\">unicorn[&apos;worker_processes&apos;] = 2</span><br><span class=\"line\"> </span><br><span class=\"line\"># 减少数据库缓存大小 默认256，可适当改小  </span><br><span class=\"line\">postgresql[&apos;shared_buffers&apos;] = &quot;256MB&quot;</span><br><span class=\"line\"> </span><br><span class=\"line\"># 减少数据库并发数</span><br><span class=\"line\">postgresql[&apos;max_worker_processes&apos;] = 8</span><br><span class=\"line\"> </span><br><span class=\"line\"># 减少sidekiq并发数</span><br><span class=\"line\">sidekiq[&apos;concurrency&apos;] = 10</span><br><span class=\"line\"> </span><br><span class=\"line\"># 减少内存 </span><br><span class=\"line\">unicorn[&apos;worker_memory_limit_min&apos;] = &quot;200 * 1 &lt;&lt; 20&quot;</span><br><span class=\"line\">unicorn[&apos;worker_memory_limit_max&apos;] = &quot;300 * 1 &lt;&lt; 20&quot;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>配置gitlab的邮箱服务：</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gitlab_rails[&apos;smtp_enable&apos;] = true</span><br><span class=\"line\">gitlab_rails[&apos;smtp_address&apos;] = &quot;smtp.server&quot;</span><br><span class=\"line\">gitlab_rails[&apos;smtp_port&apos;] = 465</span><br><span class=\"line\">gitlab_rails[&apos;smtp_user_name&apos;] = &quot;smtp user&quot;</span><br><span class=\"line\">gitlab_rails[&apos;smtp_password&apos;] = &quot;smtp password&quot;</span><br><span class=\"line\">gitlab_rails[&apos;smtp_domain&apos;] = &quot;example.com&quot;</span><br><span class=\"line\">gitlab_rails[&apos;smtp_authentication&apos;] = &quot;login&quot;</span><br><span class=\"line\">gitlab_rails[&apos;smtp_enable_starttls_auto&apos;] = true</span><br><span class=\"line\">gitlab_rails[&apos;smtp_openssl_verify_mode&apos;] = &apos;peer&apos;</span><br><span class=\"line\"> </span><br><span class=\"line\"># If your SMTP server does not like the default &apos;From: gitlab@localhost&apos; you</span><br><span class=\"line\"># can change the &apos;From&apos; with this setting.</span><br><span class=\"line\">gitlab_rails[&apos;gitlab_email_from&apos;] = &apos;gitlab@example.com&apos;</span><br><span class=\"line\">gitlab_rails[&apos;gitlab_email_reply_to&apos;] = &apos;noreply@example.com&apos;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>配置完成后，重启gitlab容器即可。</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker restart ####</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"docker-gitlab安装\"><a class=\"markdownIt-Anchor\" href=\"#docker-gitlab安装\"></a> docker gitlab安装</h1>\n<p><img src=\"https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/08/29/oip3.jpeg\" alt=\"OIP\"></p>\n<p>我是在开发机器上面安装</p>\n<h2 id=\"第一步-在宿主机器上面安装创建gitlab配置目录\"><a class=\"markdownIt-Anchor\" href=\"#第一步-在宿主机器上面安装创建gitlab配置目录\"></a> 第一步 在宿主机器上面安装创建gitlab配置目录</h2>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /data/gitlab/&#123;config,logs,data&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"第二步-创建环境变量指向本地宿主机存储gitlab配置的目录\"><a class=\"markdownIt-Anchor\" href=\"#第二步-创建环境变量指向本地宿主机存储gitlab配置的目录\"></a> 第二步 创建环境变量，指向本地宿主机存储gitlab配置的目录：</h2>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export GITLAB_HOME=/data/gitlab</span><br></pre></td></tr></table></figure>\n<h2 id=\"第三步-运行镜像创建容器\"><a class=\"markdownIt-Anchor\" href=\"#第三步-运行镜像创建容器\"></a> 第三步 运行镜像，创建容器：</h2>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --detach \\</span><br><span class=\"line\">--hostname 127.0.0.1 \\</span><br><span class=\"line\">-p 8443:443 -p 8880:80 -p 8822:22 \\</span><br><span class=\"line\">--name gitlab --restart always \\</span><br><span class=\"line\">-v $GITLAB_HOME/config:/etc/gitlab \\</span><br><span class=\"line\">-v $GITLAB_HOME/logs:/var/log/gitlab \\</span><br><span class=\"line\">-v $GITLAB_HOME/data:/vat/opt/gitlab \\</span><br><span class=\"line\">gitlab/gitlab-ce:latest</span><br></pre></td></tr></table></figure>\n<p>使用命令lsof -i 端口号 查看端口是否被使用<br>\n其中由于宿主机的22端口被sshd服务使用，所以改为映射8822端口。80端口被暂用了，改成8880<br>\nhttps 已经被占用了。</p>\n<blockquote>\n<p>注意： mac 1024一下的端口号需要 root权限</p>\n</blockquote>\n<hr>\n<h2 id=\"第四步-配置gitlab\"><a class=\"markdownIt-Anchor\" href=\"#第四步-配置gitlab\"></a> 第四步 配置gitlab</h2>\n<ul>\n<li>配置gitlab<br>\n容器生成后，根据需要修改gitlab的配置，直接进入宿主机本地映射的config目录，编辑gitlab.rb文件;</li>\n<li>gitlab.rb文件内，主要需要配置的选项如下：</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">## GitLab NGINX</span><br><span class=\"line\">nginx[&apos;listen_port&apos;] = 80  # gitlab nginx 端口。默认端口为：80 </span><br><span class=\"line\"> </span><br><span class=\"line\">## GitLab Unicorn</span><br><span class=\"line\">unicorn[&apos;listen&apos;] = &apos;localhost&apos;</span><br><span class=\"line\">unicorn[&apos;port&apos;] = 8080 #默认是8080端口</span><br><span class=\"line\"> </span><br><span class=\"line\">## GitLab URL 配置http协议所使用的访问地址</span><br><span class=\"line\">external_url GENERATED_EXTERNAL_URL&apos; # clone时显示的地址，gitlab 的域名</span><br><span class=\"line\"> </span><br><span class=\"line\"># 配置ssh协议所使用的访问地址和端口</span><br><span class=\"line\">gitlab_rails[&apos;gitlab_ssh_host&apos;] = &apos;song.local&apos;</span><br><span class=\"line\">gitlab_rails[&apos;gitlab_shell_ssh_port&apos;] = 8822</span><br></pre></td></tr></table></figure>\n<ul>\n<li>gitlab性能相关的选项如下：</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 超时时间</span><br><span class=\"line\">unicorn[&apos;worker_timeout&apos;] = 60        </span><br><span class=\"line\"> </span><br><span class=\"line\">#不能低于2，否则卡死 worker=CPU核数+1 </span><br><span class=\"line\">unicorn[&apos;worker_processes&apos;] = 2</span><br><span class=\"line\"> </span><br><span class=\"line\"># 减少数据库缓存大小 默认256，可适当改小  </span><br><span class=\"line\">postgresql[&apos;shared_buffers&apos;] = &quot;256MB&quot;</span><br><span class=\"line\"> </span><br><span class=\"line\"># 减少数据库并发数</span><br><span class=\"line\">postgresql[&apos;max_worker_processes&apos;] = 8</span><br><span class=\"line\"> </span><br><span class=\"line\"># 减少sidekiq并发数</span><br><span class=\"line\">sidekiq[&apos;concurrency&apos;] = 10</span><br><span class=\"line\"> </span><br><span class=\"line\"># 减少内存 </span><br><span class=\"line\">unicorn[&apos;worker_memory_limit_min&apos;] = &quot;200 * 1 &lt;&lt; 20&quot;</span><br><span class=\"line\">unicorn[&apos;worker_memory_limit_max&apos;] = &quot;300 * 1 &lt;&lt; 20&quot;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>配置gitlab的邮箱服务：</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gitlab_rails[&apos;smtp_enable&apos;] = true</span><br><span class=\"line\">gitlab_rails[&apos;smtp_address&apos;] = &quot;smtp.server&quot;</span><br><span class=\"line\">gitlab_rails[&apos;smtp_port&apos;] = 465</span><br><span class=\"line\">gitlab_rails[&apos;smtp_user_name&apos;] = &quot;smtp user&quot;</span><br><span class=\"line\">gitlab_rails[&apos;smtp_password&apos;] = &quot;smtp password&quot;</span><br><span class=\"line\">gitlab_rails[&apos;smtp_domain&apos;] = &quot;example.com&quot;</span><br><span class=\"line\">gitlab_rails[&apos;smtp_authentication&apos;] = &quot;login&quot;</span><br><span class=\"line\">gitlab_rails[&apos;smtp_enable_starttls_auto&apos;] = true</span><br><span class=\"line\">gitlab_rails[&apos;smtp_openssl_verify_mode&apos;] = &apos;peer&apos;</span><br><span class=\"line\"> </span><br><span class=\"line\"># If your SMTP server does not like the default &apos;From: gitlab@localhost&apos; you</span><br><span class=\"line\"># can change the &apos;From&apos; with this setting.</span><br><span class=\"line\">gitlab_rails[&apos;gitlab_email_from&apos;] = &apos;gitlab@example.com&apos;</span><br><span class=\"line\">gitlab_rails[&apos;gitlab_email_reply_to&apos;] = &apos;noreply@example.com&apos;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>配置完成后，重启gitlab容器即可。</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker restart ####</span><br></pre></td></tr></table></figure>"},{"title":"Ubuntu20.04.1关闭图形界面，使用tty登陆","date":"2020-08-30T03:08:00.000Z","_content":"\n# Ubuntu 关闭图形界面，使用tty登陆\n[tty](https://baike.baidu.com/item/TTY)是终端设备的统称，TeleTYpe的一个老缩写。\n\n```bash\n# 关闭图形界面\nsudo systemctl set-default multi-user.target\nsudo reboot\n# 开启图形界面\nsudo systemctl set-default graphical.target\nsudo reboot\n```\n如果安装使用的是中文，字符显示乱码\n安装zhcon\n\n```bash\nsudo apt install zhcon\n```\n\n\n","source":"_posts/2020/2020-08/2020-08-30-1.md","raw":"---\ntitle: Ubuntu20.04.1关闭图形界面，使用tty登陆\ndate:  2020-08-30 11:08\ntags: [linux,ubuntu]\n---\n\n# Ubuntu 关闭图形界面，使用tty登陆\n[tty](https://baike.baidu.com/item/TTY)是终端设备的统称，TeleTYpe的一个老缩写。\n\n```bash\n# 关闭图形界面\nsudo systemctl set-default multi-user.target\nsudo reboot\n# 开启图形界面\nsudo systemctl set-default graphical.target\nsudo reboot\n```\n如果安装使用的是中文，字符显示乱码\n安装zhcon\n\n```bash\nsudo apt install zhcon\n```\n\n\n","slug":"2020/2020-08/2020-08-30-1","published":1,"updated":"2020-08-30T04:22:43.634Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot22001vip9kghviubus","content":"<h1 id=\"ubuntu-关闭图形界面使用tty登陆\"><a class=\"markdownIt-Anchor\" href=\"#ubuntu-关闭图形界面使用tty登陆\"></a> Ubuntu 关闭图形界面，使用tty登陆</h1>\n<p><a href=\"https://baike.baidu.com/item/TTY\" target=\"_blank\" rel=\"noopener\">tty</a>是终端设备的统称，TeleTYpe的一个老缩写。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 关闭图形界面</span></span><br><span class=\"line\">sudo systemctl <span class=\"built_in\">set</span>-default multi-user.target</span><br><span class=\"line\">sudo reboot</span><br><span class=\"line\"><span class=\"comment\"># 开启图形界面</span></span><br><span class=\"line\">sudo systemctl <span class=\"built_in\">set</span>-default graphical.target</span><br><span class=\"line\">sudo reboot</span><br></pre></td></tr></table></figure>\n<p>如果安装使用的是中文，字符显示乱码<br>\n安装zhcon</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install zhcon</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"ubuntu-关闭图形界面使用tty登陆\"><a class=\"markdownIt-Anchor\" href=\"#ubuntu-关闭图形界面使用tty登陆\"></a> Ubuntu 关闭图形界面，使用tty登陆</h1>\n<p><a href=\"https://baike.baidu.com/item/TTY\" target=\"_blank\" rel=\"noopener\">tty</a>是终端设备的统称，TeleTYpe的一个老缩写。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 关闭图形界面</span></span><br><span class=\"line\">sudo systemctl <span class=\"built_in\">set</span>-default multi-user.target</span><br><span class=\"line\">sudo reboot</span><br><span class=\"line\"><span class=\"comment\"># 开启图形界面</span></span><br><span class=\"line\">sudo systemctl <span class=\"built_in\">set</span>-default graphical.target</span><br><span class=\"line\">sudo reboot</span><br></pre></td></tr></table></figure>\n<p>如果安装使用的是中文，字符显示乱码<br>\n安装zhcon</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install zhcon</span><br></pre></td></tr></table></figure>\n"},{"title":"DIY服务器搭建，内网穿透搭建","date":"2020-08-31T09:09:00.000Z","_content":"\n起初一直在用云服务器来搭自用服务器，为什么还要用自建一个服务器？\n* 云服务价格偏高性\n* 性能达不到要求\n* IT人爱折腾，生命不止，学习不止\n\n## 服务器选择\n* 耗电量小\n* 性价比高\n* 噪声小(几乎没有噪声)\n考虑过台式工作站服务器，NAS，最终选择mini电脑当自用服务器。\n\n## 制作U盘Linux启动盘\n推荐使用工具rufus(推荐),UltraISO(不太推荐) \nrufus做好启动盘之后，不需要修改卷标\n* UltraIOS启动盘\nU盘启动电脑进入安装界面\n\n```\nvmlinuz  initrd=initrd.img  inst.stage2=hd:LABEL=CentOS\\x207\\x20x86_64 rd.live.check quiet   \n#这是按 Tab 键后的默认值；\n```\n* rufus 启动\n![启动图片](https://static01.imgkr.com/temp/3ed79857352041c88cd07e5e2fa77697.png)\n\n通常ubuntu桌面和显卡驱动不兼容，导致安装完整之后进入不到桌面\n解决方法：\n1:更换桌面管理器\n2:进入tty 按ctrl+alt+f2 \n\n```bash\nsudo apt install lightdm\nsudo service lightdm restart\n```\n\n默认启动多用户启动\n```\nsudo systemctl set-default multi-user.target\n#然后输入reboot命令重启：\n```\n单次启动图形界面:\n```\nsudo systemctl start graphical.target\nswitchdesk GNOME\",回车，再输入\"startx\n```\n默认启动为图形界面:\n\n```\nsystemctl set-default graphical.target\n#然后执行reboot命令重启系统即可。\n```\n\n\n## 设置无线上网，Ubuntu20.04.1是这个目录\n```\nvim /etc/netplan/01-network-manager-all.yaml\n#添加\n ethernets:\n          wlp1s0:   #配置的网卡的名称\n              dhcp4: no   #关闭DHCP，如果需要打开DHCP则写yes\n              dhcp6: no\n              addresses: [192.168.1.10/24]   #配置的静态ip地址和掩码\n              gateway4: 192.168.1.1       #网关地址\n              nameservers:\n                   addresses: [192.168.1.1,114.114.114.114]  #DNS服务器地址，多个DNS服务器地址需要用英文逗号分隔开\n```\n使其ip生效\n\n```\nsudo netplan apply\n```\n现在查看一下 IP是否生效\n\n```\nip addr  或者 ifconfig\n```\n\n## frp内网穿透\n设备清单：\n1. 一台云主机 \n2. 一台家用服务器\n\nfrp 官方地址：https://github.com/fatedier/frp/\nfrp 中文文档：https://github.com/fatedier/frp/blob/dev/README_zh.md\n\n我这里使用的是第三方，frpMgr极速安装包：\nhttps://github.com/Zo3i/frpMgr\n在云主机里面安装\n```\nwget -O - https://raw.githubusercontent.com/Zo3i/OCS/master/docker/docker-all2.sh | sh\nwget -O - https://raw.githubusercontent.com/Zo3i/frpMgr/master/web/src/main/docker/final/run.sh | sh\n```\n安装完成登陆：\n注：代码仅在Centos7,Debian9系统上通过测试\n\n访问:你的服务器 ip:8999/frp 账号 admin 密码 12345678\n查看日志命令：\n```\n1. docker ps\n2. docker logs -f --tail 10 java项目的容器I\n```\n如果需要修改代码,请自行编译 jar包重新部署即可..\n\n![frp后台](https://static01.imgkr.com/temp/58795ab06b954736ac04f3167e7a6290.jpg)\n\n详细FRP快捷配置面板\nhttps://github.com/Zo3i/frpMgr/blob/master/README_zh.md\n\n启动，停止，重启frps服务\n```\nservice frps status\nservice frps stop\nservice frps restart\n```\n\n\n","source":"_posts/2020/2020-08/2020-08-31.md","raw":"---\ntitle: DIY服务器搭建，内网穿透搭建\ndate:  2020-08-31 17:09\ntags: \n    - linux\n    - ubuntu\n    - frp\n    - 内网穿透\n---\n\n起初一直在用云服务器来搭自用服务器，为什么还要用自建一个服务器？\n* 云服务价格偏高性\n* 性能达不到要求\n* IT人爱折腾，生命不止，学习不止\n\n## 服务器选择\n* 耗电量小\n* 性价比高\n* 噪声小(几乎没有噪声)\n考虑过台式工作站服务器，NAS，最终选择mini电脑当自用服务器。\n\n## 制作U盘Linux启动盘\n推荐使用工具rufus(推荐),UltraISO(不太推荐) \nrufus做好启动盘之后，不需要修改卷标\n* UltraIOS启动盘\nU盘启动电脑进入安装界面\n\n```\nvmlinuz  initrd=initrd.img  inst.stage2=hd:LABEL=CentOS\\x207\\x20x86_64 rd.live.check quiet   \n#这是按 Tab 键后的默认值；\n```\n* rufus 启动\n![启动图片](https://static01.imgkr.com/temp/3ed79857352041c88cd07e5e2fa77697.png)\n\n通常ubuntu桌面和显卡驱动不兼容，导致安装完整之后进入不到桌面\n解决方法：\n1:更换桌面管理器\n2:进入tty 按ctrl+alt+f2 \n\n```bash\nsudo apt install lightdm\nsudo service lightdm restart\n```\n\n默认启动多用户启动\n```\nsudo systemctl set-default multi-user.target\n#然后输入reboot命令重启：\n```\n单次启动图形界面:\n```\nsudo systemctl start graphical.target\nswitchdesk GNOME\",回车，再输入\"startx\n```\n默认启动为图形界面:\n\n```\nsystemctl set-default graphical.target\n#然后执行reboot命令重启系统即可。\n```\n\n\n## 设置无线上网，Ubuntu20.04.1是这个目录\n```\nvim /etc/netplan/01-network-manager-all.yaml\n#添加\n ethernets:\n          wlp1s0:   #配置的网卡的名称\n              dhcp4: no   #关闭DHCP，如果需要打开DHCP则写yes\n              dhcp6: no\n              addresses: [192.168.1.10/24]   #配置的静态ip地址和掩码\n              gateway4: 192.168.1.1       #网关地址\n              nameservers:\n                   addresses: [192.168.1.1,114.114.114.114]  #DNS服务器地址，多个DNS服务器地址需要用英文逗号分隔开\n```\n使其ip生效\n\n```\nsudo netplan apply\n```\n现在查看一下 IP是否生效\n\n```\nip addr  或者 ifconfig\n```\n\n## frp内网穿透\n设备清单：\n1. 一台云主机 \n2. 一台家用服务器\n\nfrp 官方地址：https://github.com/fatedier/frp/\nfrp 中文文档：https://github.com/fatedier/frp/blob/dev/README_zh.md\n\n我这里使用的是第三方，frpMgr极速安装包：\nhttps://github.com/Zo3i/frpMgr\n在云主机里面安装\n```\nwget -O - https://raw.githubusercontent.com/Zo3i/OCS/master/docker/docker-all2.sh | sh\nwget -O - https://raw.githubusercontent.com/Zo3i/frpMgr/master/web/src/main/docker/final/run.sh | sh\n```\n安装完成登陆：\n注：代码仅在Centos7,Debian9系统上通过测试\n\n访问:你的服务器 ip:8999/frp 账号 admin 密码 12345678\n查看日志命令：\n```\n1. docker ps\n2. docker logs -f --tail 10 java项目的容器I\n```\n如果需要修改代码,请自行编译 jar包重新部署即可..\n\n![frp后台](https://static01.imgkr.com/temp/58795ab06b954736ac04f3167e7a6290.jpg)\n\n详细FRP快捷配置面板\nhttps://github.com/Zo3i/frpMgr/blob/master/README_zh.md\n\n启动，停止，重启frps服务\n```\nservice frps status\nservice frps stop\nservice frps restart\n```\n\n\n","slug":"2020/2020-08/2020-08-31","published":1,"updated":"2020-08-31T12:02:54.980Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot23001xip9k22hw7zud","content":"<p>起初一直在用云服务器来搭自用服务器，为什么还要用自建一个服务器？</p>\n<ul>\n<li>云服务价格偏高性</li>\n<li>性能达不到要求</li>\n<li>IT人爱折腾，生命不止，学习不止</li>\n</ul>\n<h2 id=\"服务器选择\"><a class=\"markdownIt-Anchor\" href=\"#服务器选择\"></a> 服务器选择</h2>\n<ul>\n<li>耗电量小</li>\n<li>性价比高</li>\n<li>噪声小(几乎没有噪声)<br>\n考虑过台式工作站服务器，NAS，最终选择mini电脑当自用服务器。</li>\n</ul>\n<h2 id=\"制作u盘linux启动盘\"><a class=\"markdownIt-Anchor\" href=\"#制作u盘linux启动盘\"></a> 制作U盘Linux启动盘</h2>\n<p>推荐使用工具rufus(推荐),UltraISO(不太推荐)<br>\nrufus做好启动盘之后，不需要修改卷标</p>\n<ul>\n<li>UltraIOS启动盘<br>\nU盘启动电脑进入安装界面</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vmlinuz  initrd=initrd.img  inst.stage2=hd:LABEL=CentOS\\x207\\x20x86_64 rd.live.check quiet   </span><br><span class=\"line\">#这是按 Tab 键后的默认值；</span><br></pre></td></tr></table></figure>\n<ul>\n<li>rufus 启动<br>\n<img src=\"https://static01.imgkr.com/temp/3ed79857352041c88cd07e5e2fa77697.png\" alt=\"启动图片\"></li>\n</ul>\n<p>通常ubuntu桌面和显卡驱动不兼容，导致安装完整之后进入不到桌面<br>\n解决方法：<br>\n1:更换桌面管理器<br>\n2:进入tty 按ctrl+alt+f2</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install lightdm</span><br><span class=\"line\">sudo service lightdm restart</span><br></pre></td></tr></table></figure>\n<p>默认启动多用户启动</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl set-default multi-user.target</span><br><span class=\"line\">#然后输入reboot命令重启：</span><br></pre></td></tr></table></figure>\n<p>单次启动图形界面:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl start graphical.target</span><br><span class=\"line\">switchdesk GNOME&quot;,回车，再输入&quot;startx</span><br></pre></td></tr></table></figure>\n<p>默认启动为图形界面:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl set-default graphical.target</span><br><span class=\"line\">#然后执行reboot命令重启系统即可。</span><br></pre></td></tr></table></figure>\n<h2 id=\"设置无线上网ubuntu20041是这个目录\"><a class=\"markdownIt-Anchor\" href=\"#设置无线上网ubuntu20041是这个目录\"></a> 设置无线上网，Ubuntu20.04.1是这个目录</h2>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/netplan/01-network-manager-all.yaml</span><br><span class=\"line\">#添加</span><br><span class=\"line\"> ethernets:</span><br><span class=\"line\">          wlp1s0:   #配置的网卡的名称</span><br><span class=\"line\">              dhcp4: no   #关闭DHCP，如果需要打开DHCP则写yes</span><br><span class=\"line\">              dhcp6: no</span><br><span class=\"line\">              addresses: [192.168.1.10/24]   #配置的静态ip地址和掩码</span><br><span class=\"line\">              gateway4: 192.168.1.1       #网关地址</span><br><span class=\"line\">              nameservers:</span><br><span class=\"line\">                   addresses: [192.168.1.1,114.114.114.114]  #DNS服务器地址，多个DNS服务器地址需要用英文逗号分隔开</span><br></pre></td></tr></table></figure>\n<p>使其ip生效</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo netplan apply</span><br></pre></td></tr></table></figure>\n<p>现在查看一下 IP是否生效</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip addr  或者 ifconfig</span><br></pre></td></tr></table></figure>\n<h2 id=\"frp内网穿透\"><a class=\"markdownIt-Anchor\" href=\"#frp内网穿透\"></a> frp内网穿透</h2>\n<p>设备清单：</p>\n<ol>\n<li>一台云主机</li>\n<li>一台家用服务器</li>\n</ol>\n<p>frp 官方地址：<a href=\"https://github.com/fatedier/frp/\" target=\"_blank\" rel=\"noopener\">https://github.com/fatedier/frp/</a><br>\nfrp 中文文档：<a href=\"https://github.com/fatedier/frp/blob/dev/README_zh.md\" target=\"_blank\" rel=\"noopener\">https://github.com/fatedier/frp/blob/dev/README_zh.md</a></p>\n<p>我这里使用的是第三方，frpMgr极速安装包：<br>\n<a href=\"https://github.com/Zo3i/frpMgr\" target=\"_blank\" rel=\"noopener\">https://github.com/Zo3i/frpMgr</a><br>\n在云主机里面安装</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -O - https://raw.githubusercontent.com/Zo3i/OCS/master/docker/docker-all2.sh | sh</span><br><span class=\"line\">wget -O - https://raw.githubusercontent.com/Zo3i/frpMgr/master/web/src/main/docker/final/run.sh | sh</span><br></pre></td></tr></table></figure>\n<p>安装完成登陆：<br>\n注：代码仅在Centos7,Debian9系统上通过测试</p>\n<p>访问:你的服务器 ip:8999/frp 账号 admin 密码 12345678<br>\n查看日志命令：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. docker ps</span><br><span class=\"line\">2. docker logs -f --tail 10 java项目的容器I</span><br></pre></td></tr></table></figure>\n<p>如果需要修改代码,请自行编译 jar包重新部署即可…</p>\n<p><img src=\"https://static01.imgkr.com/temp/58795ab06b954736ac04f3167e7a6290.jpg\" alt=\"frp后台\"></p>\n<p>详细FRP快捷配置面板<br>\n<a href=\"https://github.com/Zo3i/frpMgr/blob/master/README_zh.md\" target=\"_blank\" rel=\"noopener\">https://github.com/Zo3i/frpMgr/blob/master/README_zh.md</a></p>\n<p>启动，停止，重启frps服务</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service frps status</span><br><span class=\"line\">service frps stop</span><br><span class=\"line\">service frps restart</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>起初一直在用云服务器来搭自用服务器，为什么还要用自建一个服务器？</p>\n<ul>\n<li>云服务价格偏高性</li>\n<li>性能达不到要求</li>\n<li>IT人爱折腾，生命不止，学习不止</li>\n</ul>\n<h2 id=\"服务器选择\"><a class=\"markdownIt-Anchor\" href=\"#服务器选择\"></a> 服务器选择</h2>\n<ul>\n<li>耗电量小</li>\n<li>性价比高</li>\n<li>噪声小(几乎没有噪声)<br>\n考虑过台式工作站服务器，NAS，最终选择mini电脑当自用服务器。</li>\n</ul>\n<h2 id=\"制作u盘linux启动盘\"><a class=\"markdownIt-Anchor\" href=\"#制作u盘linux启动盘\"></a> 制作U盘Linux启动盘</h2>\n<p>推荐使用工具rufus(推荐),UltraISO(不太推荐)<br>\nrufus做好启动盘之后，不需要修改卷标</p>\n<ul>\n<li>UltraIOS启动盘<br>\nU盘启动电脑进入安装界面</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vmlinuz  initrd=initrd.img  inst.stage2=hd:LABEL=CentOS\\x207\\x20x86_64 rd.live.check quiet   </span><br><span class=\"line\">#这是按 Tab 键后的默认值；</span><br></pre></td></tr></table></figure>\n<ul>\n<li>rufus 启动<br>\n<img src=\"https://static01.imgkr.com/temp/3ed79857352041c88cd07e5e2fa77697.png\" alt=\"启动图片\"></li>\n</ul>\n<p>通常ubuntu桌面和显卡驱动不兼容，导致安装完整之后进入不到桌面<br>\n解决方法：<br>\n1:更换桌面管理器<br>\n2:进入tty 按ctrl+alt+f2</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install lightdm</span><br><span class=\"line\">sudo service lightdm restart</span><br></pre></td></tr></table></figure>\n<p>默认启动多用户启动</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl set-default multi-user.target</span><br><span class=\"line\">#然后输入reboot命令重启：</span><br></pre></td></tr></table></figure>\n<p>单次启动图形界面:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl start graphical.target</span><br><span class=\"line\">switchdesk GNOME&quot;,回车，再输入&quot;startx</span><br></pre></td></tr></table></figure>\n<p>默认启动为图形界面:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl set-default graphical.target</span><br><span class=\"line\">#然后执行reboot命令重启系统即可。</span><br></pre></td></tr></table></figure>\n<h2 id=\"设置无线上网ubuntu20041是这个目录\"><a class=\"markdownIt-Anchor\" href=\"#设置无线上网ubuntu20041是这个目录\"></a> 设置无线上网，Ubuntu20.04.1是这个目录</h2>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/netplan/01-network-manager-all.yaml</span><br><span class=\"line\">#添加</span><br><span class=\"line\"> ethernets:</span><br><span class=\"line\">          wlp1s0:   #配置的网卡的名称</span><br><span class=\"line\">              dhcp4: no   #关闭DHCP，如果需要打开DHCP则写yes</span><br><span class=\"line\">              dhcp6: no</span><br><span class=\"line\">              addresses: [192.168.1.10/24]   #配置的静态ip地址和掩码</span><br><span class=\"line\">              gateway4: 192.168.1.1       #网关地址</span><br><span class=\"line\">              nameservers:</span><br><span class=\"line\">                   addresses: [192.168.1.1,114.114.114.114]  #DNS服务器地址，多个DNS服务器地址需要用英文逗号分隔开</span><br></pre></td></tr></table></figure>\n<p>使其ip生效</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo netplan apply</span><br></pre></td></tr></table></figure>\n<p>现在查看一下 IP是否生效</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip addr  或者 ifconfig</span><br></pre></td></tr></table></figure>\n<h2 id=\"frp内网穿透\"><a class=\"markdownIt-Anchor\" href=\"#frp内网穿透\"></a> frp内网穿透</h2>\n<p>设备清单：</p>\n<ol>\n<li>一台云主机</li>\n<li>一台家用服务器</li>\n</ol>\n<p>frp 官方地址：<a href=\"https://github.com/fatedier/frp/\" target=\"_blank\" rel=\"noopener\">https://github.com/fatedier/frp/</a><br>\nfrp 中文文档：<a href=\"https://github.com/fatedier/frp/blob/dev/README_zh.md\" target=\"_blank\" rel=\"noopener\">https://github.com/fatedier/frp/blob/dev/README_zh.md</a></p>\n<p>我这里使用的是第三方，frpMgr极速安装包：<br>\n<a href=\"https://github.com/Zo3i/frpMgr\" target=\"_blank\" rel=\"noopener\">https://github.com/Zo3i/frpMgr</a><br>\n在云主机里面安装</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -O - https://raw.githubusercontent.com/Zo3i/OCS/master/docker/docker-all2.sh | sh</span><br><span class=\"line\">wget -O - https://raw.githubusercontent.com/Zo3i/frpMgr/master/web/src/main/docker/final/run.sh | sh</span><br></pre></td></tr></table></figure>\n<p>安装完成登陆：<br>\n注：代码仅在Centos7,Debian9系统上通过测试</p>\n<p>访问:你的服务器 ip:8999/frp 账号 admin 密码 12345678<br>\n查看日志命令：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. docker ps</span><br><span class=\"line\">2. docker logs -f --tail 10 java项目的容器I</span><br></pre></td></tr></table></figure>\n<p>如果需要修改代码,请自行编译 jar包重新部署即可…</p>\n<p><img src=\"https://static01.imgkr.com/temp/58795ab06b954736ac04f3167e7a6290.jpg\" alt=\"frp后台\"></p>\n<p>详细FRP快捷配置面板<br>\n<a href=\"https://github.com/Zo3i/frpMgr/blob/master/README_zh.md\" target=\"_blank\" rel=\"noopener\">https://github.com/Zo3i/frpMgr/blob/master/README_zh.md</a></p>\n<p>启动，停止，重启frps服务</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service frps status</span><br><span class=\"line\">service frps stop</span><br><span class=\"line\">service frps restart</span><br></pre></td></tr></table></figure>\n"},{"title":"更换了Hexo博客主题pure使用","date":"2020-08-29T16:00:00.000Z","_content":"\n\n# 重新换了个清新的blog模版\n\n![1598719074737](https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/08/30/1598719074737.jpg)\n\n看着还不错，后续坚持分享更多有。欢迎大家留言\n","source":"_posts/2020/2020-08/2020-08-30.md","raw":"---\ntitle: 更换了Hexo博客主题pure使用\ndate: 2020-08-30\ntags: [hexo,pure]\n---\n\n\n# 重新换了个清新的blog模版\n\n![1598719074737](https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/08/30/1598719074737.jpg)\n\n看着还不错，后续坚持分享更多有。欢迎大家留言\n","slug":"2020/2020-08/2020-08-30","published":1,"updated":"2020-08-29T16:45:42.856Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot24001yip9ki4yyvuq7","content":"<h1 id=\"重新换了个清新的blog模版\"><a class=\"markdownIt-Anchor\" href=\"#重新换了个清新的blog模版\"></a> 重新换了个清新的blog模版</h1>\n<p><img src=\"https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/08/30/1598719074737.jpg\" alt=\"1598719074737\"></p>\n<p>看着还不错，后续坚持分享更多有。欢迎大家留言</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"重新换了个清新的blog模版\"><a class=\"markdownIt-Anchor\" href=\"#重新换了个清新的blog模版\"></a> 重新换了个清新的blog模版</h1>\n<p><img src=\"https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/08/30/1598719074737.jpg\" alt=\"1598719074737\"></p>\n<p>看着还不错，后续坚持分享更多有。欢迎大家留言</p>\n"},{"title":"图解Golang的内存管理分配","date":"2020-09-02T16:00:00.000Z","_content":"\ngo主要有以下五种内存存储区(c/c++也是一样)：\n\n![内存分配](https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/09/03/1599064164048.jpg)\n\n\n## Go的内存分配核心思想\nGo是内置运行时的编程语言(`runtime`)，像这种内置运行时的编程语言通常会抛弃传统的内存分配方式，改为自己管理。这样可以完成类似预分配、内存池等操作，以避开系统调用带来的性能问题，防止每次分配内存都需要系统调用。\n\n用户线程的调度以及生命周期管理都是用户层面，Go语言自己实现的，不借助OS系统调用，减少系统资源消耗。\n\nGo的内存分配的核心思想可以分为以下几点：\n* 每次从操作系统申请一大块儿的内存，由Go来对这块儿内存做分配，减少系统调用\n* 内存分配算法采用Google的[TCMalloc](http://goog-perftools.sourceforge.net/doc/tcmalloc.html)算法。算法比较复杂，究其原理可自行查阅。其核心思想就是把内存切分的非常的细小，分为多级管理，以降低锁的粒度。\n* 回收对象内存时，并没有将其真正释放掉，只是放回预先分配的大块内存中，以便复用。只有内存闲置过多的时候，才会尝试归还部分内存给操作系统，降低整体开销\n\n业界比较出名的内存分配器有Google的`tcmalloc`和Facebook的`jemalloc`。二者在避免内存碎片和性能上均比glic有比较大的优势，在多线程环境中效果更明显。\n\n## 程序在内存中的分布\n![程序内存运行](https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/09/03/cheng-xu-nei-cun-yun-xing.jpg)\n\n* 代码段(`.text`)，也称文本段(Text Segment)，存放着程序的机器码和只读数据，可执行指令就是从这里取得的。如果可能，系统会安排好相同程序的多个运行实体共享这些实例代码。这个段在内存中一般被标记为只读，任何对该区的写操作都会导致段错误（Segmentation Fault）\n* 数据段，包括已初始化的数据段(`.data`)和未初始化的数据段（`.bss`），前者用来存放保存全局的和静态的已初始化变量，后者用来保存全局的和静态的未初始化变量。数据段在编译时分配\n* 堆栈段分为堆和栈：\n    * 堆（`Heap`）：用来存储程序运行时分配的变量。堆的大小并不固定，可动态扩张或缩减。其分配由malloc()、new()等这类实时内存分配函数来实现。当进程调用malloc等函数分配内存时，新分配的内存就被动态添加到堆上（堆被扩张）；当利用free          等函数释放内存时，被释放的内存从堆中被剔除（堆被缩减） 堆的内存释放由应用程序去控制，通常一个new()就要对应一个delete()，如果程序员没有释放掉，那么在程序结束后操作系统会自动回收。\n    * 栈（`Stack`）是一种用来存储函数调用时的临时信息的结构，如函数调用所传递的参数、函数的返回地址、函数的局部变量等。 在程序运行时由编译器在需要的时候分配，在不需要的时候自动清除。\n    \n       栈的特性: 最后一个放入栈中的物体总是被最先拿出来，这个特性通常称为先进后出(FILO)队列。`\n      栈的基本操作： PUSH操作：向栈中添加数据，称为压栈，数据将放置在栈顶； POP操作：POP操作相反，在栈顶部移去一个元素，并将栈的大小减一，称为弹栈。\n\n## 堆和栈的区别 \n* 分配和管理方式不同 ：\n    * 堆是动态分配的，其空间的分配和释放都由程序员控制。\n    * 栈由编译器自动管理。栈有两种分配方式：静态分配和动态分配。\n        * 静态分配由编译器完成，比如局部变量的分配。\n        * 动态分配由alloca()函数进行分配，但是栈的动态分配和堆是不同的，它的动态分配是由编译器进行释放，无须手工控制。\n\n* 产生碎片不同\n    * 对堆来说，频繁的new/delete或者malloc/free势必会造成内存空间的不连续，造成大量的碎片，使程序效率降低。\n    * 对栈而言，则不存在碎片问题，因为栈是先进后出的队列，永远不可能有一个内存块从栈中间弹出。\n    \n* 生长方向不同\n    * 堆是向着内存地址增加的方向增长的，从内存的低地址向高地址方向增长。\n    * 栈的生长方向与之相反，是向着内存地址减小的方向增长，由内存的高地址向低地址方向增长。       \n        \n了解更多：\n1. [图解TCMalloc](https://zhuanlan.zhihu.com/p/29216091) goole内存分配器\n2. [C/C++程序的5种内存存储区及示意](https://blog.csdn.net/cxsydjn/article/details/79487805)\n\n*参考文献:*\n* *程序在内存中的分布 https://www.cnblogs.com/Lynn-Zhang/p/5449199.html*\n* *从内存分配开始 https://mp.weixin.qq.com/s/EyWKFRu1xryoHY386QUcuA*\n* *译文：Go 内存分配器可视化指南 https://www.linuxzen.com/go-memory-allocator-visual-guide.html*\n* *图解Go语言内存分配 https://juejin.im/post/5c888a79e51d456ed11955a8*\n* *Golang源码探索(三) GC的实现原理 https://www.cnblogs.com/zkweb/p/7880099.html*\n* *《Go专家编程》Go 内存管理 https://my.oschina.net/renhc/blog/2236782?spm=a2c4e.10696291.0.0.a8e219a4hLvsZx*\n* *雨痕<<Go源码解析>>\ngo内存分配(英文) https://andrestc.com/post/go-memory-allocation-pt1/*\n\n\n","source":"_posts/2020/2020-09/2020-09-02.md","raw":"---\ntitle: 图解Golang的内存管理分配\ndate: 2020-09-03\ntags: \n    - go\n    - c\n    - c++\n    -  内存\n    -  堆栈\n---\n\ngo主要有以下五种内存存储区(c/c++也是一样)：\n\n![内存分配](https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/09/03/1599064164048.jpg)\n\n\n## Go的内存分配核心思想\nGo是内置运行时的编程语言(`runtime`)，像这种内置运行时的编程语言通常会抛弃传统的内存分配方式，改为自己管理。这样可以完成类似预分配、内存池等操作，以避开系统调用带来的性能问题，防止每次分配内存都需要系统调用。\n\n用户线程的调度以及生命周期管理都是用户层面，Go语言自己实现的，不借助OS系统调用，减少系统资源消耗。\n\nGo的内存分配的核心思想可以分为以下几点：\n* 每次从操作系统申请一大块儿的内存，由Go来对这块儿内存做分配，减少系统调用\n* 内存分配算法采用Google的[TCMalloc](http://goog-perftools.sourceforge.net/doc/tcmalloc.html)算法。算法比较复杂，究其原理可自行查阅。其核心思想就是把内存切分的非常的细小，分为多级管理，以降低锁的粒度。\n* 回收对象内存时，并没有将其真正释放掉，只是放回预先分配的大块内存中，以便复用。只有内存闲置过多的时候，才会尝试归还部分内存给操作系统，降低整体开销\n\n业界比较出名的内存分配器有Google的`tcmalloc`和Facebook的`jemalloc`。二者在避免内存碎片和性能上均比glic有比较大的优势，在多线程环境中效果更明显。\n\n## 程序在内存中的分布\n![程序内存运行](https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/09/03/cheng-xu-nei-cun-yun-xing.jpg)\n\n* 代码段(`.text`)，也称文本段(Text Segment)，存放着程序的机器码和只读数据，可执行指令就是从这里取得的。如果可能，系统会安排好相同程序的多个运行实体共享这些实例代码。这个段在内存中一般被标记为只读，任何对该区的写操作都会导致段错误（Segmentation Fault）\n* 数据段，包括已初始化的数据段(`.data`)和未初始化的数据段（`.bss`），前者用来存放保存全局的和静态的已初始化变量，后者用来保存全局的和静态的未初始化变量。数据段在编译时分配\n* 堆栈段分为堆和栈：\n    * 堆（`Heap`）：用来存储程序运行时分配的变量。堆的大小并不固定，可动态扩张或缩减。其分配由malloc()、new()等这类实时内存分配函数来实现。当进程调用malloc等函数分配内存时，新分配的内存就被动态添加到堆上（堆被扩张）；当利用free          等函数释放内存时，被释放的内存从堆中被剔除（堆被缩减） 堆的内存释放由应用程序去控制，通常一个new()就要对应一个delete()，如果程序员没有释放掉，那么在程序结束后操作系统会自动回收。\n    * 栈（`Stack`）是一种用来存储函数调用时的临时信息的结构，如函数调用所传递的参数、函数的返回地址、函数的局部变量等。 在程序运行时由编译器在需要的时候分配，在不需要的时候自动清除。\n    \n       栈的特性: 最后一个放入栈中的物体总是被最先拿出来，这个特性通常称为先进后出(FILO)队列。`\n      栈的基本操作： PUSH操作：向栈中添加数据，称为压栈，数据将放置在栈顶； POP操作：POP操作相反，在栈顶部移去一个元素，并将栈的大小减一，称为弹栈。\n\n## 堆和栈的区别 \n* 分配和管理方式不同 ：\n    * 堆是动态分配的，其空间的分配和释放都由程序员控制。\n    * 栈由编译器自动管理。栈有两种分配方式：静态分配和动态分配。\n        * 静态分配由编译器完成，比如局部变量的分配。\n        * 动态分配由alloca()函数进行分配，但是栈的动态分配和堆是不同的，它的动态分配是由编译器进行释放，无须手工控制。\n\n* 产生碎片不同\n    * 对堆来说，频繁的new/delete或者malloc/free势必会造成内存空间的不连续，造成大量的碎片，使程序效率降低。\n    * 对栈而言，则不存在碎片问题，因为栈是先进后出的队列，永远不可能有一个内存块从栈中间弹出。\n    \n* 生长方向不同\n    * 堆是向着内存地址增加的方向增长的，从内存的低地址向高地址方向增长。\n    * 栈的生长方向与之相反，是向着内存地址减小的方向增长，由内存的高地址向低地址方向增长。       \n        \n了解更多：\n1. [图解TCMalloc](https://zhuanlan.zhihu.com/p/29216091) goole内存分配器\n2. [C/C++程序的5种内存存储区及示意](https://blog.csdn.net/cxsydjn/article/details/79487805)\n\n*参考文献:*\n* *程序在内存中的分布 https://www.cnblogs.com/Lynn-Zhang/p/5449199.html*\n* *从内存分配开始 https://mp.weixin.qq.com/s/EyWKFRu1xryoHY386QUcuA*\n* *译文：Go 内存分配器可视化指南 https://www.linuxzen.com/go-memory-allocator-visual-guide.html*\n* *图解Go语言内存分配 https://juejin.im/post/5c888a79e51d456ed11955a8*\n* *Golang源码探索(三) GC的实现原理 https://www.cnblogs.com/zkweb/p/7880099.html*\n* *《Go专家编程》Go 内存管理 https://my.oschina.net/renhc/blog/2236782?spm=a2c4e.10696291.0.0.a8e219a4hLvsZx*\n* *雨痕<<Go源码解析>>\ngo内存分配(英文) https://andrestc.com/post/go-memory-allocation-pt1/*\n\n\n","slug":"2020/2020-09/2020-09-02","published":1,"updated":"2020-09-03T03:05:20.989Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot25001zip9kr5bh9ze8","content":"<p>go主要有以下五种内存存储区(c/c++也是一样)：</p>\n<p><img src=\"https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/09/03/1599064164048.jpg\" alt=\"内存分配\"></p>\n<h2 id=\"go的内存分配核心思想\"><a class=\"markdownIt-Anchor\" href=\"#go的内存分配核心思想\"></a> Go的内存分配核心思想</h2>\n<p>Go是内置运行时的编程语言(<code>runtime</code>)，像这种内置运行时的编程语言通常会抛弃传统的内存分配方式，改为自己管理。这样可以完成类似预分配、内存池等操作，以避开系统调用带来的性能问题，防止每次分配内存都需要系统调用。</p>\n<p>用户线程的调度以及生命周期管理都是用户层面，Go语言自己实现的，不借助OS系统调用，减少系统资源消耗。</p>\n<p>Go的内存分配的核心思想可以分为以下几点：</p>\n<ul>\n<li>每次从操作系统申请一大块儿的内存，由Go来对这块儿内存做分配，减少系统调用</li>\n<li>内存分配算法采用Google的<a href=\"http://goog-perftools.sourceforge.net/doc/tcmalloc.html\" target=\"_blank\" rel=\"noopener\">TCMalloc</a>算法。算法比较复杂，究其原理可自行查阅。其核心思想就是把内存切分的非常的细小，分为多级管理，以降低锁的粒度。</li>\n<li>回收对象内存时，并没有将其真正释放掉，只是放回预先分配的大块内存中，以便复用。只有内存闲置过多的时候，才会尝试归还部分内存给操作系统，降低整体开销</li>\n</ul>\n<p>业界比较出名的内存分配器有Google的<code>tcmalloc</code>和Facebook的<code>jemalloc</code>。二者在避免内存碎片和性能上均比glic有比较大的优势，在多线程环境中效果更明显。</p>\n<h2 id=\"程序在内存中的分布\"><a class=\"markdownIt-Anchor\" href=\"#程序在内存中的分布\"></a> 程序在内存中的分布</h2>\n<p><img src=\"https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/09/03/cheng-xu-nei-cun-yun-xing.jpg\" alt=\"程序内存运行\"></p>\n<ul>\n<li>代码段(<code>.text</code>)，也称文本段(Text Segment)，存放着程序的机器码和只读数据，可执行指令就是从这里取得的。如果可能，系统会安排好相同程序的多个运行实体共享这些实例代码。这个段在内存中一般被标记为只读，任何对该区的写操作都会导致段错误（Segmentation Fault）</li>\n<li>数据段，包括已初始化的数据段(<code>.data</code>)和未初始化的数据段（<code>.bss</code>），前者用来存放保存全局的和静态的已初始化变量，后者用来保存全局的和静态的未初始化变量。数据段在编译时分配</li>\n<li>堆栈段分为堆和栈：\n<ul>\n<li>\n<p>堆（<code>Heap</code>）：用来存储程序运行时分配的变量。堆的大小并不固定，可动态扩张或缩减。其分配由malloc()、new()等这类实时内存分配函数来实现。当进程调用malloc等函数分配内存时，新分配的内存就被动态添加到堆上（堆被扩张）；当利用free          等函数释放内存时，被释放的内存从堆中被剔除（堆被缩减） 堆的内存释放由应用程序去控制，通常一个new()就要对应一个delete()，如果程序员没有释放掉，那么在程序结束后操作系统会自动回收。</p>\n</li>\n<li>\n<p>栈（<code>Stack</code>）是一种用来存储函数调用时的临时信息的结构，如函数调用所传递的参数、函数的返回地址、函数的局部变量等。 在程序运行时由编译器在需要的时候分配，在不需要的时候自动清除。</p>\n<p>栈的特性: 最后一个放入栈中的物体总是被最先拿出来，这个特性通常称为先进后出(FILO)队列。`<br>\n栈的基本操作： PUSH操作：向栈中添加数据，称为压栈，数据将放置在栈顶； POP操作：POP操作相反，在栈顶部移去一个元素，并将栈的大小减一，称为弹栈。</p>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"堆和栈的区别\"><a class=\"markdownIt-Anchor\" href=\"#堆和栈的区别\"></a> 堆和栈的区别</h2>\n<ul>\n<li>\n<p>分配和管理方式不同 ：</p>\n<ul>\n<li>堆是动态分配的，其空间的分配和释放都由程序员控制。</li>\n<li>栈由编译器自动管理。栈有两种分配方式：静态分配和动态分配。\n<ul>\n<li>静态分配由编译器完成，比如局部变量的分配。</li>\n<li>动态分配由alloca()函数进行分配，但是栈的动态分配和堆是不同的，它的动态分配是由编译器进行释放，无须手工控制。</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>产生碎片不同</p>\n<ul>\n<li>对堆来说，频繁的new/delete或者malloc/free势必会造成内存空间的不连续，造成大量的碎片，使程序效率降低。</li>\n<li>对栈而言，则不存在碎片问题，因为栈是先进后出的队列，永远不可能有一个内存块从栈中间弹出。</li>\n</ul>\n</li>\n<li>\n<p>生长方向不同</p>\n<ul>\n<li>堆是向着内存地址增加的方向增长的，从内存的低地址向高地址方向增长。</li>\n<li>栈的生长方向与之相反，是向着内存地址减小的方向增长，由内存的高地址向低地址方向增长。</li>\n</ul>\n</li>\n</ul>\n<p>了解更多：</p>\n<ol>\n<li><a href=\"https://zhuanlan.zhihu.com/p/29216091\" target=\"_blank\" rel=\"noopener\">图解TCMalloc</a> goole内存分配器</li>\n<li><a href=\"https://blog.csdn.net/cxsydjn/article/details/79487805\" target=\"_blank\" rel=\"noopener\">C/C++程序的5种内存存储区及示意</a></li>\n</ol>\n<p><em>参考文献:</em></p>\n<ul>\n<li><em>程序在内存中的分布 <a href=\"https://www.cnblogs.com/Lynn-Zhang/p/5449199.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/Lynn-Zhang/p/5449199.html</a></em></li>\n<li><em>从内存分配开始 <a href=\"https://mp.weixin.qq.com/s/EyWKFRu1xryoHY386QUcuA\" target=\"_blank\" rel=\"noopener\">https://mp.weixin.qq.com/s/EyWKFRu1xryoHY386QUcuA</a></em></li>\n<li><em>译文：Go 内存分配器可视化指南 <a href=\"https://www.linuxzen.com/go-memory-allocator-visual-guide.html\" target=\"_blank\" rel=\"noopener\">https://www.linuxzen.com/go-memory-allocator-visual-guide.html</a></em></li>\n<li><em>图解Go语言内存分配 <a href=\"https://juejin.im/post/5c888a79e51d456ed11955a8\" target=\"_blank\" rel=\"noopener\">https://juejin.im/post/5c888a79e51d456ed11955a8</a></em></li>\n<li><em>Golang源码探索(三) GC的实现原理 <a href=\"https://www.cnblogs.com/zkweb/p/7880099.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/zkweb/p/7880099.html</a></em></li>\n<li><em>《Go专家编程》Go 内存管理 <a href=\"https://my.oschina.net/renhc/blog/2236782?spm=a2c4e.10696291.0.0.a8e219a4hLvsZx\" target=\"_blank\" rel=\"noopener\">https://my.oschina.net/renhc/blog/2236782?spm=a2c4e.10696291.0.0.a8e219a4hLvsZx</a></em></li>\n<li><em>雨痕&lt;&lt;Go源码解析&gt;&gt;<br>\ngo内存分配(英文) <a href=\"https://andrestc.com/post/go-memory-allocation-pt1/\" target=\"_blank\" rel=\"noopener\">https://andrestc.com/post/go-memory-allocation-pt1/</a></em></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>go主要有以下五种内存存储区(c/c++也是一样)：</p>\n<p><img src=\"https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/09/03/1599064164048.jpg\" alt=\"内存分配\"></p>\n<h2 id=\"go的内存分配核心思想\"><a class=\"markdownIt-Anchor\" href=\"#go的内存分配核心思想\"></a> Go的内存分配核心思想</h2>\n<p>Go是内置运行时的编程语言(<code>runtime</code>)，像这种内置运行时的编程语言通常会抛弃传统的内存分配方式，改为自己管理。这样可以完成类似预分配、内存池等操作，以避开系统调用带来的性能问题，防止每次分配内存都需要系统调用。</p>\n<p>用户线程的调度以及生命周期管理都是用户层面，Go语言自己实现的，不借助OS系统调用，减少系统资源消耗。</p>\n<p>Go的内存分配的核心思想可以分为以下几点：</p>\n<ul>\n<li>每次从操作系统申请一大块儿的内存，由Go来对这块儿内存做分配，减少系统调用</li>\n<li>内存分配算法采用Google的<a href=\"http://goog-perftools.sourceforge.net/doc/tcmalloc.html\" target=\"_blank\" rel=\"noopener\">TCMalloc</a>算法。算法比较复杂，究其原理可自行查阅。其核心思想就是把内存切分的非常的细小，分为多级管理，以降低锁的粒度。</li>\n<li>回收对象内存时，并没有将其真正释放掉，只是放回预先分配的大块内存中，以便复用。只有内存闲置过多的时候，才会尝试归还部分内存给操作系统，降低整体开销</li>\n</ul>\n<p>业界比较出名的内存分配器有Google的<code>tcmalloc</code>和Facebook的<code>jemalloc</code>。二者在避免内存碎片和性能上均比glic有比较大的优势，在多线程环境中效果更明显。</p>\n<h2 id=\"程序在内存中的分布\"><a class=\"markdownIt-Anchor\" href=\"#程序在内存中的分布\"></a> 程序在内存中的分布</h2>\n<p><img src=\"https://webwlsong-1301722012.cos.ap-shanghai.myqcloud.com/mweb/2020/09/03/cheng-xu-nei-cun-yun-xing.jpg\" alt=\"程序内存运行\"></p>\n<ul>\n<li>代码段(<code>.text</code>)，也称文本段(Text Segment)，存放着程序的机器码和只读数据，可执行指令就是从这里取得的。如果可能，系统会安排好相同程序的多个运行实体共享这些实例代码。这个段在内存中一般被标记为只读，任何对该区的写操作都会导致段错误（Segmentation Fault）</li>\n<li>数据段，包括已初始化的数据段(<code>.data</code>)和未初始化的数据段（<code>.bss</code>），前者用来存放保存全局的和静态的已初始化变量，后者用来保存全局的和静态的未初始化变量。数据段在编译时分配</li>\n<li>堆栈段分为堆和栈：\n<ul>\n<li>\n<p>堆（<code>Heap</code>）：用来存储程序运行时分配的变量。堆的大小并不固定，可动态扩张或缩减。其分配由malloc()、new()等这类实时内存分配函数来实现。当进程调用malloc等函数分配内存时，新分配的内存就被动态添加到堆上（堆被扩张）；当利用free          等函数释放内存时，被释放的内存从堆中被剔除（堆被缩减） 堆的内存释放由应用程序去控制，通常一个new()就要对应一个delete()，如果程序员没有释放掉，那么在程序结束后操作系统会自动回收。</p>\n</li>\n<li>\n<p>栈（<code>Stack</code>）是一种用来存储函数调用时的临时信息的结构，如函数调用所传递的参数、函数的返回地址、函数的局部变量等。 在程序运行时由编译器在需要的时候分配，在不需要的时候自动清除。</p>\n<p>栈的特性: 最后一个放入栈中的物体总是被最先拿出来，这个特性通常称为先进后出(FILO)队列。`<br>\n栈的基本操作： PUSH操作：向栈中添加数据，称为压栈，数据将放置在栈顶； POP操作：POP操作相反，在栈顶部移去一个元素，并将栈的大小减一，称为弹栈。</p>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"堆和栈的区别\"><a class=\"markdownIt-Anchor\" href=\"#堆和栈的区别\"></a> 堆和栈的区别</h2>\n<ul>\n<li>\n<p>分配和管理方式不同 ：</p>\n<ul>\n<li>堆是动态分配的，其空间的分配和释放都由程序员控制。</li>\n<li>栈由编译器自动管理。栈有两种分配方式：静态分配和动态分配。\n<ul>\n<li>静态分配由编译器完成，比如局部变量的分配。</li>\n<li>动态分配由alloca()函数进行分配，但是栈的动态分配和堆是不同的，它的动态分配是由编译器进行释放，无须手工控制。</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>产生碎片不同</p>\n<ul>\n<li>对堆来说，频繁的new/delete或者malloc/free势必会造成内存空间的不连续，造成大量的碎片，使程序效率降低。</li>\n<li>对栈而言，则不存在碎片问题，因为栈是先进后出的队列，永远不可能有一个内存块从栈中间弹出。</li>\n</ul>\n</li>\n<li>\n<p>生长方向不同</p>\n<ul>\n<li>堆是向着内存地址增加的方向增长的，从内存的低地址向高地址方向增长。</li>\n<li>栈的生长方向与之相反，是向着内存地址减小的方向增长，由内存的高地址向低地址方向增长。</li>\n</ul>\n</li>\n</ul>\n<p>了解更多：</p>\n<ol>\n<li><a href=\"https://zhuanlan.zhihu.com/p/29216091\" target=\"_blank\" rel=\"noopener\">图解TCMalloc</a> goole内存分配器</li>\n<li><a href=\"https://blog.csdn.net/cxsydjn/article/details/79487805\" target=\"_blank\" rel=\"noopener\">C/C++程序的5种内存存储区及示意</a></li>\n</ol>\n<p><em>参考文献:</em></p>\n<ul>\n<li><em>程序在内存中的分布 <a href=\"https://www.cnblogs.com/Lynn-Zhang/p/5449199.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/Lynn-Zhang/p/5449199.html</a></em></li>\n<li><em>从内存分配开始 <a href=\"https://mp.weixin.qq.com/s/EyWKFRu1xryoHY386QUcuA\" target=\"_blank\" rel=\"noopener\">https://mp.weixin.qq.com/s/EyWKFRu1xryoHY386QUcuA</a></em></li>\n<li><em>译文：Go 内存分配器可视化指南 <a href=\"https://www.linuxzen.com/go-memory-allocator-visual-guide.html\" target=\"_blank\" rel=\"noopener\">https://www.linuxzen.com/go-memory-allocator-visual-guide.html</a></em></li>\n<li><em>图解Go语言内存分配 <a href=\"https://juejin.im/post/5c888a79e51d456ed11955a8\" target=\"_blank\" rel=\"noopener\">https://juejin.im/post/5c888a79e51d456ed11955a8</a></em></li>\n<li><em>Golang源码探索(三) GC的实现原理 <a href=\"https://www.cnblogs.com/zkweb/p/7880099.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/zkweb/p/7880099.html</a></em></li>\n<li><em>《Go专家编程》Go 内存管理 <a href=\"https://my.oschina.net/renhc/blog/2236782?spm=a2c4e.10696291.0.0.a8e219a4hLvsZx\" target=\"_blank\" rel=\"noopener\">https://my.oschina.net/renhc/blog/2236782?spm=a2c4e.10696291.0.0.a8e219a4hLvsZx</a></em></li>\n<li><em>雨痕&lt;&lt;Go源码解析&gt;&gt;<br>\ngo内存分配(英文) <a href=\"https://andrestc.com/post/go-memory-allocation-pt1/\" target=\"_blank\" rel=\"noopener\">https://andrestc.com/post/go-memory-allocation-pt1/</a></em></li>\n</ul>\n"},{"title":"Mac用串口(ttl)连接树莓派3b+以及串口调试","date":"+020202-09-06T16:00:00.000Z","_content":"\n## MacOSX用串口(TTL)连接树莓派\n* 树莓派在没有显示使用时，可以使用usb串口转ttl进行连接。\nUSB转ttl线 CP2102下载对应的驱动\nUSB转TTL 驱动下载地址：http://pan.baidu.com/s/1mgCFd9m\n安装完成后重启系统，插入 USB to TTL 线可查询串口设备。\n\n```bash\n$ ls /dev/tty.usbserial*   #在Mac是这个，去查看。插拔usb能够看到对应的设备\n/dev/tty.usbserial\n```\nUSB转TTL线\n\n![usbtoTTL](https://static01.imgkr.com/temp/9473f3e37795437a8308ee3958e229b2.jpg)\n\n树莓派3b+引脚图\n![树莓派3b+引脚图](https://static01.imgkr.com/temp/db5437d45d5246f79854c980d739768a.jpeg)\n\nUSB to TTL 线与树莓派针脚对应关系为：\nGND -> GND\nRXD -> GPIO 14(TXD)\nTXD -> GPIO 15(RXD)\nVCC -> 悬空 (切记, 不要乱接)\n\n注意: 一定按照上面的对应关系，不要接成一样的。\n\n### 配置minicom参数\n运行\n\n```bash\nsudo minicom -s\n```\n进入minicom界面\n\n```text\n\n            ┌─────[configuration]──────┐\n            │ Filenames and paths      │\n            │ File transfer protocols  │\n            │ Serial port setup        │\n            │ Modem and dialing        │\n            │ Screen and keyboard      │\n            │ Save setup as dfl        │\n            │ Save setup as..          │\n            │ Exit                     │\n            │ Exit from Minicom        │\n            └──────────────────────────┘\n```\n使用上下键选择Serial port setup，回车。此时停留在change which setting?  通过A,B,C,D选项设置对应的参数设置例如下\n\n```text\n\n    ┌───────────────────────────────────────────────────────────────────────┐\n    │ A -    Serial Device      : /dev/modem                                │\n    │ B - Lockfile Location     : /usr/local/Cellar/minicom/2.7.1/var       │\n    │ C -   Callin Program      :                                           │\n    │ D -  Callout Program      :                                           │\n    │ E -    Bps/Par/Bits       : 115200 8N1                                │\n    │ F - Hardware Flow Control : Yes                                       │\n    │ G - Software Flow Control : No                                        │\n    │                                                                       │\n    │    Change which setting?                                              │\n    └───────────────────────────────────────────────────────────────────────┘\n```\n### 配置选项目录\n选择\"Filenames and paths\"\n\n```text\n\n    ┌───────────────────────────────────────────────────────────────────────┐\n    │ A - Download directory :    /home/wonux                               │\n    │ B - Upload directory   :   /tmp                                       │\n    │ C - Script directory   :    /root/minicom                             │\n    │ D - Script program     : runscript   or /bin/bash                     │\n    │ E - Kermit program     :                                              │\n    │ F - Logging options                                                   │\n    │                                                                       │\n    │    Change which setting?                                              │\n    └───────────────────────────────────────────────────────────────────────┘\n```\n### 常用配置总结：\n* 选择Serial port setup\n配置选项如下：\n\n```text\nA - Serial Device : /dev/modem \nE - Bps/Par/Bits : 115200 8N1 \nF - Hardware Flow Control : No \nG - Software Flow Control : No \n```\n\n* 选择Filenames and paths\n配置其中的如下配置项：\n\n```text\nC - Script directory : /root/minicom\nD - Script program : /bin/bash\n```\nC:脚本文件的存放位置: <C-a> g运行脚本时的路径 。\nD:选择脚本程序: 默认runscript,也可以选择bash脚本格式。\n\n\n\n## 树莓派3b+添加散热外壳\n在某宝上买了一个外壳。\n![树莓派3b+外壳](https://static01.imgkr.com/temp/b635a9a9fcba4327b55363d4f8232a9b.png)\n\n\n\n线与树莓派针脚对应关系为：\n红色-> +5v\n黑色-> GND #地线\n![成品](https://static01.imgkr.com/temp/c5ba5a0d84e6411897a48f2cdad169f8.jpeg)\n\n## mac串口调试工具minicom\n我们使用常用的串口工具，如：minicom, screen 使用 115200 进行连接。它们的安装也非常的方便：\n\n```bash\n# 安装 minicom\n$ brew install minicom\n# 进行配置后再进行连接\n$ minicom -s\n\n# 安装 screen\n$ brew install screen\n# 进行连接\nscreen /dev/tty.usbserial 115200\n```\n连接后我们输入默认的账号和密码\n\n```bash\n用户名：pi\n密码：raspberry\n```\n## 树莓派连接上网设置\n\n\n```bash\nctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev\nupdate_config=1\ncountry=GB\n\nnetwork={\n        ssid=\"######\"  #wifi 名称\n        psk=\"*******\"   #wifi密码\n        proto=RSN            \n        key_mgmt=WPA-PSK    #加密方式  \n        pairwise=CCMP\n        auth_alg=OPEN\n}\n\nnetwork={\n        ssid=\"#######\"\n        psk=\"**********\"\n        proto=RSN\n        key_mgmt=WPA-PSK\n        pairwise=CCMP\n        auth_alg=OPEN\n}\n~\n```\n\n\n完整呈现：\n![呈现raspberry](https://static01.imgkr.com/temp/be442bb87f88482abceddaaac939a18e.gif)\n\n*参考资料：*\n* *https://blog.csdn.net/sikinzen/article/details/5451758*\n* *minicom中文手册*\n* *https://www.jianshu.com/p/71191dd41eab*\n* *https://www.jianshu.com/p/40412eb7f567*\n* *https://www.jianshu.com/p/b132508a0fa3?from=singlemessage*","source":"_posts/2020/2020-09/2020-09-07.md","raw":"---\ntitle: Mac用串口(ttl)连接树莓派3b+以及串口调试\ndate: 20202-09-07\ntag: \n - 树莓派\n---\n\n## MacOSX用串口(TTL)连接树莓派\n* 树莓派在没有显示使用时，可以使用usb串口转ttl进行连接。\nUSB转ttl线 CP2102下载对应的驱动\nUSB转TTL 驱动下载地址：http://pan.baidu.com/s/1mgCFd9m\n安装完成后重启系统，插入 USB to TTL 线可查询串口设备。\n\n```bash\n$ ls /dev/tty.usbserial*   #在Mac是这个，去查看。插拔usb能够看到对应的设备\n/dev/tty.usbserial\n```\nUSB转TTL线\n\n![usbtoTTL](https://static01.imgkr.com/temp/9473f3e37795437a8308ee3958e229b2.jpg)\n\n树莓派3b+引脚图\n![树莓派3b+引脚图](https://static01.imgkr.com/temp/db5437d45d5246f79854c980d739768a.jpeg)\n\nUSB to TTL 线与树莓派针脚对应关系为：\nGND -> GND\nRXD -> GPIO 14(TXD)\nTXD -> GPIO 15(RXD)\nVCC -> 悬空 (切记, 不要乱接)\n\n注意: 一定按照上面的对应关系，不要接成一样的。\n\n### 配置minicom参数\n运行\n\n```bash\nsudo minicom -s\n```\n进入minicom界面\n\n```text\n\n            ┌─────[configuration]──────┐\n            │ Filenames and paths      │\n            │ File transfer protocols  │\n            │ Serial port setup        │\n            │ Modem and dialing        │\n            │ Screen and keyboard      │\n            │ Save setup as dfl        │\n            │ Save setup as..          │\n            │ Exit                     │\n            │ Exit from Minicom        │\n            └──────────────────────────┘\n```\n使用上下键选择Serial port setup，回车。此时停留在change which setting?  通过A,B,C,D选项设置对应的参数设置例如下\n\n```text\n\n    ┌───────────────────────────────────────────────────────────────────────┐\n    │ A -    Serial Device      : /dev/modem                                │\n    │ B - Lockfile Location     : /usr/local/Cellar/minicom/2.7.1/var       │\n    │ C -   Callin Program      :                                           │\n    │ D -  Callout Program      :                                           │\n    │ E -    Bps/Par/Bits       : 115200 8N1                                │\n    │ F - Hardware Flow Control : Yes                                       │\n    │ G - Software Flow Control : No                                        │\n    │                                                                       │\n    │    Change which setting?                                              │\n    └───────────────────────────────────────────────────────────────────────┘\n```\n### 配置选项目录\n选择\"Filenames and paths\"\n\n```text\n\n    ┌───────────────────────────────────────────────────────────────────────┐\n    │ A - Download directory :    /home/wonux                               │\n    │ B - Upload directory   :   /tmp                                       │\n    │ C - Script directory   :    /root/minicom                             │\n    │ D - Script program     : runscript   or /bin/bash                     │\n    │ E - Kermit program     :                                              │\n    │ F - Logging options                                                   │\n    │                                                                       │\n    │    Change which setting?                                              │\n    └───────────────────────────────────────────────────────────────────────┘\n```\n### 常用配置总结：\n* 选择Serial port setup\n配置选项如下：\n\n```text\nA - Serial Device : /dev/modem \nE - Bps/Par/Bits : 115200 8N1 \nF - Hardware Flow Control : No \nG - Software Flow Control : No \n```\n\n* 选择Filenames and paths\n配置其中的如下配置项：\n\n```text\nC - Script directory : /root/minicom\nD - Script program : /bin/bash\n```\nC:脚本文件的存放位置: <C-a> g运行脚本时的路径 。\nD:选择脚本程序: 默认runscript,也可以选择bash脚本格式。\n\n\n\n## 树莓派3b+添加散热外壳\n在某宝上买了一个外壳。\n![树莓派3b+外壳](https://static01.imgkr.com/temp/b635a9a9fcba4327b55363d4f8232a9b.png)\n\n\n\n线与树莓派针脚对应关系为：\n红色-> +5v\n黑色-> GND #地线\n![成品](https://static01.imgkr.com/temp/c5ba5a0d84e6411897a48f2cdad169f8.jpeg)\n\n## mac串口调试工具minicom\n我们使用常用的串口工具，如：minicom, screen 使用 115200 进行连接。它们的安装也非常的方便：\n\n```bash\n# 安装 minicom\n$ brew install minicom\n# 进行配置后再进行连接\n$ minicom -s\n\n# 安装 screen\n$ brew install screen\n# 进行连接\nscreen /dev/tty.usbserial 115200\n```\n连接后我们输入默认的账号和密码\n\n```bash\n用户名：pi\n密码：raspberry\n```\n## 树莓派连接上网设置\n\n\n```bash\nctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev\nupdate_config=1\ncountry=GB\n\nnetwork={\n        ssid=\"######\"  #wifi 名称\n        psk=\"*******\"   #wifi密码\n        proto=RSN            \n        key_mgmt=WPA-PSK    #加密方式  \n        pairwise=CCMP\n        auth_alg=OPEN\n}\n\nnetwork={\n        ssid=\"#######\"\n        psk=\"**********\"\n        proto=RSN\n        key_mgmt=WPA-PSK\n        pairwise=CCMP\n        auth_alg=OPEN\n}\n~\n```\n\n\n完整呈现：\n![呈现raspberry](https://static01.imgkr.com/temp/be442bb87f88482abceddaaac939a18e.gif)\n\n*参考资料：*\n* *https://blog.csdn.net/sikinzen/article/details/5451758*\n* *minicom中文手册*\n* *https://www.jianshu.com/p/71191dd41eab*\n* *https://www.jianshu.com/p/40412eb7f567*\n* *https://www.jianshu.com/p/b132508a0fa3?from=singlemessage*","slug":"2020/2020-09/2020-09-07","published":1,"updated":"2020-09-07T15:37:38.157Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckeuuot260022ip9kfvou9kfy","content":"<h2 id=\"macosx用串口ttl连接树莓派\"><a class=\"markdownIt-Anchor\" href=\"#macosx用串口ttl连接树莓派\"></a> MacOSX用串口(TTL)连接树莓派</h2>\n<ul>\n<li>树莓派在没有显示使用时，可以使用usb串口转ttl进行连接。<br>\nUSB转ttl线 CP2102下载对应的驱动<br>\nUSB转TTL 驱动下载地址：<a href=\"http://pan.baidu.com/s/1mgCFd9m\" target=\"_blank\" rel=\"noopener\">http://pan.baidu.com/s/1mgCFd9m</a><br>\n安装完成后重启系统，插入 USB to TTL 线可查询串口设备。</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ls /dev/tty.usbserial*   <span class=\"comment\">#在Mac是这个，去查看。插拔usb能够看到对应的设备</span></span><br><span class=\"line\">/dev/tty.usbserial</span><br></pre></td></tr></table></figure>\n<p>USB转TTL线</p>\n<p><img src=\"https://static01.imgkr.com/temp/9473f3e37795437a8308ee3958e229b2.jpg\" alt=\"usbtoTTL\"></p>\n<p>树莓派3b+引脚图<br>\n<img src=\"https://static01.imgkr.com/temp/db5437d45d5246f79854c980d739768a.jpeg\" alt=\"树莓派3b+引脚图\"></p>\n<p>USB to TTL 线与树莓派针脚对应关系为：<br>\nGND -&gt; GND<br>\nRXD -&gt; GPIO 14(TXD)<br>\nTXD -&gt; GPIO 15(RXD)<br>\nVCC -&gt; 悬空 (切记, 不要乱接)</p>\n<p>注意: 一定按照上面的对应关系，不要接成一样的。</p>\n<h3 id=\"配置minicom参数\"><a class=\"markdownIt-Anchor\" href=\"#配置minicom参数\"></a> 配置minicom参数</h3>\n<p>运行</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo minicom -s</span><br></pre></td></tr></table></figure>\n<p>进入minicom界面</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">┌─────[configuration]──────┐</span><br><span class=\"line\">│ Filenames and paths      │</span><br><span class=\"line\">│ File transfer protocols  │</span><br><span class=\"line\">│ Serial port setup        │</span><br><span class=\"line\">│ Modem and dialing        │</span><br><span class=\"line\">│ Screen and keyboard      │</span><br><span class=\"line\">│ Save setup as dfl        │</span><br><span class=\"line\">│ Save setup as..          │</span><br><span class=\"line\">│ Exit                     │</span><br><span class=\"line\">│ Exit from Minicom        │</span><br><span class=\"line\">└──────────────────────────┘</span><br></pre></td></tr></table></figure>\n<p>使用上下键选择Serial port setup，回车。此时停留在change which setting?  通过A,B,C,D选项设置对应的参数设置例如下</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">┌───────────────────────────────────────────────────────────────────────┐</span><br><span class=\"line\">│ A -    Serial Device      : /dev/modem                                │</span><br><span class=\"line\">│ B - Lockfile Location     : /usr/local/Cellar/minicom/2.7.1/var       │</span><br><span class=\"line\">│ C -   Callin Program      :                                           │</span><br><span class=\"line\">│ D -  Callout Program      :                                           │</span><br><span class=\"line\">│ E -    Bps/Par/Bits       : 115200 8N1                                │</span><br><span class=\"line\">│ F - Hardware Flow Control : Yes                                       │</span><br><span class=\"line\">│ G - Software Flow Control : No                                        │</span><br><span class=\"line\">│                                                                       │</span><br><span class=\"line\">│    Change which setting?                                              │</span><br><span class=\"line\">└───────────────────────────────────────────────────────────────────────┘</span><br></pre></td></tr></table></figure>\n<h3 id=\"配置选项目录\"><a class=\"markdownIt-Anchor\" href=\"#配置选项目录\"></a> 配置选项目录</h3>\n<p>选择&quot;Filenames and paths&quot;</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">┌───────────────────────────────────────────────────────────────────────┐</span><br><span class=\"line\">│ A - Download directory :    /home/wonux                               │</span><br><span class=\"line\">│ B - Upload directory   :   /tmp                                       │</span><br><span class=\"line\">│ C - Script directory   :    /root/minicom                             │</span><br><span class=\"line\">│ D - Script program     : runscript   or /bin/bash                     │</span><br><span class=\"line\">│ E - Kermit program     :                                              │</span><br><span class=\"line\">│ F - Logging options                                                   │</span><br><span class=\"line\">│                                                                       │</span><br><span class=\"line\">│    Change which setting?                                              │</span><br><span class=\"line\">└───────────────────────────────────────────────────────────────────────┘</span><br></pre></td></tr></table></figure>\n<h3 id=\"常用配置总结\"><a class=\"markdownIt-Anchor\" href=\"#常用配置总结\"></a> 常用配置总结：</h3>\n<ul>\n<li>选择Serial port setup<br>\n配置选项如下：</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A - Serial Device : /dev/modem </span><br><span class=\"line\">E - Bps/Par/Bits : 115200 8N1 </span><br><span class=\"line\">F - Hardware Flow Control : No </span><br><span class=\"line\">G - Software Flow Control : No</span><br></pre></td></tr></table></figure>\n<ul>\n<li>选择Filenames and paths<br>\n配置其中的如下配置项：</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C - Script directory : /root/minicom</span><br><span class=\"line\">D - Script program : /bin/bash</span><br></pre></td></tr></table></figure>\n<p>C:脚本文件的存放位置: <c-a> g运行脚本时的路径 。<br>\nD:选择脚本程序: 默认runscript,也可以选择bash脚本格式。</c-a></p>\n<h2 id=\"树莓派3b添加散热外壳\"><a class=\"markdownIt-Anchor\" href=\"#树莓派3b添加散热外壳\"></a> 树莓派3b+添加散热外壳</h2>\n<p>在某宝上买了一个外壳。<br>\n<img src=\"https://static01.imgkr.com/temp/b635a9a9fcba4327b55363d4f8232a9b.png\" alt=\"树莓派3b+外壳\"></p>\n<p>线与树莓派针脚对应关系为：<br>\n红色-&gt; +5v<br>\n黑色-&gt; GND #地线<br>\n<img src=\"https://static01.imgkr.com/temp/c5ba5a0d84e6411897a48f2cdad169f8.jpeg\" alt=\"成品\"></p>\n<h2 id=\"mac串口调试工具minicom\"><a class=\"markdownIt-Anchor\" href=\"#mac串口调试工具minicom\"></a> mac串口调试工具minicom</h2>\n<p>我们使用常用的串口工具，如：minicom, screen 使用 115200 进行连接。它们的安装也非常的方便：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装 minicom</span></span><br><span class=\"line\">$ brew install minicom</span><br><span class=\"line\"><span class=\"comment\"># 进行配置后再进行连接</span></span><br><span class=\"line\">$ minicom -s</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 安装 screen</span></span><br><span class=\"line\">$ brew install screen</span><br><span class=\"line\"><span class=\"comment\"># 进行连接</span></span><br><span class=\"line\">screen /dev/tty.usbserial 115200</span><br></pre></td></tr></table></figure>\n<p>连接后我们输入默认的账号和密码</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">用户名：pi</span><br><span class=\"line\">密码：raspberry</span><br></pre></td></tr></table></figure>\n<h2 id=\"树莓派连接上网设置\"><a class=\"markdownIt-Anchor\" href=\"#树莓派连接上网设置\"></a> 树莓派连接上网设置</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev</span><br><span class=\"line\">update_config=1</span><br><span class=\"line\">country=GB</span><br><span class=\"line\"></span><br><span class=\"line\">network=&#123;</span><br><span class=\"line\">        ssid=<span class=\"string\">\"######\"</span>  <span class=\"comment\">#wifi 名称</span></span><br><span class=\"line\">        psk=<span class=\"string\">\"*******\"</span>   <span class=\"comment\">#wifi密码</span></span><br><span class=\"line\">        proto=RSN            </span><br><span class=\"line\">        key_mgmt=WPA-PSK    <span class=\"comment\">#加密方式  </span></span><br><span class=\"line\">        pairwise=CCMP</span><br><span class=\"line\">        auth_alg=OPEN</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">network=&#123;</span><br><span class=\"line\">        ssid=<span class=\"string\">\"#######\"</span></span><br><span class=\"line\">        psk=<span class=\"string\">\"**********\"</span></span><br><span class=\"line\">        proto=RSN</span><br><span class=\"line\">        key_mgmt=WPA-PSK</span><br><span class=\"line\">        pairwise=CCMP</span><br><span class=\"line\">        auth_alg=OPEN</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">~</span><br></pre></td></tr></table></figure>\n<p>完整呈现：<br>\n<img src=\"https://static01.imgkr.com/temp/be442bb87f88482abceddaaac939a18e.gif\" alt=\"呈现raspberry\"></p>\n<p><em>参考资料：</em></p>\n<ul>\n<li><em><a href=\"https://blog.csdn.net/sikinzen/article/details/5451758\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/sikinzen/article/details/5451758</a></em></li>\n<li><em>minicom中文手册</em></li>\n<li><em><a href=\"https://www.jianshu.com/p/71191dd41eab\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/71191dd41eab</a></em></li>\n<li><em><a href=\"https://www.jianshu.com/p/40412eb7f567\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/40412eb7f567</a></em></li>\n<li><em><a href=\"https://www.jianshu.com/p/b132508a0fa3?from=singlemessage\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/b132508a0fa3?from=singlemessage</a></em></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"macosx用串口ttl连接树莓派\"><a class=\"markdownIt-Anchor\" href=\"#macosx用串口ttl连接树莓派\"></a> MacOSX用串口(TTL)连接树莓派</h2>\n<ul>\n<li>树莓派在没有显示使用时，可以使用usb串口转ttl进行连接。<br>\nUSB转ttl线 CP2102下载对应的驱动<br>\nUSB转TTL 驱动下载地址：<a href=\"http://pan.baidu.com/s/1mgCFd9m\" target=\"_blank\" rel=\"noopener\">http://pan.baidu.com/s/1mgCFd9m</a><br>\n安装完成后重启系统，插入 USB to TTL 线可查询串口设备。</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ls /dev/tty.usbserial*   <span class=\"comment\">#在Mac是这个，去查看。插拔usb能够看到对应的设备</span></span><br><span class=\"line\">/dev/tty.usbserial</span><br></pre></td></tr></table></figure>\n<p>USB转TTL线</p>\n<p><img src=\"https://static01.imgkr.com/temp/9473f3e37795437a8308ee3958e229b2.jpg\" alt=\"usbtoTTL\"></p>\n<p>树莓派3b+引脚图<br>\n<img src=\"https://static01.imgkr.com/temp/db5437d45d5246f79854c980d739768a.jpeg\" alt=\"树莓派3b+引脚图\"></p>\n<p>USB to TTL 线与树莓派针脚对应关系为：<br>\nGND -&gt; GND<br>\nRXD -&gt; GPIO 14(TXD)<br>\nTXD -&gt; GPIO 15(RXD)<br>\nVCC -&gt; 悬空 (切记, 不要乱接)</p>\n<p>注意: 一定按照上面的对应关系，不要接成一样的。</p>\n<h3 id=\"配置minicom参数\"><a class=\"markdownIt-Anchor\" href=\"#配置minicom参数\"></a> 配置minicom参数</h3>\n<p>运行</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo minicom -s</span><br></pre></td></tr></table></figure>\n<p>进入minicom界面</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">┌─────[configuration]──────┐</span><br><span class=\"line\">│ Filenames and paths      │</span><br><span class=\"line\">│ File transfer protocols  │</span><br><span class=\"line\">│ Serial port setup        │</span><br><span class=\"line\">│ Modem and dialing        │</span><br><span class=\"line\">│ Screen and keyboard      │</span><br><span class=\"line\">│ Save setup as dfl        │</span><br><span class=\"line\">│ Save setup as..          │</span><br><span class=\"line\">│ Exit                     │</span><br><span class=\"line\">│ Exit from Minicom        │</span><br><span class=\"line\">└──────────────────────────┘</span><br></pre></td></tr></table></figure>\n<p>使用上下键选择Serial port setup，回车。此时停留在change which setting?  通过A,B,C,D选项设置对应的参数设置例如下</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">┌───────────────────────────────────────────────────────────────────────┐</span><br><span class=\"line\">│ A -    Serial Device      : /dev/modem                                │</span><br><span class=\"line\">│ B - Lockfile Location     : /usr/local/Cellar/minicom/2.7.1/var       │</span><br><span class=\"line\">│ C -   Callin Program      :                                           │</span><br><span class=\"line\">│ D -  Callout Program      :                                           │</span><br><span class=\"line\">│ E -    Bps/Par/Bits       : 115200 8N1                                │</span><br><span class=\"line\">│ F - Hardware Flow Control : Yes                                       │</span><br><span class=\"line\">│ G - Software Flow Control : No                                        │</span><br><span class=\"line\">│                                                                       │</span><br><span class=\"line\">│    Change which setting?                                              │</span><br><span class=\"line\">└───────────────────────────────────────────────────────────────────────┘</span><br></pre></td></tr></table></figure>\n<h3 id=\"配置选项目录\"><a class=\"markdownIt-Anchor\" href=\"#配置选项目录\"></a> 配置选项目录</h3>\n<p>选择&quot;Filenames and paths&quot;</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">┌───────────────────────────────────────────────────────────────────────┐</span><br><span class=\"line\">│ A - Download directory :    /home/wonux                               │</span><br><span class=\"line\">│ B - Upload directory   :   /tmp                                       │</span><br><span class=\"line\">│ C - Script directory   :    /root/minicom                             │</span><br><span class=\"line\">│ D - Script program     : runscript   or /bin/bash                     │</span><br><span class=\"line\">│ E - Kermit program     :                                              │</span><br><span class=\"line\">│ F - Logging options                                                   │</span><br><span class=\"line\">│                                                                       │</span><br><span class=\"line\">│    Change which setting?                                              │</span><br><span class=\"line\">└───────────────────────────────────────────────────────────────────────┘</span><br></pre></td></tr></table></figure>\n<h3 id=\"常用配置总结\"><a class=\"markdownIt-Anchor\" href=\"#常用配置总结\"></a> 常用配置总结：</h3>\n<ul>\n<li>选择Serial port setup<br>\n配置选项如下：</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A - Serial Device : /dev/modem </span><br><span class=\"line\">E - Bps/Par/Bits : 115200 8N1 </span><br><span class=\"line\">F - Hardware Flow Control : No </span><br><span class=\"line\">G - Software Flow Control : No</span><br></pre></td></tr></table></figure>\n<ul>\n<li>选择Filenames and paths<br>\n配置其中的如下配置项：</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C - Script directory : /root/minicom</span><br><span class=\"line\">D - Script program : /bin/bash</span><br></pre></td></tr></table></figure>\n<p>C:脚本文件的存放位置: <c-a> g运行脚本时的路径 。<br>\nD:选择脚本程序: 默认runscript,也可以选择bash脚本格式。</c-a></p>\n<h2 id=\"树莓派3b添加散热外壳\"><a class=\"markdownIt-Anchor\" href=\"#树莓派3b添加散热外壳\"></a> 树莓派3b+添加散热外壳</h2>\n<p>在某宝上买了一个外壳。<br>\n<img src=\"https://static01.imgkr.com/temp/b635a9a9fcba4327b55363d4f8232a9b.png\" alt=\"树莓派3b+外壳\"></p>\n<p>线与树莓派针脚对应关系为：<br>\n红色-&gt; +5v<br>\n黑色-&gt; GND #地线<br>\n<img src=\"https://static01.imgkr.com/temp/c5ba5a0d84e6411897a48f2cdad169f8.jpeg\" alt=\"成品\"></p>\n<h2 id=\"mac串口调试工具minicom\"><a class=\"markdownIt-Anchor\" href=\"#mac串口调试工具minicom\"></a> mac串口调试工具minicom</h2>\n<p>我们使用常用的串口工具，如：minicom, screen 使用 115200 进行连接。它们的安装也非常的方便：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装 minicom</span></span><br><span class=\"line\">$ brew install minicom</span><br><span class=\"line\"><span class=\"comment\"># 进行配置后再进行连接</span></span><br><span class=\"line\">$ minicom -s</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 安装 screen</span></span><br><span class=\"line\">$ brew install screen</span><br><span class=\"line\"><span class=\"comment\"># 进行连接</span></span><br><span class=\"line\">screen /dev/tty.usbserial 115200</span><br></pre></td></tr></table></figure>\n<p>连接后我们输入默认的账号和密码</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">用户名：pi</span><br><span class=\"line\">密码：raspberry</span><br></pre></td></tr></table></figure>\n<h2 id=\"树莓派连接上网设置\"><a class=\"markdownIt-Anchor\" href=\"#树莓派连接上网设置\"></a> 树莓派连接上网设置</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev</span><br><span class=\"line\">update_config=1</span><br><span class=\"line\">country=GB</span><br><span class=\"line\"></span><br><span class=\"line\">network=&#123;</span><br><span class=\"line\">        ssid=<span class=\"string\">\"######\"</span>  <span class=\"comment\">#wifi 名称</span></span><br><span class=\"line\">        psk=<span class=\"string\">\"*******\"</span>   <span class=\"comment\">#wifi密码</span></span><br><span class=\"line\">        proto=RSN            </span><br><span class=\"line\">        key_mgmt=WPA-PSK    <span class=\"comment\">#加密方式  </span></span><br><span class=\"line\">        pairwise=CCMP</span><br><span class=\"line\">        auth_alg=OPEN</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">network=&#123;</span><br><span class=\"line\">        ssid=<span class=\"string\">\"#######\"</span></span><br><span class=\"line\">        psk=<span class=\"string\">\"**********\"</span></span><br><span class=\"line\">        proto=RSN</span><br><span class=\"line\">        key_mgmt=WPA-PSK</span><br><span class=\"line\">        pairwise=CCMP</span><br><span class=\"line\">        auth_alg=OPEN</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">~</span><br></pre></td></tr></table></figure>\n<p>完整呈现：<br>\n<img src=\"https://static01.imgkr.com/temp/be442bb87f88482abceddaaac939a18e.gif\" alt=\"呈现raspberry\"></p>\n<p><em>参考资料：</em></p>\n<ul>\n<li><em><a href=\"https://blog.csdn.net/sikinzen/article/details/5451758\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/sikinzen/article/details/5451758</a></em></li>\n<li><em>minicom中文手册</em></li>\n<li><em><a href=\"https://www.jianshu.com/p/71191dd41eab\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/71191dd41eab</a></em></li>\n<li><em><a href=\"https://www.jianshu.com/p/40412eb7f567\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/40412eb7f567</a></em></li>\n<li><em><a href=\"https://www.jianshu.com/p/b132508a0fa3?from=singlemessage\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/b132508a0fa3?from=singlemessage</a></em></li>\n</ul>\n"},{"title":"pyenv的安装和简单使用（git、pyenv、pyenv-virtualenv）","date":"2020-09-17T16:00:00.000Z","_content":"\n[TOC]\n\n![python生态工具](https://i.loli.net/2020/09/18/7eGfMl86NDjUkFd.jpg)\n\n# Python工作环境管理\nPython 2和Python 3之间存在着较大的差异，并且，由于各种原因导致了Python 2和Python 3的长期 共存。在实际工作过程中，我们可能会同时用到Python 2和Python 3，因此，需要经常在Python 2和 Python 3之间进行来回切换。此外，如果你是喜欢尝鲜的人，那么，你很有可能在Python新版本出来 的时候立即下载Python的版本，试验Python的特性。\n\n在Python世界里，除了需要对Python的版本进行管理以外，还需要对不同的软件包进行管理。大部分 情况下，对于开源的库我们使用版本即可。但是，有时候可能需要对相同的Python版本，在不同的 项目中使用不同版本的软件包。\n\n在这一节里，我们将介绍两个工具，即pyenv和virtualenv。前者用于管理不同的Python版本，后者用 于管理不同的工作环境。有了这两个工具，Python相关的版本问题将不再是问题。\n\n## 1、情景问题\n1. Python解释器版本混乱, 2和3差别巨大, 而且细分版本也不尽相同, 难以选择和管理.\n2. 不同Linux发行版自带Python不同, 如ubuntu16自带2.7和3.5版本, 其中系统许多组件依赖于自带解释器, 一旦删除或者更改都可能会造成系统出问题.\n3. 不同的Python解释器软件包管理也是问题, 如pip和ipython等必备包组件, 而且在项目开发中如何保证不同的包环境互不干扰也是一个问题.\n4. \n那么有没有一个终极的解决办法能在管理不同解释器版本的同时控制不同的包环境呢? 有的, 就是pyenv.\n\n## 2、使用pyenv管理不同的Python版本\n安装不同的Python版本并不是一件容易的事情，在不同的Python版本之间来回切换更加困难，而且， 多版本并存非常容易互相干扰。因此，我们需要一个名为pyenv的工具。pyenv是一个Python版本管理 工具，它能够进行全局的Python版本切换，也可以为单个项目提供对应的Python版本。使用pyenv以 后，可以在服务器上安装多个不同的Python版本，也可以安装不同的Python实现。不同Python版本之 间的切换也非常简单。接下来我们就一起看一下pyenv的安装和使用。\n\n## pyenv是什么? 能干什么?\n\n```\npyenv是一个forked自ruby社区的简单、低调、遵循UNIX哲\n\n学的Python环境管理工具, 它可以轻松切换全局解释器版本, \n\n同时结合vitualenv插件可以方便的管理对应的包源.\n\n```\n\n我们知道, 在terminal中输入一个命令比如‘ls’时, shell会从当前环境的PATH中的各个目录里看是不是有ls这个可执行文件, 如果找到就执行, 否则就会报‘command no found’ 的错误, 同理, 只要控制PATH变量就能够做到python版本的切换, pyenv通过在PATH头部插入shims路径来实现对python版本的控制.\n\npyenv和流行的pipenv、virtualenv的关系\n\npipenv是requests 作者 Kenneth Reitz大神写的一个python虚拟环境管理工具, 结合了pip和virtualenv的功能, 侧重点还是在包环境管理上, 使用思路是先创建一个指定python版本的环境, 然后在此环境上安装相应的包, 好评不错, 看到很多大牛都在推荐.\n\npipenv是requests 作者 Kenneth Reitz大神写的一个python虚拟环境管理工具, 结合了pip和virtualenv的功能, 侧重点还是在包环境管理上, 使用思路是先创建一个指定python版本的环境, 然后在此环境上安装相应的包, 好评不错, 看到很多大牛都在推荐.\n\npyenv相对来说知名度就差很多了, 不过也很稳定, 这三个环境管理工具我都用过, 我个人更喜欢pyenv, 理由如下:\n\n1. 相对于其他两个工具, pyenv更侧重在python 解释器版本管理上, 比包管理更大一个层级, 使用pyenv我可以方便的下载指定版本的python解释器, pypy, anaconda等, 可以随时自由的在shell环境中本地、全局切换python解释器\n2. 开发的时候不需要限定某个版本的虚拟环境, 只需要在部署的时候用pyenv指定某个版本就好了\n3. pyenv切换解释器版本的时候, pip和ipython以及对应的包环境都是一起切换的, 所以如果你要同时运行ipython2.x和ipython3.x多个解释器验证一些代码时就很方便\n4. pyenv也可以创建好指定的虚拟环境, 但不需要指定具体目录, 自由度更高, 使用也简单\n\n## 4、简单使用\n\n```bash\n# 查看当前版本\npyenv version\n\n# 查看所有版本\npyenv versions\n\n# 查看所有可安装的版本\npyenv install --list\n\n# 安装指定版本\npyenv install 3.6.5\n# 安装新版本后rehash一下\npyenv rehash\n\n# 删除指定版本\npyenv uninstall 3.5.2\n\n# 指定全局版本\npyenv global 3.6.5\n\n# 指定多个全局版本, 3版本优先\npyenv global 3.6.5 2.7.14\n\n# 实际上当你切换版本后, 相应的pip和包仓库都是会自动切换过去的\n```\n\n## 一、pyenv安装\n1. 安装 pyenv\n\n说明：本文的所有安装都严格遵守官方文档，与官方文档完全保持一致。\n\ngit 地址：https://github.com/pyenv/pyenv\n\n在你的终端中执行如下命令，安全无毒，请放心食用：\n\n首先把项目克隆下来，放在家目录下的隐藏文件夹中：.pyenv\n\n\n```\ngit clone https://github.com/pyenv/pyenv.git ~/.pyenv\n```\n然后配置变量\n\n如果你使用 bash，就依次执行如下命令：\n\n```bash\necho 'export PYENV_ROOT=\"$HOME/.pyenv\"' >> ~/.bashrc\necho 'export PATH=\"$PYENV_ROOT/bin:$PATH\"' >> ~/.bashrc\necho -e 'if command -v pyenv 1>/dev/null 2>&1; then\\n eval \"$(pyenv init -)\"\\nfi' >> ~/.bashrc\n\n```\n如果你使用 zsh，就依次执行如下命令：\n\n```bash\necho 'export PYENV_ROOT=\"$HOME/.pyenv\"' >> ~/.zshrc\necho 'export PATH=\"$PYENV_ROOT/bin:$PATH\"' >> ~/.zshrc\necho -e 'if command -v pyenv 1>/dev/null 2>&1; then\\n eval \"$(pyenv init -)\"\\nfi' >> ~/.zshrc\n```\n\necho 命令的含义是：将引号中内容写入某文件中\n请注意，以上的三条 echo 命令的最后一条长长的命令，请你保证它引号中的内容处于 ~/.bashrc 或者 ~/.zshrc 的最底部。\n因为在 pyenv 初始化期间会操作 path 环境变量，导致不可预测的行为。\n查看文件的底部内容，可以使用 tail 命令，用法：tail ~/.bashrc 或者 tail ~/.zshrc，编辑文件可以使用 vim 或者 vscode\n\n最后，在使用 pyenv 之前，重新初始化 shell 环境，执行如下命令\n\n```bash\nexec $SHELL 或者 source \n```\n不执行该命令也是完全可以的，你可以关闭当前的终端窗口，重新启动一个就可以了。\n\n此时，你已经完成了 pyenv 的安装了，你使用可以它的全部命令了，但是我建议你先别急着用，一口气装完 pyenv 的一个插件，那就是 pyenv-virtualenv\n\n2. 安装 pyenv-virtualenv\n\nvirtualenv本身是一个独立的项目，用以隔离不同项目的工作环境。例如，用户lmx希望在项目A中使用 Flask 0.8这个版本，与此同时，又想在项目B中使用Flask 0.9这个版本。如果我们全局安装Flask，必然 无法满足用户的需求。这个时候，我们就可以使用virtualenv。\n\n读者需要注意pyenv和virtualenv的区别。pyenv用以管理不同的Python版本，例如，你的系统工作时 使用Python 2.7.13，学习时使用Python 3.6.0。virtualenv用以隔离项目的工作环境，例如，项目A和 项目B都是使用Python 2.7.13，但是，项目A需要使用Flask 0.8版本，项目B需要使用Flask 0.9版本。我 们只要组合pyenv和virtualenv这两个工具，就能够构造Python和第三方库的任意版本组合，拥有很好 的灵活性，也避免了项目之间的相互干扰。\n\nvirtualenv本身是一个独立的工具，用户可以不使用pyenv而单独使用virtualenv。但是，如果你使用了 pyenv，就需要安装pyenv-virtualenv插件，而不是通过virtualenv软件使用virtualenv的功能。\n\ngit 地址：https://github.com/pyenv/pyenv-virtualenv\n\n(1) 把插件克隆在刚才已经安装完毕的 pyenv 的 plugins 文件夹中\n\n```bash\ngit clone https://github.com/pyenv/pyenv-virtualenv.git $(pyenv root)/plugins/pyenv-virtualenv\n```\n(2) 然后配置环境变量\n如果你使用 bash，就执行如下命令：\n\n```bash\necho 'eval \"$(pyenv virtualenv-init -)\"' >> ~/.bashrc\n```\n如果你使用 zsh，就执行如下命令：\n\n```bash\necho 'eval \"$(pyenv virtualenv-init -)\"' >> ~/.zshrc\n```\n(3) 最后，在使用 pyenv 之前，重新初始化 shell 环境，执行如下命令\n\n```bash\nexec $SHELL\n```\n不执行该命令也是完全可以的，你可以关闭当前的终端窗口，重新启动一个就可以了。\n\n至此，pyenv就安装完成了，我们可以通过下面的命令验证pyenv是否正确安装并获取pyenv的帮助信息：\n\n```bash\npyenv --help\nUsage: pyenv <command> [<args>]\n\nSome useful pyenv commands are:\n   --version   Display the version of pyenv\n   activate    Activate virtual environment\n   commands    List all available pyenv commands\n   deactivate   Deactivate virtual environment\n   exec        Run an executable with the selected Python version\n   global      Set or show the global Python version(s)\n   help        Display help for a command\n   hooks       List hook scripts for a given pyenv command\n   init        Configure the shell environment for pyenv\n   install     Install a Python version using python-build\n   local       Set or show the local application-specific Python version(s)\n   prefix      Display prefix for a Python version\n   rehash      Rehash pyenv shims (run this after installing executables)\n   root        Display the root directory where versions and shims are kept\n   shell       Set or show the shell-specific Python version\n   shims       List existing pyenv shims\n   uninstall   Uninstall a specific Python version\n   version     Show the current Python version(s) and its origin\n   version-file   Detect the file that sets the current pyenv version\n   version-name   Show the current Python version\n   version-origin   Explain how the current Python version is set\n   versions    List all Python versions available to pyenv\n   virtualenv   Create a Python virtualenv using the pyenv-virtualenv plugin\n   virtualenv-delete   Uninstall a specific Python virtualenv\n   virtualenv-init   Configure the shell environment for pyenv-virtualenv\n   virtualenv-prefix   Display real_prefix for a Python virtualenv version\n   virtualenvs   List all Python virtualenvs found in `$PYENV_ROOT/versions/*'.\n   whence      List all Python versions that contain the given executable\n   which       Display the full path to an executable\n\nSee `pyenv help <command>' for information on a specific command.\nFor full documentation, see: https://github.com/pyenv/pyenv#readme\n```\n## 二、使用 pyenv\n\n此处仅仅展示 pyenv 和 virtualenv 的日常用法\n\n1、检查安装是否正确\n检查 pyenv 的版本\n```bash\n[root@python ~]# pyenv version\n(set by /root/.pyenv/version)\n查看 pyenv 已经管理了哪些 python 版本\n[root@python ~]#pyenv versions\n* system (set by /root/.pyenv/version)\n```\n如果你看到了正常的版本信息，就说明可以了，如果看到了类似于 command not found 之类的，就说明安装失败了。\n\n我们通过pyenv的install命令，可以查看pyenv当前支持哪些Python版本，如下所示：\n```bash\n[root@python ~]# pyenv install --list \nAvailable versions:\n2.1.3\n……省略部分信息\n3.8.0\n3.8-dev\n3.8.1\n3.9-dev\n……省略部分信息\nanaconda3-2018.12\nanaconda3-2019.03\nanaconda3-2019.07\nanaconda3-2019.10\n……省略部分信息\n[root@python ~]#\n```\n2、pyenv切换python版本\n由于pyenv可以安装的Python版本列表非常长，所以，这里进行了省略。读者可以在自己电脑上安装 pyenv，然后执行pyenv install --list命令进行查看。可以看到，pyenv不但可以安装不同的Python版 本，而且还可以安装不同的Python实现，也可以安装版本的Python用以学习。\n\n查看当前系统中包含的Python版本：\n```bash\n[root@python ~]# pyenv versions \n* system (set by /root/.pyenv/version)\n使用pyenv安装不同的Python版本：\n[root@python ~]#pyenv install -v 3.8.1  \n[root@python ~]#pyenv install -v 2.7.13 \n```\n再次查看当前系统中包含的Python版本\n\n```bash\n[root@python ~]# pyenv versions\n* system (set by /root/.pyenv/version)\n  2.7.13\n  3.8.1\n```\n\n3. 切换前为3.8.1\n\n```bash\n#切换当前为3.8.1\n[root@python ~]# python\nPython 3.8.1 (default, Apr 20 2020, 15:00:10) \n[GCC 4.8.5 20150623 (Red Hat 4.8.5-39)] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more informatio\n```\n\n4. 切换为2.7.13\n\n```bash\n[root@python ~]# pyenv  global 2.7.13 \n[root@python ~]# python\nPython 2.7.13 (default, Apr 20 2020, 15:04:15) \n[GCC 4.8.5 20150623 (Red Hat 4.8.5-39)] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n```\n使用pyenv以后，可以快速切换Python的版本。切换Python版本以后，与版本相关的依赖也会一起切 换。因此，我们不用担心不同的版本在系统中是否会相互干扰。例如，切换Python版本以后，相应的 pip也会跟着切换，所以不用担心自己使用的pip版本和Python版本不匹配的问题，如下所示：\n\n```bash\n[root@python ~]# pyenv  global 3.8.1\n[root@python ~]# pip --version\npip 19.2.3 from /root/.pyenv/versions/3.8.1/lib/python3.8/site-packages/pip (python 3.8)\n如果想要删除Python版本，使用uninstall命令即可。如下所示：\n[root@python ~]# pyenv uninstall 2.7.10\n```\n## 三、pyenv-virtualenv的使用\n有了pyenv-virtualenv以后，我们可以为同一个Python解释器，创建多个不同的工作环境。例如，我们 新建两个工作环境：\n\n```bash\n[root@python ~]# pyenv virtualenv 3.8.1 first_project \n[root@python ~]# pyenv virtualenv 3.8.1 second_projec\n可以使用virtualenvs子命令查看工作环境\n[root@python ~]# pyenv virtualenvs\n  3.8.1/envs/first_project (created from /root/.pyenv/versions/3.8.1)\n  3.8.1/envs/second_projec (created from /root/.pyenv/versions/3.8.1)\n  first_project (created from /root/.pyenv/versions/3.8.1)\n  second_projec (created from /root/.pyenv/versions/3.8.1)\n```\n创建完工作环境以后，可以通过activate和deactivate子命令进入或退出一个工作环境。进入工作环境 以后，左边的提示符会显示你当前所在的工作环境，以免因为环境太多导致操作错误。\n\n\n```bash\n(first_project) \n[root@python ~]# pip install flask==1.1.1 \nLooking in indexes: https://pypi.doubanio.com/simple\nCollecting flask==1.1.1\n  Downloading https://pypi.doubanio.com/packages/9b/93/628509b8d5dc749656a9641f4caf13540e2cdec85276964ff8f43bbb1d3b/Flask-1.1.1-py2.py3-none-any.whl (94kB)\n     |███▌                            | 10kB 28.0MB/s eta 0:00:\n     |███████                         | 20kB 1.8MB/s eta 0:00:0\n     |██████████▍                     | 30kB 2.7MB/s eta 0:00:0\n     |█████████████▉                  | 40kB 1.8MB/s eta 0:00:0\n     |█████████████████▍              | 51kB 1.3MB/s eta 0:00:0\n     |████████████████████▉           | 61kB 1.5MB/s eta 0:00:0\n     |████████████████████████▎       | 71kB 1.4MB/s eta 0:00:0\n     |███████████████████████████▊    | 81kB 1.3MB/s eta 0:00:0\n     |███████████████████████████████▏| 92kB 1.4MB/s eta 0:00:0\n     |████████████████████████████████| 102kB 1.6MB/s \nCollecting itsdangerous>=0.24 (from flask==1.1.1)\n(first_project) [root@python ~]# pyenv deactivate\n## 退出first_project环境\n[root@python ~]# \n```\n接下来，我们看一下在不同的工作环境安装不同的Flask版本\n\n```bash\n[root@python ~]# pyenv activate first_project \n##切换工作环境\n(first_project) [root@python ~]# pip install flask==1.1.1 \n##安装1.1.1的flask\n(first_project) [root@python ~]# pyenv deactivate \n##退出目前工作环境\n[root@python ~]#\n\n[root@python ~]# pyenv activate second_projec\n##切换工作环境\n(second_project) [root@python ~]# pip install flask==0.10.1\n##安装0.10.1的flask\n(second_project) [root@python ~]# pyenv deactivate \n##退出目前工作环境\n[root@python ~]#\n```\n查看一下两个工作环境源目录\npyenv的安装和简单使用（git、pyenv、pyenv-virtualenv）\n\n如果想要删除虚拟环境，则使用：\n\n```bash\n(first_project)\n [root@python ~]# pyenv virtualenv-delete first_project \n```\n使用pyenv和python-virtualenv插件，我们就能够自由地在不同的版本之间进行切换，相比管理Python 版本，不但节省了时间，也避免了工作过程中的相互干扰。\n\n## 四、更新 pyenv\n由于我们是 git 克隆的，所以更新非常简单\n```bash\ncd ~/.pyenv` 或者 `cd $(pyenv root)`\n `git pull\n```\n## 五、卸载 pyenv\n由于 pyenv 把一切都放在 ~/.pyenv 下了，所以卸载很方便，两个步骤就行了\n\n首先你需要删除环境变量\n\n然后你需要执行：\n\n```bash\nrm -rf ~/.pyenv` 或者 `rm -rf $(pyenv root)\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","source":"_posts/2020/2020-09/2020-09-18.md","raw":"---\ntitle: pyenv的安装和简单使用（git、pyenv、pyenv-virtualenv）\ndate: 2020-09-18\ntags: \n    - python\n    - pyenv\ncategories: python\n---\n\n[TOC]\n\n![python生态工具](https://i.loli.net/2020/09/18/7eGfMl86NDjUkFd.jpg)\n\n# Python工作环境管理\nPython 2和Python 3之间存在着较大的差异，并且，由于各种原因导致了Python 2和Python 3的长期 共存。在实际工作过程中，我们可能会同时用到Python 2和Python 3，因此，需要经常在Python 2和 Python 3之间进行来回切换。此外，如果你是喜欢尝鲜的人，那么，你很有可能在Python新版本出来 的时候立即下载Python的版本，试验Python的特性。\n\n在Python世界里，除了需要对Python的版本进行管理以外，还需要对不同的软件包进行管理。大部分 情况下，对于开源的库我们使用版本即可。但是，有时候可能需要对相同的Python版本，在不同的 项目中使用不同版本的软件包。\n\n在这一节里，我们将介绍两个工具，即pyenv和virtualenv。前者用于管理不同的Python版本，后者用 于管理不同的工作环境。有了这两个工具，Python相关的版本问题将不再是问题。\n\n## 1、情景问题\n1. Python解释器版本混乱, 2和3差别巨大, 而且细分版本也不尽相同, 难以选择和管理.\n2. 不同Linux发行版自带Python不同, 如ubuntu16自带2.7和3.5版本, 其中系统许多组件依赖于自带解释器, 一旦删除或者更改都可能会造成系统出问题.\n3. 不同的Python解释器软件包管理也是问题, 如pip和ipython等必备包组件, 而且在项目开发中如何保证不同的包环境互不干扰也是一个问题.\n4. \n那么有没有一个终极的解决办法能在管理不同解释器版本的同时控制不同的包环境呢? 有的, 就是pyenv.\n\n## 2、使用pyenv管理不同的Python版本\n安装不同的Python版本并不是一件容易的事情，在不同的Python版本之间来回切换更加困难，而且， 多版本并存非常容易互相干扰。因此，我们需要一个名为pyenv的工具。pyenv是一个Python版本管理 工具，它能够进行全局的Python版本切换，也可以为单个项目提供对应的Python版本。使用pyenv以 后，可以在服务器上安装多个不同的Python版本，也可以安装不同的Python实现。不同Python版本之 间的切换也非常简单。接下来我们就一起看一下pyenv的安装和使用。\n\n## pyenv是什么? 能干什么?\n\n```\npyenv是一个forked自ruby社区的简单、低调、遵循UNIX哲\n\n学的Python环境管理工具, 它可以轻松切换全局解释器版本, \n\n同时结合vitualenv插件可以方便的管理对应的包源.\n\n```\n\n我们知道, 在terminal中输入一个命令比如‘ls’时, shell会从当前环境的PATH中的各个目录里看是不是有ls这个可执行文件, 如果找到就执行, 否则就会报‘command no found’ 的错误, 同理, 只要控制PATH变量就能够做到python版本的切换, pyenv通过在PATH头部插入shims路径来实现对python版本的控制.\n\npyenv和流行的pipenv、virtualenv的关系\n\npipenv是requests 作者 Kenneth Reitz大神写的一个python虚拟环境管理工具, 结合了pip和virtualenv的功能, 侧重点还是在包环境管理上, 使用思路是先创建一个指定python版本的环境, 然后在此环境上安装相应的包, 好评不错, 看到很多大牛都在推荐.\n\npipenv是requests 作者 Kenneth Reitz大神写的一个python虚拟环境管理工具, 结合了pip和virtualenv的功能, 侧重点还是在包环境管理上, 使用思路是先创建一个指定python版本的环境, 然后在此环境上安装相应的包, 好评不错, 看到很多大牛都在推荐.\n\npyenv相对来说知名度就差很多了, 不过也很稳定, 这三个环境管理工具我都用过, 我个人更喜欢pyenv, 理由如下:\n\n1. 相对于其他两个工具, pyenv更侧重在python 解释器版本管理上, 比包管理更大一个层级, 使用pyenv我可以方便的下载指定版本的python解释器, pypy, anaconda等, 可以随时自由的在shell环境中本地、全局切换python解释器\n2. 开发的时候不需要限定某个版本的虚拟环境, 只需要在部署的时候用pyenv指定某个版本就好了\n3. pyenv切换解释器版本的时候, pip和ipython以及对应的包环境都是一起切换的, 所以如果你要同时运行ipython2.x和ipython3.x多个解释器验证一些代码时就很方便\n4. pyenv也可以创建好指定的虚拟环境, 但不需要指定具体目录, 自由度更高, 使用也简单\n\n## 4、简单使用\n\n```bash\n# 查看当前版本\npyenv version\n\n# 查看所有版本\npyenv versions\n\n# 查看所有可安装的版本\npyenv install --list\n\n# 安装指定版本\npyenv install 3.6.5\n# 安装新版本后rehash一下\npyenv rehash\n\n# 删除指定版本\npyenv uninstall 3.5.2\n\n# 指定全局版本\npyenv global 3.6.5\n\n# 指定多个全局版本, 3版本优先\npyenv global 3.6.5 2.7.14\n\n# 实际上当你切换版本后, 相应的pip和包仓库都是会自动切换过去的\n```\n\n## 一、pyenv安装\n1. 安装 pyenv\n\n说明：本文的所有安装都严格遵守官方文档，与官方文档完全保持一致。\n\ngit 地址：https://github.com/pyenv/pyenv\n\n在你的终端中执行如下命令，安全无毒，请放心食用：\n\n首先把项目克隆下来，放在家目录下的隐藏文件夹中：.pyenv\n\n\n```\ngit clone https://github.com/pyenv/pyenv.git ~/.pyenv\n```\n然后配置变量\n\n如果你使用 bash，就依次执行如下命令：\n\n```bash\necho 'export PYENV_ROOT=\"$HOME/.pyenv\"' >> ~/.bashrc\necho 'export PATH=\"$PYENV_ROOT/bin:$PATH\"' >> ~/.bashrc\necho -e 'if command -v pyenv 1>/dev/null 2>&1; then\\n eval \"$(pyenv init -)\"\\nfi' >> ~/.bashrc\n\n```\n如果你使用 zsh，就依次执行如下命令：\n\n```bash\necho 'export PYENV_ROOT=\"$HOME/.pyenv\"' >> ~/.zshrc\necho 'export PATH=\"$PYENV_ROOT/bin:$PATH\"' >> ~/.zshrc\necho -e 'if command -v pyenv 1>/dev/null 2>&1; then\\n eval \"$(pyenv init -)\"\\nfi' >> ~/.zshrc\n```\n\necho 命令的含义是：将引号中内容写入某文件中\n请注意，以上的三条 echo 命令的最后一条长长的命令，请你保证它引号中的内容处于 ~/.bashrc 或者 ~/.zshrc 的最底部。\n因为在 pyenv 初始化期间会操作 path 环境变量，导致不可预测的行为。\n查看文件的底部内容，可以使用 tail 命令，用法：tail ~/.bashrc 或者 tail ~/.zshrc，编辑文件可以使用 vim 或者 vscode\n\n最后，在使用 pyenv 之前，重新初始化 shell 环境，执行如下命令\n\n```bash\nexec $SHELL 或者 source \n```\n不执行该命令也是完全可以的，你可以关闭当前的终端窗口，重新启动一个就可以了。\n\n此时，你已经完成了 pyenv 的安装了，你使用可以它的全部命令了，但是我建议你先别急着用，一口气装完 pyenv 的一个插件，那就是 pyenv-virtualenv\n\n2. 安装 pyenv-virtualenv\n\nvirtualenv本身是一个独立的项目，用以隔离不同项目的工作环境。例如，用户lmx希望在项目A中使用 Flask 0.8这个版本，与此同时，又想在项目B中使用Flask 0.9这个版本。如果我们全局安装Flask，必然 无法满足用户的需求。这个时候，我们就可以使用virtualenv。\n\n读者需要注意pyenv和virtualenv的区别。pyenv用以管理不同的Python版本，例如，你的系统工作时 使用Python 2.7.13，学习时使用Python 3.6.0。virtualenv用以隔离项目的工作环境，例如，项目A和 项目B都是使用Python 2.7.13，但是，项目A需要使用Flask 0.8版本，项目B需要使用Flask 0.9版本。我 们只要组合pyenv和virtualenv这两个工具，就能够构造Python和第三方库的任意版本组合，拥有很好 的灵活性，也避免了项目之间的相互干扰。\n\nvirtualenv本身是一个独立的工具，用户可以不使用pyenv而单独使用virtualenv。但是，如果你使用了 pyenv，就需要安装pyenv-virtualenv插件，而不是通过virtualenv软件使用virtualenv的功能。\n\ngit 地址：https://github.com/pyenv/pyenv-virtualenv\n\n(1) 把插件克隆在刚才已经安装完毕的 pyenv 的 plugins 文件夹中\n\n```bash\ngit clone https://github.com/pyenv/pyenv-virtualenv.git $(pyenv root)/plugins/pyenv-virtualenv\n```\n(2) 然后配置环境变量\n如果你使用 bash，就执行如下命令：\n\n```bash\necho 'eval \"$(pyenv virtualenv-init -)\"' >> ~/.bashrc\n```\n如果你使用 zsh，就执行如下命令：\n\n```bash\necho 'eval \"$(pyenv virtualenv-init -)\"' >> ~/.zshrc\n```\n(3) 最后，在使用 pyenv 之前，重新初始化 shell 环境，执行如下命令\n\n```bash\nexec $SHELL\n```\n不执行该命令也是完全可以的，你可以关闭当前的终端窗口，重新启动一个就可以了。\n\n至此，pyenv就安装完成了，我们可以通过下面的命令验证pyenv是否正确安装并获取pyenv的帮助信息：\n\n```bash\npyenv --help\nUsage: pyenv <command> [<args>]\n\nSome useful pyenv commands are:\n   --version   Display the version of pyenv\n   activate    Activate virtual environment\n   commands    List all available pyenv commands\n   deactivate   Deactivate virtual environment\n   exec        Run an executable with the selected Python version\n   global      Set or show the global Python version(s)\n   help        Display help for a command\n   hooks       List hook scripts for a given pyenv command\n   init        Configure the shell environment for pyenv\n   install     Install a Python version using python-build\n   local       Set or show the local application-specific Python version(s)\n   prefix      Display prefix for a Python version\n   rehash      Rehash pyenv shims (run this after installing executables)\n   root        Display the root directory where versions and shims are kept\n   shell       Set or show the shell-specific Python version\n   shims       List existing pyenv shims\n   uninstall   Uninstall a specific Python version\n   version     Show the current Python version(s) and its origin\n   version-file   Detect the file that sets the current pyenv version\n   version-name   Show the current Python version\n   version-origin   Explain how the current Python version is set\n   versions    List all Python versions available to pyenv\n   virtualenv   Create a Python virtualenv using the pyenv-virtualenv plugin\n   virtualenv-delete   Uninstall a specific Python virtualenv\n   virtualenv-init   Configure the shell environment for pyenv-virtualenv\n   virtualenv-prefix   Display real_prefix for a Python virtualenv version\n   virtualenvs   List all Python virtualenvs found in `$PYENV_ROOT/versions/*'.\n   whence      List all Python versions that contain the given executable\n   which       Display the full path to an executable\n\nSee `pyenv help <command>' for information on a specific command.\nFor full documentation, see: https://github.com/pyenv/pyenv#readme\n```\n## 二、使用 pyenv\n\n此处仅仅展示 pyenv 和 virtualenv 的日常用法\n\n1、检查安装是否正确\n检查 pyenv 的版本\n```bash\n[root@python ~]# pyenv version\n(set by /root/.pyenv/version)\n查看 pyenv 已经管理了哪些 python 版本\n[root@python ~]#pyenv versions\n* system (set by /root/.pyenv/version)\n```\n如果你看到了正常的版本信息，就说明可以了，如果看到了类似于 command not found 之类的，就说明安装失败了。\n\n我们通过pyenv的install命令，可以查看pyenv当前支持哪些Python版本，如下所示：\n```bash\n[root@python ~]# pyenv install --list \nAvailable versions:\n2.1.3\n……省略部分信息\n3.8.0\n3.8-dev\n3.8.1\n3.9-dev\n……省略部分信息\nanaconda3-2018.12\nanaconda3-2019.03\nanaconda3-2019.07\nanaconda3-2019.10\n……省略部分信息\n[root@python ~]#\n```\n2、pyenv切换python版本\n由于pyenv可以安装的Python版本列表非常长，所以，这里进行了省略。读者可以在自己电脑上安装 pyenv，然后执行pyenv install --list命令进行查看。可以看到，pyenv不但可以安装不同的Python版 本，而且还可以安装不同的Python实现，也可以安装版本的Python用以学习。\n\n查看当前系统中包含的Python版本：\n```bash\n[root@python ~]# pyenv versions \n* system (set by /root/.pyenv/version)\n使用pyenv安装不同的Python版本：\n[root@python ~]#pyenv install -v 3.8.1  \n[root@python ~]#pyenv install -v 2.7.13 \n```\n再次查看当前系统中包含的Python版本\n\n```bash\n[root@python ~]# pyenv versions\n* system (set by /root/.pyenv/version)\n  2.7.13\n  3.8.1\n```\n\n3. 切换前为3.8.1\n\n```bash\n#切换当前为3.8.1\n[root@python ~]# python\nPython 3.8.1 (default, Apr 20 2020, 15:00:10) \n[GCC 4.8.5 20150623 (Red Hat 4.8.5-39)] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more informatio\n```\n\n4. 切换为2.7.13\n\n```bash\n[root@python ~]# pyenv  global 2.7.13 \n[root@python ~]# python\nPython 2.7.13 (default, Apr 20 2020, 15:04:15) \n[GCC 4.8.5 20150623 (Red Hat 4.8.5-39)] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n```\n使用pyenv以后，可以快速切换Python的版本。切换Python版本以后，与版本相关的依赖也会一起切 换。因此，我们不用担心不同的版本在系统中是否会相互干扰。例如，切换Python版本以后，相应的 pip也会跟着切换，所以不用担心自己使用的pip版本和Python版本不匹配的问题，如下所示：\n\n```bash\n[root@python ~]# pyenv  global 3.8.1\n[root@python ~]# pip --version\npip 19.2.3 from /root/.pyenv/versions/3.8.1/lib/python3.8/site-packages/pip (python 3.8)\n如果想要删除Python版本，使用uninstall命令即可。如下所示：\n[root@python ~]# pyenv uninstall 2.7.10\n```\n## 三、pyenv-virtualenv的使用\n有了pyenv-virtualenv以后，我们可以为同一个Python解释器，创建多个不同的工作环境。例如，我们 新建两个工作环境：\n\n```bash\n[root@python ~]# pyenv virtualenv 3.8.1 first_project \n[root@python ~]# pyenv virtualenv 3.8.1 second_projec\n可以使用virtualenvs子命令查看工作环境\n[root@python ~]# pyenv virtualenvs\n  3.8.1/envs/first_project (created from /root/.pyenv/versions/3.8.1)\n  3.8.1/envs/second_projec (created from /root/.pyenv/versions/3.8.1)\n  first_project (created from /root/.pyenv/versions/3.8.1)\n  second_projec (created from /root/.pyenv/versions/3.8.1)\n```\n创建完工作环境以后，可以通过activate和deactivate子命令进入或退出一个工作环境。进入工作环境 以后，左边的提示符会显示你当前所在的工作环境，以免因为环境太多导致操作错误。\n\n\n```bash\n(first_project) \n[root@python ~]# pip install flask==1.1.1 \nLooking in indexes: https://pypi.doubanio.com/simple\nCollecting flask==1.1.1\n  Downloading https://pypi.doubanio.com/packages/9b/93/628509b8d5dc749656a9641f4caf13540e2cdec85276964ff8f43bbb1d3b/Flask-1.1.1-py2.py3-none-any.whl (94kB)\n     |███▌                            | 10kB 28.0MB/s eta 0:00:\n     |███████                         | 20kB 1.8MB/s eta 0:00:0\n     |██████████▍                     | 30kB 2.7MB/s eta 0:00:0\n     |█████████████▉                  | 40kB 1.8MB/s eta 0:00:0\n     |█████████████████▍              | 51kB 1.3MB/s eta 0:00:0\n     |████████████████████▉           | 61kB 1.5MB/s eta 0:00:0\n     |████████████████████████▎       | 71kB 1.4MB/s eta 0:00:0\n     |███████████████████████████▊    | 81kB 1.3MB/s eta 0:00:0\n     |███████████████████████████████▏| 92kB 1.4MB/s eta 0:00:0\n     |████████████████████████████████| 102kB 1.6MB/s \nCollecting itsdangerous>=0.24 (from flask==1.1.1)\n(first_project) [root@python ~]# pyenv deactivate\n## 退出first_project环境\n[root@python ~]# \n```\n接下来，我们看一下在不同的工作环境安装不同的Flask版本\n\n```bash\n[root@python ~]# pyenv activate first_project \n##切换工作环境\n(first_project) [root@python ~]# pip install flask==1.1.1 \n##安装1.1.1的flask\n(first_project) [root@python ~]# pyenv deactivate \n##退出目前工作环境\n[root@python ~]#\n\n[root@python ~]# pyenv activate second_projec\n##切换工作环境\n(second_project) [root@python ~]# pip install flask==0.10.1\n##安装0.10.1的flask\n(second_project) [root@python ~]# pyenv deactivate \n##退出目前工作环境\n[root@python ~]#\n```\n查看一下两个工作环境源目录\npyenv的安装和简单使用（git、pyenv、pyenv-virtualenv）\n\n如果想要删除虚拟环境，则使用：\n\n```bash\n(first_project)\n [root@python ~]# pyenv virtualenv-delete first_project \n```\n使用pyenv和python-virtualenv插件，我们就能够自由地在不同的版本之间进行切换，相比管理Python 版本，不但节省了时间，也避免了工作过程中的相互干扰。\n\n## 四、更新 pyenv\n由于我们是 git 克隆的，所以更新非常简单\n```bash\ncd ~/.pyenv` 或者 `cd $(pyenv root)`\n `git pull\n```\n## 五、卸载 pyenv\n由于 pyenv 把一切都放在 ~/.pyenv 下了，所以卸载很方便，两个步骤就行了\n\n首先你需要删除环境变量\n\n然后你需要执行：\n\n```bash\nrm -rf ~/.pyenv` 或者 `rm -rf $(pyenv root)\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","slug":"2020/2020-09/2020-09-18","published":1,"updated":"2020-09-17T16:49:05.433Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckf71udcv00007l9k85cwb7qg","content":"<p>[TOC]</p>\n<p><img src=\"https://i.loli.net/2020/09/18/7eGfMl86NDjUkFd.jpg\" alt=\"python生态工具\"></p>\n<h1 id=\"python工作环境管理\"><a class=\"markdownIt-Anchor\" href=\"#python工作环境管理\"></a> Python工作环境管理</h1>\n<p>Python 2和Python 3之间存在着较大的差异，并且，由于各种原因导致了Python 2和Python 3的长期 共存。在实际工作过程中，我们可能会同时用到Python 2和Python 3，因此，需要经常在Python 2和 Python 3之间进行来回切换。此外，如果你是喜欢尝鲜的人，那么，你很有可能在Python新版本出来 的时候立即下载Python的版本，试验Python的特性。</p>\n<p>在Python世界里，除了需要对Python的版本进行管理以外，还需要对不同的软件包进行管理。大部分 情况下，对于开源的库我们使用版本即可。但是，有时候可能需要对相同的Python版本，在不同的 项目中使用不同版本的软件包。</p>\n<p>在这一节里，我们将介绍两个工具，即pyenv和virtualenv。前者用于管理不同的Python版本，后者用 于管理不同的工作环境。有了这两个工具，Python相关的版本问题将不再是问题。</p>\n<h2 id=\"1-情景问题\"><a class=\"markdownIt-Anchor\" href=\"#1-情景问题\"></a> 1、情景问题</h2>\n<ol>\n<li>Python解释器版本混乱, 2和3差别巨大, 而且细分版本也不尽相同, 难以选择和管理.</li>\n<li>不同Linux发行版自带Python不同, 如ubuntu16自带2.7和3.5版本, 其中系统许多组件依赖于自带解释器, 一旦删除或者更改都可能会造成系统出问题.</li>\n<li>不同的Python解释器软件包管理也是问题, 如pip和ipython等必备包组件, 而且在项目开发中如何保证不同的包环境互不干扰也是一个问题.</li>\n<li></li>\n</ol>\n<p>那么有没有一个终极的解决办法能在管理不同解释器版本的同时控制不同的包环境呢? 有的, 就是pyenv.</p>\n<h2 id=\"2-使用pyenv管理不同的python版本\"><a class=\"markdownIt-Anchor\" href=\"#2-使用pyenv管理不同的python版本\"></a> 2、使用pyenv管理不同的Python版本</h2>\n<p>安装不同的Python版本并不是一件容易的事情，在不同的Python版本之间来回切换更加困难，而且， 多版本并存非常容易互相干扰。因此，我们需要一个名为pyenv的工具。pyenv是一个Python版本管理 工具，它能够进行全局的Python版本切换，也可以为单个项目提供对应的Python版本。使用pyenv以 后，可以在服务器上安装多个不同的Python版本，也可以安装不同的Python实现。不同Python版本之 间的切换也非常简单。接下来我们就一起看一下pyenv的安装和使用。</p>\n<h2 id=\"pyenv是什么-能干什么\"><a class=\"markdownIt-Anchor\" href=\"#pyenv是什么-能干什么\"></a> pyenv是什么? 能干什么?</h2>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pyenv是一个forked自ruby社区的简单、低调、遵循UNIX哲</span><br><span class=\"line\"></span><br><span class=\"line\">学的Python环境管理工具, 它可以轻松切换全局解释器版本, </span><br><span class=\"line\"></span><br><span class=\"line\">同时结合vitualenv插件可以方便的管理对应的包源.</span><br></pre></td></tr></table></figure>\n<p>我们知道, 在terminal中输入一个命令比如‘ls’时, shell会从当前环境的PATH中的各个目录里看是不是有ls这个可执行文件, 如果找到就执行, 否则就会报‘command no found’ 的错误, 同理, 只要控制PATH变量就能够做到python版本的切换, pyenv通过在PATH头部插入shims路径来实现对python版本的控制.</p>\n<p>pyenv和流行的pipenv、virtualenv的关系</p>\n<p>pipenv是requests 作者 Kenneth Reitz大神写的一个python虚拟环境管理工具, 结合了pip和virtualenv的功能, 侧重点还是在包环境管理上, 使用思路是先创建一个指定python版本的环境, 然后在此环境上安装相应的包, 好评不错, 看到很多大牛都在推荐.</p>\n<p>pipenv是requests 作者 Kenneth Reitz大神写的一个python虚拟环境管理工具, 结合了pip和virtualenv的功能, 侧重点还是在包环境管理上, 使用思路是先创建一个指定python版本的环境, 然后在此环境上安装相应的包, 好评不错, 看到很多大牛都在推荐.</p>\n<p>pyenv相对来说知名度就差很多了, 不过也很稳定, 这三个环境管理工具我都用过, 我个人更喜欢pyenv, 理由如下:</p>\n<ol>\n<li>相对于其他两个工具, pyenv更侧重在python 解释器版本管理上, 比包管理更大一个层级, 使用pyenv我可以方便的下载指定版本的python解释器, pypy, anaconda等, 可以随时自由的在shell环境中本地、全局切换python解释器</li>\n<li>开发的时候不需要限定某个版本的虚拟环境, 只需要在部署的时候用pyenv指定某个版本就好了</li>\n<li>pyenv切换解释器版本的时候, pip和ipython以及对应的包环境都是一起切换的, 所以如果你要同时运行ipython2.x和ipython3.x多个解释器验证一些代码时就很方便</li>\n<li>pyenv也可以创建好指定的虚拟环境, 但不需要指定具体目录, 自由度更高, 使用也简单</li>\n</ol>\n<h2 id=\"4-简单使用\"><a class=\"markdownIt-Anchor\" href=\"#4-简单使用\"></a> 4、简单使用</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看当前版本</span></span><br><span class=\"line\">pyenv version</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看所有版本</span></span><br><span class=\"line\">pyenv versions</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看所有可安装的版本</span></span><br><span class=\"line\">pyenv install --list</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 安装指定版本</span></span><br><span class=\"line\">pyenv install 3.6.5</span><br><span class=\"line\"><span class=\"comment\"># 安装新版本后rehash一下</span></span><br><span class=\"line\">pyenv <span class=\"built_in\">rehash</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 删除指定版本</span></span><br><span class=\"line\">pyenv uninstall 3.5.2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 指定全局版本</span></span><br><span class=\"line\">pyenv global 3.6.5</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 指定多个全局版本, 3版本优先</span></span><br><span class=\"line\">pyenv global 3.6.5 2.7.14</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 实际上当你切换版本后, 相应的pip和包仓库都是会自动切换过去的</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"一-pyenv安装\"><a class=\"markdownIt-Anchor\" href=\"#一-pyenv安装\"></a> 一、pyenv安装</h2>\n<ol>\n<li>安装 pyenv</li>\n</ol>\n<p>说明：本文的所有安装都严格遵守官方文档，与官方文档完全保持一致。</p>\n<p>git 地址：<a href=\"https://github.com/pyenv/pyenv\" target=\"_blank\" rel=\"noopener\">https://github.com/pyenv/pyenv</a></p>\n<p>在你的终端中执行如下命令，安全无毒，请放心食用：</p>\n<p>首先把项目克隆下来，放在家目录下的隐藏文件夹中：.pyenv</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/pyenv/pyenv.git ~/.pyenv</span><br></pre></td></tr></table></figure>\n<p>然后配置变量</p>\n<p>如果你使用 bash，就依次执行如下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'export PYENV_ROOT=\"$HOME/.pyenv\"'</span> &gt;&gt; ~/.bashrc</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'export PATH=\"$PYENV_ROOT/bin:$PATH\"'</span> &gt;&gt; ~/.bashrc</span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">'if command -v pyenv 1&gt;/dev/null 2&gt;&amp;1; then\\n eval \"$(pyenv init -)\"\\nfi'</span> &gt;&gt; ~/.bashrc</span><br></pre></td></tr></table></figure>\n<p>如果你使用 zsh，就依次执行如下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'export PYENV_ROOT=\"$HOME/.pyenv\"'</span> &gt;&gt; ~/.zshrc</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'export PATH=\"$PYENV_ROOT/bin:$PATH\"'</span> &gt;&gt; ~/.zshrc</span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">'if command -v pyenv 1&gt;/dev/null 2&gt;&amp;1; then\\n eval \"$(pyenv init -)\"\\nfi'</span> &gt;&gt; ~/.zshrc</span><br></pre></td></tr></table></figure>\n<p>echo 命令的含义是：将引号中内容写入某文件中<br>\n请注意，以上的三条 echo 命令的最后一条长长的命令，请你保证它引号中的内容处于 ~/.bashrc 或者 ~/.zshrc 的最底部。<br>\n因为在 pyenv 初始化期间会操作 path 环境变量，导致不可预测的行为。<br>\n查看文件的底部内容，可以使用 tail 命令，用法：tail ~/.bashrc 或者 tail ~/.zshrc，编辑文件可以使用 vim 或者 vscode</p>\n<p>最后，在使用 pyenv 之前，重新初始化 shell 环境，执行如下命令</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">exec</span> <span class=\"variable\">$SHELL</span> 或者 <span class=\"built_in\">source</span></span><br></pre></td></tr></table></figure>\n<p>不执行该命令也是完全可以的，你可以关闭当前的终端窗口，重新启动一个就可以了。</p>\n<p>此时，你已经完成了 pyenv 的安装了，你使用可以它的全部命令了，但是我建议你先别急着用，一口气装完 pyenv 的一个插件，那就是 pyenv-virtualenv</p>\n<ol start=\"2\">\n<li>安装 pyenv-virtualenv</li>\n</ol>\n<p>virtualenv本身是一个独立的项目，用以隔离不同项目的工作环境。例如，用户lmx希望在项目A中使用 Flask 0.8这个版本，与此同时，又想在项目B中使用Flask 0.9这个版本。如果我们全局安装Flask，必然 无法满足用户的需求。这个时候，我们就可以使用virtualenv。</p>\n<p>读者需要注意pyenv和virtualenv的区别。pyenv用以管理不同的Python版本，例如，你的系统工作时 使用Python 2.7.13，学习时使用Python 3.6.0。virtualenv用以隔离项目的工作环境，例如，项目A和 项目B都是使用Python 2.7.13，但是，项目A需要使用Flask 0.8版本，项目B需要使用Flask 0.9版本。我 们只要组合pyenv和virtualenv这两个工具，就能够构造Python和第三方库的任意版本组合，拥有很好 的灵活性，也避免了项目之间的相互干扰。</p>\n<p>virtualenv本身是一个独立的工具，用户可以不使用pyenv而单独使用virtualenv。但是，如果你使用了 pyenv，就需要安装pyenv-virtualenv插件，而不是通过virtualenv软件使用virtualenv的功能。</p>\n<p>git 地址：<a href=\"https://github.com/pyenv/pyenv-virtualenv\" target=\"_blank\" rel=\"noopener\">https://github.com/pyenv/pyenv-virtualenv</a></p>\n<p>(1) 把插件克隆在刚才已经安装完毕的 pyenv 的 plugins 文件夹中</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/pyenv/pyenv-virtualenv.git $(pyenv root)/plugins/pyenv-virtualenv</span><br></pre></td></tr></table></figure>\n<p>(2) 然后配置环境变量<br>\n如果你使用 bash，就执行如下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'eval \"$(pyenv virtualenv-init -)\"'</span> &gt;&gt; ~/.bashrc</span><br></pre></td></tr></table></figure>\n<p>如果你使用 zsh，就执行如下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'eval \"$(pyenv virtualenv-init -)\"'</span> &gt;&gt; ~/.zshrc</span><br></pre></td></tr></table></figure>\n<p>(3) 最后，在使用 pyenv 之前，重新初始化 shell 环境，执行如下命令</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">exec</span> <span class=\"variable\">$SHELL</span></span><br></pre></td></tr></table></figure>\n<p>不执行该命令也是完全可以的，你可以关闭当前的终端窗口，重新启动一个就可以了。</p>\n<p>至此，pyenv就安装完成了，我们可以通过下面的命令验证pyenv是否正确安装并获取pyenv的帮助信息：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pyenv --<span class=\"built_in\">help</span></span><br><span class=\"line\">Usage: pyenv &lt;<span class=\"built_in\">command</span>&gt; [&lt;args&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Some useful pyenv commands are:</span><br><span class=\"line\">   --version   Display the version of pyenv</span><br><span class=\"line\">   activate    Activate virtual environment</span><br><span class=\"line\">   commands    List all available pyenv commands</span><br><span class=\"line\">   deactivate   Deactivate virtual environment</span><br><span class=\"line\">   <span class=\"built_in\">exec</span>        Run an executable with the selected Python version</span><br><span class=\"line\">   global      Set or show the global Python version(s)</span><br><span class=\"line\">   <span class=\"built_in\">help</span>        Display <span class=\"built_in\">help</span> <span class=\"keyword\">for</span> a <span class=\"built_in\">command</span></span><br><span class=\"line\">   hooks       List hook scripts <span class=\"keyword\">for</span> a given pyenv <span class=\"built_in\">command</span></span><br><span class=\"line\">   init        Configure the shell environment <span class=\"keyword\">for</span> pyenv</span><br><span class=\"line\">   install     Install a Python version using python-build</span><br><span class=\"line\">   <span class=\"built_in\">local</span>       Set or show the <span class=\"built_in\">local</span> application-specific Python version(s)</span><br><span class=\"line\">   prefix      Display prefix <span class=\"keyword\">for</span> a Python version</span><br><span class=\"line\">   <span class=\"built_in\">rehash</span>      Rehash pyenv shims (run this after installing executables)</span><br><span class=\"line\">   root        Display the root directory <span class=\"built_in\">where</span> versions and shims are kept</span><br><span class=\"line\">   shell       Set or show the shell-specific Python version</span><br><span class=\"line\">   shims       List existing pyenv shims</span><br><span class=\"line\">   uninstall   Uninstall a specific Python version</span><br><span class=\"line\">   version     Show the current Python version(s) and its origin</span><br><span class=\"line\">   version-file   Detect the file that sets the current pyenv version</span><br><span class=\"line\">   version-name   Show the current Python version</span><br><span class=\"line\">   version-origin   Explain how the current Python version is <span class=\"built_in\">set</span></span><br><span class=\"line\">   versions    List all Python versions available to pyenv</span><br><span class=\"line\">   virtualenv   Create a Python virtualenv using the pyenv-virtualenv plugin</span><br><span class=\"line\">   virtualenv-delete   Uninstall a specific Python virtualenv</span><br><span class=\"line\">   virtualenv-init   Configure the shell environment <span class=\"keyword\">for</span> pyenv-virtualenv</span><br><span class=\"line\">   virtualenv-prefix   Display real_prefix <span class=\"keyword\">for</span> a Python virtualenv version</span><br><span class=\"line\">   virtualenvs   List all Python virtualenvs found <span class=\"keyword\">in</span> `<span class=\"variable\">$PYENV_ROOT</span>/versions/*<span class=\"string\">'.</span></span><br><span class=\"line\"><span class=\"string\">   whence      List all Python versions that contain the given executable</span></span><br><span class=\"line\"><span class=\"string\">   which       Display the full path to an executable</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">See `pyenv help &lt;command&gt;'</span> <span class=\"keyword\">for</span> information on a specific <span class=\"built_in\">command</span>.</span><br><span class=\"line\">For full documentation, see: https://github.com/pyenv/pyenv<span class=\"comment\">#readme</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"二-使用-pyenv\"><a class=\"markdownIt-Anchor\" href=\"#二-使用-pyenv\"></a> 二、使用 pyenv</h2>\n<p>此处仅仅展示 pyenv 和 virtualenv 的日常用法</p>\n<p>1、检查安装是否正确<br>\n检查 pyenv 的版本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv version</span></span><br><span class=\"line\">(<span class=\"built_in\">set</span> by /root/.pyenv/version)</span><br><span class=\"line\">查看 pyenv 已经管理了哪些 python 版本</span><br><span class=\"line\">[root@python ~]<span class=\"comment\">#pyenv versions</span></span><br><span class=\"line\">* system (<span class=\"built_in\">set</span> by /root/.pyenv/version)</span><br></pre></td></tr></table></figure>\n<p>如果你看到了正常的版本信息，就说明可以了，如果看到了类似于 command not found 之类的，就说明安装失败了。</p>\n<p>我们通过pyenv的install命令，可以查看pyenv当前支持哪些Python版本，如下所示：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv install --list </span></span><br><span class=\"line\">Available versions:</span><br><span class=\"line\">2.1.3</span><br><span class=\"line\">……省略部分信息</span><br><span class=\"line\">3.8.0</span><br><span class=\"line\">3.8-dev</span><br><span class=\"line\">3.8.1</span><br><span class=\"line\">3.9-dev</span><br><span class=\"line\">……省略部分信息</span><br><span class=\"line\">anaconda3-2018.12</span><br><span class=\"line\">anaconda3-2019.03</span><br><span class=\"line\">anaconda3-2019.07</span><br><span class=\"line\">anaconda3-2019.10</span><br><span class=\"line\">……省略部分信息</span><br><span class=\"line\">[root@python ~]<span class=\"comment\">#</span></span><br></pre></td></tr></table></figure>\n<p>2、pyenv切换python版本<br>\n由于pyenv可以安装的Python版本列表非常长，所以，这里进行了省略。读者可以在自己电脑上安装 pyenv，然后执行pyenv install --list命令进行查看。可以看到，pyenv不但可以安装不同的Python版 本，而且还可以安装不同的Python实现，也可以安装版本的Python用以学习。</p>\n<p>查看当前系统中包含的Python版本：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv versions </span></span><br><span class=\"line\">* system (<span class=\"built_in\">set</span> by /root/.pyenv/version)</span><br><span class=\"line\">使用pyenv安装不同的Python版本：</span><br><span class=\"line\">[root@python ~]<span class=\"comment\">#pyenv install -v 3.8.1  </span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\">#pyenv install -v 2.7.13</span></span><br></pre></td></tr></table></figure>\n<p>再次查看当前系统中包含的Python版本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv versions</span></span><br><span class=\"line\">* system (<span class=\"built_in\">set</span> by /root/.pyenv/version)</span><br><span class=\"line\">  2.7.13</span><br><span class=\"line\">  3.8.1</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>切换前为3.8.1</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#切换当前为3.8.1</span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># python</span></span><br><span class=\"line\">Python 3.8.1 (default, Apr 20 2020, 15:00:10) </span><br><span class=\"line\">[GCC 4.8.5 20150623 (Red Hat 4.8.5-39)] on linux</span><br><span class=\"line\">Type <span class=\"string\">\"help\"</span>, <span class=\"string\">\"copyright\"</span>, <span class=\"string\">\"credits\"</span> or <span class=\"string\">\"license\"</span> <span class=\"keyword\">for</span> more informatio</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li>切换为2.7.13</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv  global 2.7.13 </span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># python</span></span><br><span class=\"line\">Python 2.7.13 (default, Apr 20 2020, 15:04:15) </span><br><span class=\"line\">[GCC 4.8.5 20150623 (Red Hat 4.8.5-39)] on linux2</span><br><span class=\"line\">Type <span class=\"string\">\"help\"</span>, <span class=\"string\">\"copyright\"</span>, <span class=\"string\">\"credits\"</span> or <span class=\"string\">\"license\"</span> <span class=\"keyword\">for</span> more information.</span><br></pre></td></tr></table></figure>\n<p>使用pyenv以后，可以快速切换Python的版本。切换Python版本以后，与版本相关的依赖也会一起切 换。因此，我们不用担心不同的版本在系统中是否会相互干扰。例如，切换Python版本以后，相应的 pip也会跟着切换，所以不用担心自己使用的pip版本和Python版本不匹配的问题，如下所示：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv  global 3.8.1</span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># pip --version</span></span><br><span class=\"line\">pip 19.2.3 from /root/.pyenv/versions/3.8.1/lib/python3.8/site-packages/pip (python 3.8)</span><br><span class=\"line\">如果想要删除Python版本，使用uninstall命令即可。如下所示：</span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv uninstall 2.7.10</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"三-pyenv-virtualenv的使用\"><a class=\"markdownIt-Anchor\" href=\"#三-pyenv-virtualenv的使用\"></a> 三、pyenv-virtualenv的使用</h2>\n<p>有了pyenv-virtualenv以后，我们可以为同一个Python解释器，创建多个不同的工作环境。例如，我们 新建两个工作环境：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv virtualenv 3.8.1 first_project </span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv virtualenv 3.8.1 second_projec</span></span><br><span class=\"line\">可以使用virtualenvs子命令查看工作环境</span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv virtualenvs</span></span><br><span class=\"line\">  3.8.1/envs/first_project (created from /root/.pyenv/versions/3.8.1)</span><br><span class=\"line\">  3.8.1/envs/second_projec (created from /root/.pyenv/versions/3.8.1)</span><br><span class=\"line\">  first_project (created from /root/.pyenv/versions/3.8.1)</span><br><span class=\"line\">  second_projec (created from /root/.pyenv/versions/3.8.1)</span><br></pre></td></tr></table></figure>\n<p>创建完工作环境以后，可以通过activate和deactivate子命令进入或退出一个工作环境。进入工作环境 以后，左边的提示符会显示你当前所在的工作环境，以免因为环境太多导致操作错误。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(first_project) </span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># pip install flask==1.1.1 </span></span><br><span class=\"line\">Looking <span class=\"keyword\">in</span> indexes: https://pypi.doubanio.com/simple</span><br><span class=\"line\">Collecting flask==1.1.1</span><br><span class=\"line\">  Downloading https://pypi.doubanio.com/packages/9b/93/628509b8d5dc749656a9641f4caf13540e2cdec85276964ff8f43bbb1d3b/Flask-1.1.1-py2.py3-none-any.whl (94kB)</span><br><span class=\"line\">     |███▌                            | 10kB 28.0MB/s eta 0:00:</span><br><span class=\"line\">     |███████                         | 20kB 1.8MB/s eta 0:00:0</span><br><span class=\"line\">     |██████████▍                     | 30kB 2.7MB/s eta 0:00:0</span><br><span class=\"line\">     |█████████████▉                  | 40kB 1.8MB/s eta 0:00:0</span><br><span class=\"line\">     |█████████████████▍              | 51kB 1.3MB/s eta 0:00:0</span><br><span class=\"line\">     |████████████████████▉           | 61kB 1.5MB/s eta 0:00:0</span><br><span class=\"line\">     |████████████████████████▎       | 71kB 1.4MB/s eta 0:00:0</span><br><span class=\"line\">     |███████████████████████████▊    | 81kB 1.3MB/s eta 0:00:0</span><br><span class=\"line\">     |███████████████████████████████▏| 92kB 1.4MB/s eta 0:00:0</span><br><span class=\"line\">     |████████████████████████████████| 102kB 1.6MB/s </span><br><span class=\"line\">Collecting itsdangerous&gt;=0.24 (from flask==1.1.1)</span><br><span class=\"line\">(first_project) [root@python ~]<span class=\"comment\"># pyenv deactivate</span></span><br><span class=\"line\"><span class=\"comment\">## 退出first_project环境</span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\">#</span></span><br></pre></td></tr></table></figure>\n<p>接下来，我们看一下在不同的工作环境安装不同的Flask版本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv activate first_project </span></span><br><span class=\"line\"><span class=\"comment\">##切换工作环境</span></span><br><span class=\"line\">(first_project) [root@python ~]<span class=\"comment\"># pip install flask==1.1.1 </span></span><br><span class=\"line\"><span class=\"comment\">##安装1.1.1的flask</span></span><br><span class=\"line\">(first_project) [root@python ~]<span class=\"comment\"># pyenv deactivate </span></span><br><span class=\"line\"><span class=\"comment\">##退出目前工作环境</span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\">#</span></span><br><span class=\"line\"></span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv activate second_projec</span></span><br><span class=\"line\"><span class=\"comment\">##切换工作环境</span></span><br><span class=\"line\">(second_project) [root@python ~]<span class=\"comment\"># pip install flask==0.10.1</span></span><br><span class=\"line\"><span class=\"comment\">##安装0.10.1的flask</span></span><br><span class=\"line\">(second_project) [root@python ~]<span class=\"comment\"># pyenv deactivate </span></span><br><span class=\"line\"><span class=\"comment\">##退出目前工作环境</span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\">#</span></span><br></pre></td></tr></table></figure>\n<p>查看一下两个工作环境源目录<br>\npyenv的安装和简单使用（git、pyenv、pyenv-virtualenv）</p>\n<p>如果想要删除虚拟环境，则使用：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(first_project)</span><br><span class=\"line\"> [root@python ~]<span class=\"comment\"># pyenv virtualenv-delete first_project</span></span><br></pre></td></tr></table></figure>\n<p>使用pyenv和python-virtualenv插件，我们就能够自由地在不同的版本之间进行切换，相比管理Python 版本，不但节省了时间，也避免了工作过程中的相互干扰。</p>\n<h2 id=\"四-更新-pyenv\"><a class=\"markdownIt-Anchor\" href=\"#四-更新-pyenv\"></a> 四、更新 pyenv</h2>\n<p>由于我们是 git 克隆的，所以更新非常简单</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> ~/.pyenv` 或者 `<span class=\"built_in\">cd</span> $(pyenv root)`</span><br><span class=\"line\"> `git pull</span><br></pre></td></tr></table></figure>\n<h2 id=\"五-卸载-pyenv\"><a class=\"markdownIt-Anchor\" href=\"#五-卸载-pyenv\"></a> 五、卸载 pyenv</h2>\n<p>由于 pyenv 把一切都放在 ~/.pyenv 下了，所以卸载很方便，两个步骤就行了</p>\n<p>首先你需要删除环境变量</p>\n<p>然后你需要执行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -rf ~/.pyenv` 或者 `rm -rf $(pyenv root)</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p>[TOC]</p>\n<p><img src=\"https://i.loli.net/2020/09/18/7eGfMl86NDjUkFd.jpg\" alt=\"python生态工具\"></p>\n<h1 id=\"python工作环境管理\"><a class=\"markdownIt-Anchor\" href=\"#python工作环境管理\"></a> Python工作环境管理</h1>\n<p>Python 2和Python 3之间存在着较大的差异，并且，由于各种原因导致了Python 2和Python 3的长期 共存。在实际工作过程中，我们可能会同时用到Python 2和Python 3，因此，需要经常在Python 2和 Python 3之间进行来回切换。此外，如果你是喜欢尝鲜的人，那么，你很有可能在Python新版本出来 的时候立即下载Python的版本，试验Python的特性。</p>\n<p>在Python世界里，除了需要对Python的版本进行管理以外，还需要对不同的软件包进行管理。大部分 情况下，对于开源的库我们使用版本即可。但是，有时候可能需要对相同的Python版本，在不同的 项目中使用不同版本的软件包。</p>\n<p>在这一节里，我们将介绍两个工具，即pyenv和virtualenv。前者用于管理不同的Python版本，后者用 于管理不同的工作环境。有了这两个工具，Python相关的版本问题将不再是问题。</p>\n<h2 id=\"1-情景问题\"><a class=\"markdownIt-Anchor\" href=\"#1-情景问题\"></a> 1、情景问题</h2>\n<ol>\n<li>Python解释器版本混乱, 2和3差别巨大, 而且细分版本也不尽相同, 难以选择和管理.</li>\n<li>不同Linux发行版自带Python不同, 如ubuntu16自带2.7和3.5版本, 其中系统许多组件依赖于自带解释器, 一旦删除或者更改都可能会造成系统出问题.</li>\n<li>不同的Python解释器软件包管理也是问题, 如pip和ipython等必备包组件, 而且在项目开发中如何保证不同的包环境互不干扰也是一个问题.</li>\n<li></li>\n</ol>\n<p>那么有没有一个终极的解决办法能在管理不同解释器版本的同时控制不同的包环境呢? 有的, 就是pyenv.</p>\n<h2 id=\"2-使用pyenv管理不同的python版本\"><a class=\"markdownIt-Anchor\" href=\"#2-使用pyenv管理不同的python版本\"></a> 2、使用pyenv管理不同的Python版本</h2>\n<p>安装不同的Python版本并不是一件容易的事情，在不同的Python版本之间来回切换更加困难，而且， 多版本并存非常容易互相干扰。因此，我们需要一个名为pyenv的工具。pyenv是一个Python版本管理 工具，它能够进行全局的Python版本切换，也可以为单个项目提供对应的Python版本。使用pyenv以 后，可以在服务器上安装多个不同的Python版本，也可以安装不同的Python实现。不同Python版本之 间的切换也非常简单。接下来我们就一起看一下pyenv的安装和使用。</p>\n<h2 id=\"pyenv是什么-能干什么\"><a class=\"markdownIt-Anchor\" href=\"#pyenv是什么-能干什么\"></a> pyenv是什么? 能干什么?</h2>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pyenv是一个forked自ruby社区的简单、低调、遵循UNIX哲</span><br><span class=\"line\"></span><br><span class=\"line\">学的Python环境管理工具, 它可以轻松切换全局解释器版本, </span><br><span class=\"line\"></span><br><span class=\"line\">同时结合vitualenv插件可以方便的管理对应的包源.</span><br></pre></td></tr></table></figure>\n<p>我们知道, 在terminal中输入一个命令比如‘ls’时, shell会从当前环境的PATH中的各个目录里看是不是有ls这个可执行文件, 如果找到就执行, 否则就会报‘command no found’ 的错误, 同理, 只要控制PATH变量就能够做到python版本的切换, pyenv通过在PATH头部插入shims路径来实现对python版本的控制.</p>\n<p>pyenv和流行的pipenv、virtualenv的关系</p>\n<p>pipenv是requests 作者 Kenneth Reitz大神写的一个python虚拟环境管理工具, 结合了pip和virtualenv的功能, 侧重点还是在包环境管理上, 使用思路是先创建一个指定python版本的环境, 然后在此环境上安装相应的包, 好评不错, 看到很多大牛都在推荐.</p>\n<p>pipenv是requests 作者 Kenneth Reitz大神写的一个python虚拟环境管理工具, 结合了pip和virtualenv的功能, 侧重点还是在包环境管理上, 使用思路是先创建一个指定python版本的环境, 然后在此环境上安装相应的包, 好评不错, 看到很多大牛都在推荐.</p>\n<p>pyenv相对来说知名度就差很多了, 不过也很稳定, 这三个环境管理工具我都用过, 我个人更喜欢pyenv, 理由如下:</p>\n<ol>\n<li>相对于其他两个工具, pyenv更侧重在python 解释器版本管理上, 比包管理更大一个层级, 使用pyenv我可以方便的下载指定版本的python解释器, pypy, anaconda等, 可以随时自由的在shell环境中本地、全局切换python解释器</li>\n<li>开发的时候不需要限定某个版本的虚拟环境, 只需要在部署的时候用pyenv指定某个版本就好了</li>\n<li>pyenv切换解释器版本的时候, pip和ipython以及对应的包环境都是一起切换的, 所以如果你要同时运行ipython2.x和ipython3.x多个解释器验证一些代码时就很方便</li>\n<li>pyenv也可以创建好指定的虚拟环境, 但不需要指定具体目录, 自由度更高, 使用也简单</li>\n</ol>\n<h2 id=\"4-简单使用\"><a class=\"markdownIt-Anchor\" href=\"#4-简单使用\"></a> 4、简单使用</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看当前版本</span></span><br><span class=\"line\">pyenv version</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看所有版本</span></span><br><span class=\"line\">pyenv versions</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看所有可安装的版本</span></span><br><span class=\"line\">pyenv install --list</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 安装指定版本</span></span><br><span class=\"line\">pyenv install 3.6.5</span><br><span class=\"line\"><span class=\"comment\"># 安装新版本后rehash一下</span></span><br><span class=\"line\">pyenv <span class=\"built_in\">rehash</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 删除指定版本</span></span><br><span class=\"line\">pyenv uninstall 3.5.2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 指定全局版本</span></span><br><span class=\"line\">pyenv global 3.6.5</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 指定多个全局版本, 3版本优先</span></span><br><span class=\"line\">pyenv global 3.6.5 2.7.14</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 实际上当你切换版本后, 相应的pip和包仓库都是会自动切换过去的</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"一-pyenv安装\"><a class=\"markdownIt-Anchor\" href=\"#一-pyenv安装\"></a> 一、pyenv安装</h2>\n<ol>\n<li>安装 pyenv</li>\n</ol>\n<p>说明：本文的所有安装都严格遵守官方文档，与官方文档完全保持一致。</p>\n<p>git 地址：<a href=\"https://github.com/pyenv/pyenv\" target=\"_blank\" rel=\"noopener\">https://github.com/pyenv/pyenv</a></p>\n<p>在你的终端中执行如下命令，安全无毒，请放心食用：</p>\n<p>首先把项目克隆下来，放在家目录下的隐藏文件夹中：.pyenv</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/pyenv/pyenv.git ~/.pyenv</span><br></pre></td></tr></table></figure>\n<p>然后配置变量</p>\n<p>如果你使用 bash，就依次执行如下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'export PYENV_ROOT=\"$HOME/.pyenv\"'</span> &gt;&gt; ~/.bashrc</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'export PATH=\"$PYENV_ROOT/bin:$PATH\"'</span> &gt;&gt; ~/.bashrc</span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">'if command -v pyenv 1&gt;/dev/null 2&gt;&amp;1; then\\n eval \"$(pyenv init -)\"\\nfi'</span> &gt;&gt; ~/.bashrc</span><br></pre></td></tr></table></figure>\n<p>如果你使用 zsh，就依次执行如下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'export PYENV_ROOT=\"$HOME/.pyenv\"'</span> &gt;&gt; ~/.zshrc</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'export PATH=\"$PYENV_ROOT/bin:$PATH\"'</span> &gt;&gt; ~/.zshrc</span><br><span class=\"line\"><span class=\"built_in\">echo</span> -e <span class=\"string\">'if command -v pyenv 1&gt;/dev/null 2&gt;&amp;1; then\\n eval \"$(pyenv init -)\"\\nfi'</span> &gt;&gt; ~/.zshrc</span><br></pre></td></tr></table></figure>\n<p>echo 命令的含义是：将引号中内容写入某文件中<br>\n请注意，以上的三条 echo 命令的最后一条长长的命令，请你保证它引号中的内容处于 ~/.bashrc 或者 ~/.zshrc 的最底部。<br>\n因为在 pyenv 初始化期间会操作 path 环境变量，导致不可预测的行为。<br>\n查看文件的底部内容，可以使用 tail 命令，用法：tail ~/.bashrc 或者 tail ~/.zshrc，编辑文件可以使用 vim 或者 vscode</p>\n<p>最后，在使用 pyenv 之前，重新初始化 shell 环境，执行如下命令</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">exec</span> <span class=\"variable\">$SHELL</span> 或者 <span class=\"built_in\">source</span></span><br></pre></td></tr></table></figure>\n<p>不执行该命令也是完全可以的，你可以关闭当前的终端窗口，重新启动一个就可以了。</p>\n<p>此时，你已经完成了 pyenv 的安装了，你使用可以它的全部命令了，但是我建议你先别急着用，一口气装完 pyenv 的一个插件，那就是 pyenv-virtualenv</p>\n<ol start=\"2\">\n<li>安装 pyenv-virtualenv</li>\n</ol>\n<p>virtualenv本身是一个独立的项目，用以隔离不同项目的工作环境。例如，用户lmx希望在项目A中使用 Flask 0.8这个版本，与此同时，又想在项目B中使用Flask 0.9这个版本。如果我们全局安装Flask，必然 无法满足用户的需求。这个时候，我们就可以使用virtualenv。</p>\n<p>读者需要注意pyenv和virtualenv的区别。pyenv用以管理不同的Python版本，例如，你的系统工作时 使用Python 2.7.13，学习时使用Python 3.6.0。virtualenv用以隔离项目的工作环境，例如，项目A和 项目B都是使用Python 2.7.13，但是，项目A需要使用Flask 0.8版本，项目B需要使用Flask 0.9版本。我 们只要组合pyenv和virtualenv这两个工具，就能够构造Python和第三方库的任意版本组合，拥有很好 的灵活性，也避免了项目之间的相互干扰。</p>\n<p>virtualenv本身是一个独立的工具，用户可以不使用pyenv而单独使用virtualenv。但是，如果你使用了 pyenv，就需要安装pyenv-virtualenv插件，而不是通过virtualenv软件使用virtualenv的功能。</p>\n<p>git 地址：<a href=\"https://github.com/pyenv/pyenv-virtualenv\" target=\"_blank\" rel=\"noopener\">https://github.com/pyenv/pyenv-virtualenv</a></p>\n<p>(1) 把插件克隆在刚才已经安装完毕的 pyenv 的 plugins 文件夹中</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/pyenv/pyenv-virtualenv.git $(pyenv root)/plugins/pyenv-virtualenv</span><br></pre></td></tr></table></figure>\n<p>(2) 然后配置环境变量<br>\n如果你使用 bash，就执行如下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'eval \"$(pyenv virtualenv-init -)\"'</span> &gt;&gt; ~/.bashrc</span><br></pre></td></tr></table></figure>\n<p>如果你使用 zsh，就执行如下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">'eval \"$(pyenv virtualenv-init -)\"'</span> &gt;&gt; ~/.zshrc</span><br></pre></td></tr></table></figure>\n<p>(3) 最后，在使用 pyenv 之前，重新初始化 shell 环境，执行如下命令</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">exec</span> <span class=\"variable\">$SHELL</span></span><br></pre></td></tr></table></figure>\n<p>不执行该命令也是完全可以的，你可以关闭当前的终端窗口，重新启动一个就可以了。</p>\n<p>至此，pyenv就安装完成了，我们可以通过下面的命令验证pyenv是否正确安装并获取pyenv的帮助信息：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pyenv --<span class=\"built_in\">help</span></span><br><span class=\"line\">Usage: pyenv &lt;<span class=\"built_in\">command</span>&gt; [&lt;args&gt;]</span><br><span class=\"line\"></span><br><span class=\"line\">Some useful pyenv commands are:</span><br><span class=\"line\">   --version   Display the version of pyenv</span><br><span class=\"line\">   activate    Activate virtual environment</span><br><span class=\"line\">   commands    List all available pyenv commands</span><br><span class=\"line\">   deactivate   Deactivate virtual environment</span><br><span class=\"line\">   <span class=\"built_in\">exec</span>        Run an executable with the selected Python version</span><br><span class=\"line\">   global      Set or show the global Python version(s)</span><br><span class=\"line\">   <span class=\"built_in\">help</span>        Display <span class=\"built_in\">help</span> <span class=\"keyword\">for</span> a <span class=\"built_in\">command</span></span><br><span class=\"line\">   hooks       List hook scripts <span class=\"keyword\">for</span> a given pyenv <span class=\"built_in\">command</span></span><br><span class=\"line\">   init        Configure the shell environment <span class=\"keyword\">for</span> pyenv</span><br><span class=\"line\">   install     Install a Python version using python-build</span><br><span class=\"line\">   <span class=\"built_in\">local</span>       Set or show the <span class=\"built_in\">local</span> application-specific Python version(s)</span><br><span class=\"line\">   prefix      Display prefix <span class=\"keyword\">for</span> a Python version</span><br><span class=\"line\">   <span class=\"built_in\">rehash</span>      Rehash pyenv shims (run this after installing executables)</span><br><span class=\"line\">   root        Display the root directory <span class=\"built_in\">where</span> versions and shims are kept</span><br><span class=\"line\">   shell       Set or show the shell-specific Python version</span><br><span class=\"line\">   shims       List existing pyenv shims</span><br><span class=\"line\">   uninstall   Uninstall a specific Python version</span><br><span class=\"line\">   version     Show the current Python version(s) and its origin</span><br><span class=\"line\">   version-file   Detect the file that sets the current pyenv version</span><br><span class=\"line\">   version-name   Show the current Python version</span><br><span class=\"line\">   version-origin   Explain how the current Python version is <span class=\"built_in\">set</span></span><br><span class=\"line\">   versions    List all Python versions available to pyenv</span><br><span class=\"line\">   virtualenv   Create a Python virtualenv using the pyenv-virtualenv plugin</span><br><span class=\"line\">   virtualenv-delete   Uninstall a specific Python virtualenv</span><br><span class=\"line\">   virtualenv-init   Configure the shell environment <span class=\"keyword\">for</span> pyenv-virtualenv</span><br><span class=\"line\">   virtualenv-prefix   Display real_prefix <span class=\"keyword\">for</span> a Python virtualenv version</span><br><span class=\"line\">   virtualenvs   List all Python virtualenvs found <span class=\"keyword\">in</span> `<span class=\"variable\">$PYENV_ROOT</span>/versions/*<span class=\"string\">'.</span></span><br><span class=\"line\"><span class=\"string\">   whence      List all Python versions that contain the given executable</span></span><br><span class=\"line\"><span class=\"string\">   which       Display the full path to an executable</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">See `pyenv help &lt;command&gt;'</span> <span class=\"keyword\">for</span> information on a specific <span class=\"built_in\">command</span>.</span><br><span class=\"line\">For full documentation, see: https://github.com/pyenv/pyenv<span class=\"comment\">#readme</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"二-使用-pyenv\"><a class=\"markdownIt-Anchor\" href=\"#二-使用-pyenv\"></a> 二、使用 pyenv</h2>\n<p>此处仅仅展示 pyenv 和 virtualenv 的日常用法</p>\n<p>1、检查安装是否正确<br>\n检查 pyenv 的版本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv version</span></span><br><span class=\"line\">(<span class=\"built_in\">set</span> by /root/.pyenv/version)</span><br><span class=\"line\">查看 pyenv 已经管理了哪些 python 版本</span><br><span class=\"line\">[root@python ~]<span class=\"comment\">#pyenv versions</span></span><br><span class=\"line\">* system (<span class=\"built_in\">set</span> by /root/.pyenv/version)</span><br></pre></td></tr></table></figure>\n<p>如果你看到了正常的版本信息，就说明可以了，如果看到了类似于 command not found 之类的，就说明安装失败了。</p>\n<p>我们通过pyenv的install命令，可以查看pyenv当前支持哪些Python版本，如下所示：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv install --list </span></span><br><span class=\"line\">Available versions:</span><br><span class=\"line\">2.1.3</span><br><span class=\"line\">……省略部分信息</span><br><span class=\"line\">3.8.0</span><br><span class=\"line\">3.8-dev</span><br><span class=\"line\">3.8.1</span><br><span class=\"line\">3.9-dev</span><br><span class=\"line\">……省略部分信息</span><br><span class=\"line\">anaconda3-2018.12</span><br><span class=\"line\">anaconda3-2019.03</span><br><span class=\"line\">anaconda3-2019.07</span><br><span class=\"line\">anaconda3-2019.10</span><br><span class=\"line\">……省略部分信息</span><br><span class=\"line\">[root@python ~]<span class=\"comment\">#</span></span><br></pre></td></tr></table></figure>\n<p>2、pyenv切换python版本<br>\n由于pyenv可以安装的Python版本列表非常长，所以，这里进行了省略。读者可以在自己电脑上安装 pyenv，然后执行pyenv install --list命令进行查看。可以看到，pyenv不但可以安装不同的Python版 本，而且还可以安装不同的Python实现，也可以安装版本的Python用以学习。</p>\n<p>查看当前系统中包含的Python版本：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv versions </span></span><br><span class=\"line\">* system (<span class=\"built_in\">set</span> by /root/.pyenv/version)</span><br><span class=\"line\">使用pyenv安装不同的Python版本：</span><br><span class=\"line\">[root@python ~]<span class=\"comment\">#pyenv install -v 3.8.1  </span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\">#pyenv install -v 2.7.13</span></span><br></pre></td></tr></table></figure>\n<p>再次查看当前系统中包含的Python版本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv versions</span></span><br><span class=\"line\">* system (<span class=\"built_in\">set</span> by /root/.pyenv/version)</span><br><span class=\"line\">  2.7.13</span><br><span class=\"line\">  3.8.1</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>切换前为3.8.1</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#切换当前为3.8.1</span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># python</span></span><br><span class=\"line\">Python 3.8.1 (default, Apr 20 2020, 15:00:10) </span><br><span class=\"line\">[GCC 4.8.5 20150623 (Red Hat 4.8.5-39)] on linux</span><br><span class=\"line\">Type <span class=\"string\">\"help\"</span>, <span class=\"string\">\"copyright\"</span>, <span class=\"string\">\"credits\"</span> or <span class=\"string\">\"license\"</span> <span class=\"keyword\">for</span> more informatio</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li>切换为2.7.13</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv  global 2.7.13 </span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># python</span></span><br><span class=\"line\">Python 2.7.13 (default, Apr 20 2020, 15:04:15) </span><br><span class=\"line\">[GCC 4.8.5 20150623 (Red Hat 4.8.5-39)] on linux2</span><br><span class=\"line\">Type <span class=\"string\">\"help\"</span>, <span class=\"string\">\"copyright\"</span>, <span class=\"string\">\"credits\"</span> or <span class=\"string\">\"license\"</span> <span class=\"keyword\">for</span> more information.</span><br></pre></td></tr></table></figure>\n<p>使用pyenv以后，可以快速切换Python的版本。切换Python版本以后，与版本相关的依赖也会一起切 换。因此，我们不用担心不同的版本在系统中是否会相互干扰。例如，切换Python版本以后，相应的 pip也会跟着切换，所以不用担心自己使用的pip版本和Python版本不匹配的问题，如下所示：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv  global 3.8.1</span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># pip --version</span></span><br><span class=\"line\">pip 19.2.3 from /root/.pyenv/versions/3.8.1/lib/python3.8/site-packages/pip (python 3.8)</span><br><span class=\"line\">如果想要删除Python版本，使用uninstall命令即可。如下所示：</span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv uninstall 2.7.10</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"三-pyenv-virtualenv的使用\"><a class=\"markdownIt-Anchor\" href=\"#三-pyenv-virtualenv的使用\"></a> 三、pyenv-virtualenv的使用</h2>\n<p>有了pyenv-virtualenv以后，我们可以为同一个Python解释器，创建多个不同的工作环境。例如，我们 新建两个工作环境：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv virtualenv 3.8.1 first_project </span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv virtualenv 3.8.1 second_projec</span></span><br><span class=\"line\">可以使用virtualenvs子命令查看工作环境</span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv virtualenvs</span></span><br><span class=\"line\">  3.8.1/envs/first_project (created from /root/.pyenv/versions/3.8.1)</span><br><span class=\"line\">  3.8.1/envs/second_projec (created from /root/.pyenv/versions/3.8.1)</span><br><span class=\"line\">  first_project (created from /root/.pyenv/versions/3.8.1)</span><br><span class=\"line\">  second_projec (created from /root/.pyenv/versions/3.8.1)</span><br></pre></td></tr></table></figure>\n<p>创建完工作环境以后，可以通过activate和deactivate子命令进入或退出一个工作环境。进入工作环境 以后，左边的提示符会显示你当前所在的工作环境，以免因为环境太多导致操作错误。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(first_project) </span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># pip install flask==1.1.1 </span></span><br><span class=\"line\">Looking <span class=\"keyword\">in</span> indexes: https://pypi.doubanio.com/simple</span><br><span class=\"line\">Collecting flask==1.1.1</span><br><span class=\"line\">  Downloading https://pypi.doubanio.com/packages/9b/93/628509b8d5dc749656a9641f4caf13540e2cdec85276964ff8f43bbb1d3b/Flask-1.1.1-py2.py3-none-any.whl (94kB)</span><br><span class=\"line\">     |███▌                            | 10kB 28.0MB/s eta 0:00:</span><br><span class=\"line\">     |███████                         | 20kB 1.8MB/s eta 0:00:0</span><br><span class=\"line\">     |██████████▍                     | 30kB 2.7MB/s eta 0:00:0</span><br><span class=\"line\">     |█████████████▉                  | 40kB 1.8MB/s eta 0:00:0</span><br><span class=\"line\">     |█████████████████▍              | 51kB 1.3MB/s eta 0:00:0</span><br><span class=\"line\">     |████████████████████▉           | 61kB 1.5MB/s eta 0:00:0</span><br><span class=\"line\">     |████████████████████████▎       | 71kB 1.4MB/s eta 0:00:0</span><br><span class=\"line\">     |███████████████████████████▊    | 81kB 1.3MB/s eta 0:00:0</span><br><span class=\"line\">     |███████████████████████████████▏| 92kB 1.4MB/s eta 0:00:0</span><br><span class=\"line\">     |████████████████████████████████| 102kB 1.6MB/s </span><br><span class=\"line\">Collecting itsdangerous&gt;=0.24 (from flask==1.1.1)</span><br><span class=\"line\">(first_project) [root@python ~]<span class=\"comment\"># pyenv deactivate</span></span><br><span class=\"line\"><span class=\"comment\">## 退出first_project环境</span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\">#</span></span><br></pre></td></tr></table></figure>\n<p>接下来，我们看一下在不同的工作环境安装不同的Flask版本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv activate first_project </span></span><br><span class=\"line\"><span class=\"comment\">##切换工作环境</span></span><br><span class=\"line\">(first_project) [root@python ~]<span class=\"comment\"># pip install flask==1.1.1 </span></span><br><span class=\"line\"><span class=\"comment\">##安装1.1.1的flask</span></span><br><span class=\"line\">(first_project) [root@python ~]<span class=\"comment\"># pyenv deactivate </span></span><br><span class=\"line\"><span class=\"comment\">##退出目前工作环境</span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\">#</span></span><br><span class=\"line\"></span><br><span class=\"line\">[root@python ~]<span class=\"comment\"># pyenv activate second_projec</span></span><br><span class=\"line\"><span class=\"comment\">##切换工作环境</span></span><br><span class=\"line\">(second_project) [root@python ~]<span class=\"comment\"># pip install flask==0.10.1</span></span><br><span class=\"line\"><span class=\"comment\">##安装0.10.1的flask</span></span><br><span class=\"line\">(second_project) [root@python ~]<span class=\"comment\"># pyenv deactivate </span></span><br><span class=\"line\"><span class=\"comment\">##退出目前工作环境</span></span><br><span class=\"line\">[root@python ~]<span class=\"comment\">#</span></span><br></pre></td></tr></table></figure>\n<p>查看一下两个工作环境源目录<br>\npyenv的安装和简单使用（git、pyenv、pyenv-virtualenv）</p>\n<p>如果想要删除虚拟环境，则使用：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(first_project)</span><br><span class=\"line\"> [root@python ~]<span class=\"comment\"># pyenv virtualenv-delete first_project</span></span><br></pre></td></tr></table></figure>\n<p>使用pyenv和python-virtualenv插件，我们就能够自由地在不同的版本之间进行切换，相比管理Python 版本，不但节省了时间，也避免了工作过程中的相互干扰。</p>\n<h2 id=\"四-更新-pyenv\"><a class=\"markdownIt-Anchor\" href=\"#四-更新-pyenv\"></a> 四、更新 pyenv</h2>\n<p>由于我们是 git 克隆的，所以更新非常简单</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> ~/.pyenv` 或者 `<span class=\"built_in\">cd</span> $(pyenv root)`</span><br><span class=\"line\"> `git pull</span><br></pre></td></tr></table></figure>\n<h2 id=\"五-卸载-pyenv\"><a class=\"markdownIt-Anchor\" href=\"#五-卸载-pyenv\"></a> 五、卸载 pyenv</h2>\n<p>由于 pyenv 把一切都放在 ~/.pyenv 下了，所以卸载很方便，两个步骤就行了</p>\n<p>首先你需要删除环境变量</p>\n<p>然后你需要执行：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -rf ~/.pyenv` 或者 `rm -rf $(pyenv root)</span><br></pre></td></tr></table></figure>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"ckf71udcv00007l9k85cwb7qg","category_id":"ckf71udd000017l9kfd0ux64t","_id":"ckf71udd500047l9k13wz1q5x"}],"PostTag":[{"post_id":"ckeuuoszs0001ip9kipcdmpzr","tag_id":"ckeuuot000004ip9kn90eofrl","_id":"ckeuuot0d000gip9k1ahn9d22"},{"post_id":"ckeuuoszs0001ip9kipcdmpzr","tag_id":"ckeuuot08000bip9kjz6wl46v","_id":"ckeuuot0e000iip9k80s5m3ik"},{"post_id":"ckeuuoszy0003ip9ki3i50600","tag_id":"ckeuuot0c000eip9k03ldfnnd","_id":"ckeuuot0i000oip9k5x3ofphe"},{"post_id":"ckeuuoszy0003ip9ki3i50600","tag_id":"ckeuuot0e000jip9k73f6z38g","_id":"ckeuuot0j000qip9kse4x90l6"},{"post_id":"ckeuuot030006ip9khasg3xgo","tag_id":"ckeuuot0h000mip9kypd9ny6a","_id":"ckeuuot0l000tip9kog5v0rjs"},{"post_id":"ckeuuot050008ip9kin21e1v3","tag_id":"ckeuuot0k000sip9kv3j4p0bc","_id":"ckeuuot0n000xip9ktntap0ym"},{"post_id":"ckeuuot050008ip9kin21e1v3","tag_id":"ckeuuot0l000uip9k40jg15jj","_id":"ckeuuot0n000yip9k6fr36i5f"},{"post_id":"ckeuuot050008ip9kin21e1v3","tag_id":"ckeuuot0m000vip9kak21gd91","_id":"ckeuuot0n0010ip9k08peyiw1"},{"post_id":"ckeuuot07000aip9km41ejcvb","tag_id":"ckeuuot0m000wip9k13fj9u9h","_id":"ckeuuot0q0012ip9ksier5mmt"},{"post_id":"ckeuuot07000aip9km41ejcvb","tag_id":"ckeuuot0n000zip9ktul8vf3j","_id":"ckeuuot0q0013ip9k774tvj3y"},{"post_id":"ckeuuot09000cip9kr54b3vao","tag_id":"ckeuuot0m000vip9kak21gd91","_id":"ckeuuot0r0015ip9kgmvlcea1"},{"post_id":"ckeuuot0a000dip9k2n9orqyg","tag_id":"ckeuuot0m000vip9kak21gd91","_id":"ckeuuot0t0017ip9ko8xe96go"},{"post_id":"ckeuuot0c000fip9k3tko1qjw","tag_id":"ckeuuot0r0016ip9k6tm5pk25","_id":"ckeuuot0w001aip9khu6zv4uk"},{"post_id":"ckeuuot0c000fip9k3tko1qjw","tag_id":"ckeuuot0u0018ip9kgztm8yfq","_id":"ckeuuot0w001bip9kpp11dk7o"},{"post_id":"ckeuuot0d000hip9k8pkhmizo","tag_id":"ckeuuot0k000sip9kv3j4p0bc","_id":"ckeuuot0y001eip9k355doa03"},{"post_id":"ckeuuot0d000hip9k8pkhmizo","tag_id":"ckeuuot0w001cip9kidwi8fwu","_id":"ckeuuot0y001fip9kp6qoxrqv"},{"post_id":"ckeuuot0f000kip9k0h4t005m","tag_id":"ckeuuot000004ip9kn90eofrl","_id":"ckeuuot0z001hip9kwnd8bcxy"},{"post_id":"ckeuuot0f000kip9k0h4t005m","tag_id":"ckeuuot0x001dip9kwsdim79y","_id":"ckeuuot0z001iip9ko70tgno0"},{"post_id":"ckeuuot0g000lip9k58s6z47p","tag_id":"ckeuuot0y001gip9kxmrpttfp","_id":"ckeuuot0z001kip9k8ff2k563"},{"post_id":"ckeuuot0i000pip9kt96e336p","tag_id":"ckeuuot0z001jip9k5y94g0pe","_id":"ckeuuot10001oip9kxmg46u29"},{"post_id":"ckeuuot0i000pip9kt96e336p","tag_id":"ckeuuot0z001lip9kxppc7la6","_id":"ckeuuot10001pip9ksw7esei8"},{"post_id":"ckeuuot0i000pip9kt96e336p","tag_id":"ckeuuot10001mip9k88gk5n7i","_id":"ckeuuot10001qip9kaksbflmi"},{"post_id":"ckeuuot0i000pip9kt96e336p","tag_id":"ckeuuot10001nip9kmyaxhq4v","_id":"ckeuuot10001rip9kp6g73er5"},{"post_id":"ckeuuot21001uip9kdd7vznco","tag_id":"ckeuuot0e000jip9k73f6z38g","_id":"ckeuuot260021ip9k1ycgohjj"},{"post_id":"ckeuuot21001uip9kdd7vznco","tag_id":"ckeuuot23001wip9kkyrlbzk0","_id":"ckeuuot270023ip9kgvcg1ah6"},{"post_id":"ckeuuot22001vip9kghviubus","tag_id":"ckeuuot260020ip9kkahhvtyi","_id":"ckeuuot290026ip9k4vhs2oy3"},{"post_id":"ckeuuot22001vip9kghviubus","tag_id":"ckeuuot0c000eip9k03ldfnnd","_id":"ckeuuot2a0028ip9khporr5sa"},{"post_id":"ckeuuot23001xip9k22hw7zud","tag_id":"ckeuuot260020ip9kkahhvtyi","_id":"ckeuuot2b002dip9kso05eqa1"},{"post_id":"ckeuuot23001xip9k22hw7zud","tag_id":"ckeuuot0c000eip9k03ldfnnd","_id":"ckeuuot2b002eip9k6o56rhqy"},{"post_id":"ckeuuot23001xip9k22hw7zud","tag_id":"ckeuuot2a0029ip9kyrnehp8u","_id":"ckeuuot2b002gip9kx7t56idq"},{"post_id":"ckeuuot23001xip9k22hw7zud","tag_id":"ckeuuot2a002aip9k1ixcrthk","_id":"ckeuuot2c002hip9kq7d5x9nw"},{"post_id":"ckeuuot24001yip9ki4yyvuq7","tag_id":"ckeuuot2b002cip9keaziiyd6","_id":"ckeuuot2c002jip9kw0zx7o55"},{"post_id":"ckeuuot24001yip9ki4yyvuq7","tag_id":"ckeuuot2b002fip9ktrv9l7tj","_id":"ckeuuot2c002kip9kr7hlzfvn"},{"post_id":"ckeuuot25001zip9kr5bh9ze8","tag_id":"ckeuuot000004ip9kn90eofrl","_id":"ckeuuot2d002pip9kko4oppqf"},{"post_id":"ckeuuot25001zip9kr5bh9ze8","tag_id":"ckeuuot2c002iip9ksjot0xne","_id":"ckeuuot2d002qip9ki1e4goed"},{"post_id":"ckeuuot25001zip9kr5bh9ze8","tag_id":"ckeuuot2c002lip9k9mh8uluc","_id":"ckeuuot2d002sip9kiaiglbht"},{"post_id":"ckeuuot25001zip9kr5bh9ze8","tag_id":"ckeuuot2c002mip9k5fjdoz84","_id":"ckeuuot2d002tip9k7e7tc56h"},{"post_id":"ckeuuot25001zip9kr5bh9ze8","tag_id":"ckeuuot2c002nip9kpf31cfju","_id":"ckeuuot2e002uip9kvxb45imy"},{"post_id":"ckeuuot260022ip9kfvou9kfy","tag_id":"ckeuuot2d002oip9kd9gs8elk","_id":"ckeuuot2e002vip9ky3cra4cb"},{"post_id":"ckf71udcv00007l9k85cwb7qg","tag_id":"ckf71udd400027l9kh6zrqt5w","_id":"ckf71udd500057l9kib6wt6q8"},{"post_id":"ckf71udcv00007l9k85cwb7qg","tag_id":"ckf71udd400037l9k11zt38re","_id":"ckf71udd600067l9kdr419yxq"}],"Tag":[{"name":"go","_id":"ckeuuot000004ip9kn90eofrl"},{"name":"delve","_id":"ckeuuot08000bip9kjz6wl46v"},{"name":"ubuntu","_id":"ckeuuot0c000eip9k03ldfnnd"},{"name":"docker","_id":"ckeuuot0e000jip9k73f6z38g"},{"name":"性能测试","_id":"ckeuuot0h000mip9kypd9ny6a"},{"name":"php","_id":"ckeuuot0k000sip9kv3j4p0bc"},{"name":"nodejs","_id":"ckeuuot0l000uip9k40jg15jj"},{"name":"nginx","_id":"ckeuuot0m000vip9kak21gd91"},{"name":"phpstrom","_id":"ckeuuot0m000wip9k13fj9u9h"},{"name":"jetbrains","_id":"ckeuuot0n000zip9ktul8vf3j"},{"name":"operator mono","_id":"ckeuuot0r0016ip9k6tm5pk25"},{"name":"fira code","_id":"ckeuuot0u0018ip9kgztm8yfq"},{"name":"php-jit","_id":"ckeuuot0w001cip9kidwi8fwu"},{"name":"golang","_id":"ckeuuot0x001dip9kwsdim79y"},{"name":"架构","_id":"ckeuuot0y001gip9kxmrpttfp"},{"name":"mongo","_id":"ckeuuot0z001jip9k5y94g0pe"},{"name":"php-mongo","_id":"ckeuuot0z001lip9kxppc7la6"},{"name":"swoole","_id":"ckeuuot10001mip9k88gk5n7i"},{"name":"tcp","_id":"ckeuuot10001nip9kmyaxhq4v"},{"name":"gitlab","_id":"ckeuuot23001wip9kkyrlbzk0"},{"name":"linux","_id":"ckeuuot260020ip9kkahhvtyi"},{"name":"frp","_id":"ckeuuot2a0029ip9kyrnehp8u"},{"name":"内网穿透","_id":"ckeuuot2a002aip9k1ixcrthk"},{"name":"hexo","_id":"ckeuuot2b002cip9keaziiyd6"},{"name":"pure","_id":"ckeuuot2b002fip9ktrv9l7tj"},{"name":"c","_id":"ckeuuot2c002iip9ksjot0xne"},{"name":"c++","_id":"ckeuuot2c002lip9k9mh8uluc"},{"name":"内存","_id":"ckeuuot2c002mip9k5fjdoz84"},{"name":"堆栈","_id":"ckeuuot2c002nip9kpf31cfju"},{"name":"树莓派","_id":"ckeuuot2d002oip9kd9gs8elk"},{"name":"test","_id":"ckeuuot2d002rip9k8t3vz5m3"},{"name":"python","_id":"ckf71udd400027l9kh6zrqt5w"},{"name":"pyenv","_id":"ckf71udd400037l9k11zt38re"}]}}